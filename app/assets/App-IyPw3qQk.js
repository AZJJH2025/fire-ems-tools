var Rr=Object.defineProperty;var kr=(t,s,r)=>s in t?Rr(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r;var Ht=(t,s,r)=>kr(t,typeof s!="symbol"?s+"":s,r);import{r as w,g as Re,a as ke,u as Le,j as e,s as ue,c as ve,b as Ie,m as ze,d as me,e as Dt,f as ir,h as ce,i as Ir,_ as lr,k as dt,l as He,B as v,t as Yt,n as Mr,C as Qe,o as $e,p as Or,q as $r,v as Lr,w as Be,R as Ze,x as jt,y as zr,G as _r,z as Ar,A as Pr,D as Nr}from"./index-Bq8nM3zG.js";import{U as Wt,D as ot,C as Vr,T as Br,A as Ur,S as Hr,a as ft,b as qt,E as cr,c as dr,d as Yr,L as Wr,e as qr,f as Gt}from"./dataTransformer-DkC58-Mz.js";import{T as y,u as Jt,c as se,a as Gr,b as Jr,d as pt,S as Kr,e as Xr,f as Qr,g as Zr,h as es,G as le,F as Ue,I as Ye,i as We,M as ae,P as he,A as pe,B as Z,D as xe,j as be,k as Oe,l as at,C as de,m as it,n as lt,o as gt,p as Ee,q as ct,r as ts,s as _t,t as De,v as rt,w as ur,x as pr,E as yt,y as hr,z as fr,H as xr,J as mr,L as qe,K as Se,N as Pe,O as Ce,Q as rs,R as Rt,U as gr,V as Kt}from"./Map-BCNPkT9Y.js";import{F as ss,C as st,L as ns,T as kt,a as It,b as Mt,c as Xe,d as Ne,e as Ot,S as os,f as $t,g as as,h as At,i as Pt,j as is,P as yr,A as ls,B as cs,D as ds}from"./AccessTime-adnhDdFQ.js";const br=t=>{const s=w.useRef({});return w.useEffect(()=>{s.current=t}),s.current};function us(t){return Re("MuiAlertTitle",t)}ke("MuiAlertTitle",["root"]);const ps=t=>{const{classes:s}=t;return Ie({root:["root"]},us,s)},hs=ue(y,{name:"MuiAlertTitle",slot:"Root",overridesResolver:(t,s)=>s.root})(ze(({theme:t})=>({fontWeight:t.typography.fontWeightMedium,marginTop:-2}))),fs=w.forwardRef(function(s,r){const n=Le({props:s,name:"MuiAlertTitle"}),{className:i,...c}=n,o=n,h=ps(o);return e.jsx(hs,{gutterBottom:!0,component:"div",ownerState:o,ref:r,className:ve(h.root,i),...c})});function xs(t){const{badgeContent:s,invisible:r=!1,max:n=99,showZero:i=!1}=t,c=br({badgeContent:s,max:n});let o=r;r===!1&&s===0&&!i&&(o=!0);const{badgeContent:h,max:u=n}=o?c:t,l=h&&Number(h)>u?`${u}+`:h;return{badgeContent:h,invisible:o,max:u,displayValue:l}}function ms(t){return Re("MuiBadge",t)}const Ae=ke("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),St=10,Ct=4,gs=t=>{const{color:s,anchorOrigin:r,invisible:n,overlap:i,variant:c,classes:o={}}=t,h={root:["root"],badge:["badge",c,n&&"invisible",`anchorOrigin${me(r.vertical)}${me(r.horizontal)}`,`anchorOrigin${me(r.vertical)}${me(r.horizontal)}${me(i)}`,`overlap${me(i)}`,s!=="default"&&`color${me(s)}`]};return Ie(h,ms,o)},ys=ue("span",{name:"MuiBadge",slot:"Root",overridesResolver:(t,s)=>s.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),bs=ue("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(t,s)=>{const{ownerState:r}=t;return[s.badge,s[r.variant],s[`anchorOrigin${me(r.anchorOrigin.vertical)}${me(r.anchorOrigin.horizontal)}${me(r.overlap)}`],r.color!=="default"&&s[`color${me(r.color)}`],r.invisible&&s.invisible]}})(ze(({theme:t})=>({display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:t.typography.fontFamily,fontWeight:t.typography.fontWeightMedium,fontSize:t.typography.pxToRem(12),minWidth:St*2,lineHeight:1,padding:"0 6px",height:St*2,borderRadius:St,zIndex:1,transition:t.transitions.create("transform",{easing:t.transitions.easing.easeInOut,duration:t.transitions.duration.enteringScreen}),variants:[...Object.entries(t.palette).filter(Dt(["contrastText"])).map(([s])=>({props:{color:s},style:{backgroundColor:(t.vars||t).palette[s].main,color:(t.vars||t).palette[s].contrastText}})),{props:{variant:"dot"},style:{borderRadius:Ct,height:Ct*2,minWidth:Ct*2,padding:0}},{props:({ownerState:s})=>s.anchorOrigin.vertical==="top"&&s.anchorOrigin.horizontal==="right"&&s.overlap==="rectangular",style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${Ae.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:s})=>s.anchorOrigin.vertical==="bottom"&&s.anchorOrigin.horizontal==="right"&&s.overlap==="rectangular",style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${Ae.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:s})=>s.anchorOrigin.vertical==="top"&&s.anchorOrigin.horizontal==="left"&&s.overlap==="rectangular",style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${Ae.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:s})=>s.anchorOrigin.vertical==="bottom"&&s.anchorOrigin.horizontal==="left"&&s.overlap==="rectangular",style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${Ae.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:({ownerState:s})=>s.anchorOrigin.vertical==="top"&&s.anchorOrigin.horizontal==="right"&&s.overlap==="circular",style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${Ae.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:s})=>s.anchorOrigin.vertical==="bottom"&&s.anchorOrigin.horizontal==="right"&&s.overlap==="circular",style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${Ae.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:s})=>s.anchorOrigin.vertical==="top"&&s.anchorOrigin.horizontal==="left"&&s.overlap==="circular",style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${Ae.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:s})=>s.anchorOrigin.vertical==="bottom"&&s.anchorOrigin.horizontal==="left"&&s.overlap==="circular",style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${Ae.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:t.transitions.create("transform",{easing:t.transitions.easing.easeInOut,duration:t.transitions.duration.leavingScreen})}}]})));function Xt(t){return{vertical:(t==null?void 0:t.vertical)??"top",horizontal:(t==null?void 0:t.horizontal)??"right"}}const vs=w.forwardRef(function(s,r){const n=Le({props:s,name:"MuiBadge"}),{anchorOrigin:i,className:c,classes:o,component:h,components:u={},componentsProps:l={},children:f,overlap:x="rectangular",color:b="default",invisible:D=!1,max:R=99,badgeContent:k,slots:V,slotProps:F,showZero:N=!1,variant:$="standard",...T}=n,{badgeContent:B,invisible:P,max:_,displayValue:d}=xs({max:R,invisible:D,badgeContent:k,showZero:N}),a=br({anchorOrigin:Xt(i),color:b,overlap:x,variant:$,badgeContent:k}),m=P||B==null&&$!=="dot",{color:j=b,overlap:O=x,anchorOrigin:U,variant:X=$}=m?a:n,ne=Xt(U),E=X!=="dot"?d:void 0,g={...n,badgeContent:B,invisible:m,max:_,displayValue:E,showZero:N,anchorOrigin:ne,color:j,overlap:O,variant:X},M=gs(g),p=(V==null?void 0:V.root)??u.Root??ys,L=(V==null?void 0:V.badge)??u.Badge??bs,S=(F==null?void 0:F.root)??l.root,I=(F==null?void 0:F.badge)??l.badge,C=Jt({elementType:p,externalSlotProps:S,externalForwardedProps:T,additionalProps:{ref:r,as:h},ownerState:g,className:ve(S==null?void 0:S.className,M.root,c)}),Y=Jt({elementType:L,externalSlotProps:I,ownerState:g,className:ve(M.badge,I==null?void 0:I.className)});return e.jsxs(p,{...C,children:[f,e.jsx(L,{...Y,children:E})]})});function js(t){return Re("MuiCardActions",t)}ke("MuiCardActions",["root","spacing"]);const Ss=t=>{const{classes:s,disableSpacing:r}=t;return Ie({root:["root",!r&&"spacing"]},js,s)},Cs=ue("div",{name:"MuiCardActions",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:r}=t;return[s.root,!r.disableSpacing&&s.spacing]}})({display:"flex",alignItems:"center",padding:8,variants:[{props:{disableSpacing:!1},style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),ws=w.forwardRef(function(s,r){const n=Le({props:s,name:"MuiCardActions"}),{disableSpacing:i=!1,className:c,...o}=n,h={...n,disableSpacing:i},u=Ss(h);return e.jsx(Cs,{className:ve(u.root,c),ownerState:h,ref:r,...o})}),Ts=se(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"})),Fs=se(e.jsx("path",{d:"M8.465 8.465C9.37 7.56 10.62 7 12 7C14.76 7 17 9.24 17 12C17 13.38 16.44 14.63 15.535 15.535C14.63 16.44 13.38 17 12 17C9.24 17 7 14.76 7 12C7 10.62 7.56 9.37 8.465 8.465Z"})),Es=ue("span",{shouldForwardProp:ir})({position:"relative",display:"flex"}),Ds=ue(Ts)({transform:"scale(1)"}),Rs=ue(Fs)(ze(({theme:t})=>({left:0,position:"absolute",transform:"scale(0)",transition:t.transitions.create("transform",{easing:t.transitions.easing.easeIn,duration:t.transitions.duration.shortest}),variants:[{props:{checked:!0},style:{transform:"scale(1)",transition:t.transitions.create("transform",{easing:t.transitions.easing.easeOut,duration:t.transitions.duration.shortest})}}]})));function vr(t){const{checked:s=!1,classes:r={},fontSize:n}=t,i={...t,checked:s};return e.jsxs(Es,{className:r.root,ownerState:i,children:[e.jsx(Ds,{fontSize:n,className:r.background,ownerState:i}),e.jsx(Rs,{fontSize:n,className:r.dot,ownerState:i})]})}const jr=w.createContext(void 0);function ks(){return w.useContext(jr)}function Is(t){return Re("MuiRadio",t)}const Qt=ke("MuiRadio",["root","checked","disabled","colorPrimary","colorSecondary","sizeSmall"]),Ms=t=>{const{classes:s,color:r,size:n}=t,i={root:["root",`color${me(r)}`,n!=="medium"&&`size${me(n)}`]};return{...s,...Ie(i,Is,s)}},Os=ue(Kr,{shouldForwardProp:t=>ir(t)||t==="classes",name:"MuiRadio",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:r}=t;return[s.root,r.size!=="medium"&&s[`size${me(r.size)}`],s[`color${me(r.color)}`]]}})(ze(({theme:t})=>({color:(t.vars||t).palette.text.secondary,[`&.${Qt.disabled}`]:{color:(t.vars||t).palette.action.disabled},variants:[{props:{color:"default",disabled:!1,disableRipple:!1},style:{"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:ce(t.palette.action.active,t.palette.action.hoverOpacity)}}},...Object.entries(t.palette).filter(Dt()).map(([s])=>({props:{color:s,disabled:!1,disableRipple:!1},style:{"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette[s].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:ce(t.palette[s].main,t.palette.action.hoverOpacity)}}})),...Object.entries(t.palette).filter(Dt()).map(([s])=>({props:{color:s,disabled:!1},style:{[`&.${Qt.checked}`]:{color:(t.vars||t).palette[s].main}}})),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]})));function $s(t,s){return typeof s=="object"&&s!==null?t===s:String(t)===String(s)}const Ls=e.jsx(vr,{checked:!0}),zs=e.jsx(vr,{}),ut=w.forwardRef(function(s,r){const n=Le({props:s,name:"MuiRadio"}),{checked:i,checkedIcon:c=Ls,color:o="primary",icon:h=zs,name:u,onChange:l,size:f="medium",className:x,disabled:b,disableRipple:D=!1,slots:R={},slotProps:k={},inputProps:V,...F}=n,N=Gr();let $=b;N&&typeof $>"u"&&($=N.disabled),$??($=!1);const T={...n,disabled:$,disableRipple:D,color:o,size:f},B=Ms(T),P=ks();let _=i;const d=Jr(l,P&&P.onChange);let a=u;P&&(typeof _>"u"&&(_=$s(P.value,n.value)),typeof a>"u"&&(a=P.name));const m=k.input??V,[j,O]=pt("root",{ref:r,elementType:Os,className:ve(B.root,x),shouldForwardComponentProp:!0,externalForwardedProps:{slots:R,slotProps:k,...F},getSlotProps:U=>({...U,onChange:(X,...ne)=>{var E;(E=U.onChange)==null||E.call(U,X,...ne),d(X,...ne)}}),ownerState:T,additionalProps:{type:"radio",icon:w.cloneElement(h,{fontSize:h.props.fontSize??f}),checkedIcon:w.cloneElement(c,{fontSize:c.props.fontSize??f}),disabled:$,name:a,checked:_,slots:R,slotProps:{input:typeof m=="function"?m(T):m}}});return e.jsx(j,{...O,classes:B})});function _s(t){return Re("MuiRadioGroup",t)}ke("MuiRadioGroup",["root","row","error"]);const As=t=>{const{classes:s,row:r,error:n}=t;return Ie({root:["root",r&&"row",n&&"error"]},_s,s)},Ps=w.forwardRef(function(s,r){const{actions:n,children:i,className:c,defaultValue:o,name:h,onChange:u,value:l,...f}=s,x=w.useRef(null),b=As(s),[D,R]=Xr({controlled:l,default:o,name:"RadioGroup"});w.useImperativeHandle(n,()=>({focus:()=>{let N=x.current.querySelector("input:not(:disabled):checked");N||(N=x.current.querySelector("input:not(:disabled)")),N&&N.focus()}}),[]);const k=Qr(r,x),V=Zr(h),F=w.useMemo(()=>({name:V,onChange(N){R(N.target.value),u&&u(N,N.target.value)},value:D}),[V,u,R,D]);return e.jsx(jr.Provider,{value:F,children:e.jsx(ss,{role:"radiogroup",ref:k,className:ve(b.root,c),...f,children:i})})}),bt=w.createContext({}),Nt=w.createContext({});function Ns(t){return Re("MuiStep",t)}ke("MuiStep",["root","horizontal","vertical","alternativeLabel","completed"]);const Vs=t=>{const{classes:s,orientation:r,alternativeLabel:n,completed:i}=t;return Ie({root:["root",r,n&&"alternativeLabel",i&&"completed"]},Ns,s)},Bs=ue("div",{name:"MuiStep",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:r}=t;return[s.root,s[r.orientation],r.alternativeLabel&&s.alternativeLabel,r.completed&&s.completed]}})({variants:[{props:{orientation:"horizontal"},style:{paddingLeft:8,paddingRight:8}},{props:{alternativeLabel:!0},style:{flex:1,position:"relative"}}]}),Us=w.forwardRef(function(s,r){const n=Le({props:s,name:"MuiStep"}),{active:i,children:c,className:o,component:h="div",completed:u,disabled:l,expanded:f=!1,index:x,last:b,...D}=n,{activeStep:R,connector:k,alternativeLabel:V,orientation:F,nonLinear:N}=w.useContext(bt);let[$=!1,T=!1,B=!1]=[i,u,l];R===x?$=i!==void 0?i:!0:!N&&R>x?T=u!==void 0?u:!0:!N&&R<x&&(B=l!==void 0?l:!0);const P=w.useMemo(()=>({index:x,last:b,expanded:f,icon:x+1,active:$,completed:T,disabled:B}),[x,b,f,$,T,B]),_={...n,active:$,orientation:F,alternativeLabel:V,completed:T,disabled:B,expanded:f,component:h},d=Vs(_),a=e.jsxs(Bs,{as:h,className:ve(d.root,o),ref:r,ownerState:_,...D,children:[k&&V&&x!==0?k:null,c]});return e.jsx(Nt.Provider,{value:P,children:k&&!V&&x!==0?e.jsxs(w.Fragment,{children:[k,a]}):a})}),Hs=se(e.jsx("path",{d:"M12 0a12 12 0 1 0 0 24 12 12 0 0 0 0-24zm-2 17l-5-5 1.4-1.4 3.6 3.6 7.6-7.6L19 8l-9 9z"})),Ys=se(e.jsx("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"}));function Ws(t){return Re("MuiStepIcon",t)}const wt=ke("MuiStepIcon",["root","active","completed","error","text"]);var Zt;const qs=t=>{const{classes:s,active:r,completed:n,error:i}=t;return Ie({root:["root",r&&"active",n&&"completed",i&&"error"],text:["text"]},Ws,s)},Tt=ue(es,{name:"MuiStepIcon",slot:"Root",overridesResolver:(t,s)=>s.root})(ze(({theme:t})=>({display:"block",transition:t.transitions.create("color",{duration:t.transitions.duration.shortest}),color:(t.vars||t).palette.text.disabled,[`&.${wt.completed}`]:{color:(t.vars||t).palette.primary.main},[`&.${wt.active}`]:{color:(t.vars||t).palette.primary.main},[`&.${wt.error}`]:{color:(t.vars||t).palette.error.main}}))),Gs=ue("text",{name:"MuiStepIcon",slot:"Text",overridesResolver:(t,s)=>s.text})(ze(({theme:t})=>({fill:(t.vars||t).palette.primary.contrastText,fontSize:t.typography.caption.fontSize,fontFamily:t.typography.fontFamily}))),Js=w.forwardRef(function(s,r){const n=Le({props:s,name:"MuiStepIcon"}),{active:i=!1,className:c,completed:o=!1,error:h=!1,icon:u,...l}=n,f={...n,active:i,completed:o,error:h},x=qs(f);if(typeof u=="number"||typeof u=="string"){const b=ve(c,x.root);return h?e.jsx(Tt,{as:Ys,className:b,ref:r,ownerState:f,...l}):o?e.jsx(Tt,{as:Hs,className:b,ref:r,ownerState:f,...l}):e.jsxs(Tt,{className:b,ref:r,ownerState:f,...l,children:[Zt||(Zt=e.jsx("circle",{cx:"12",cy:"12",r:"12"})),e.jsx(Gs,{className:x.text,x:"12",y:"12",textAnchor:"middle",dominantBaseline:"central",ownerState:f,children:u})]})}return u});function Ks(t){return Re("MuiStepLabel",t)}const Ve=ke("MuiStepLabel",["root","horizontal","vertical","label","active","completed","error","disabled","iconContainer","alternativeLabel","labelContainer"]),Xs=t=>{const{classes:s,orientation:r,active:n,completed:i,error:c,disabled:o,alternativeLabel:h}=t;return Ie({root:["root",r,c&&"error",o&&"disabled",h&&"alternativeLabel"],label:["label",n&&"active",i&&"completed",c&&"error",o&&"disabled",h&&"alternativeLabel"],iconContainer:["iconContainer",n&&"active",i&&"completed",c&&"error",o&&"disabled",h&&"alternativeLabel"],labelContainer:["labelContainer",h&&"alternativeLabel"]},Ks,s)},Qs=ue("span",{name:"MuiStepLabel",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:r}=t;return[s.root,s[r.orientation]]}})({display:"flex",alignItems:"center",[`&.${Ve.alternativeLabel}`]:{flexDirection:"column"},[`&.${Ve.disabled}`]:{cursor:"default"},variants:[{props:{orientation:"vertical"},style:{textAlign:"left",padding:"8px 0"}}]}),Zs=ue("span",{name:"MuiStepLabel",slot:"Label",overridesResolver:(t,s)=>s.label})(ze(({theme:t})=>({...t.typography.body2,display:"block",transition:t.transitions.create("color",{duration:t.transitions.duration.shortest}),[`&.${Ve.active}`]:{color:(t.vars||t).palette.text.primary,fontWeight:500},[`&.${Ve.completed}`]:{color:(t.vars||t).palette.text.primary,fontWeight:500},[`&.${Ve.alternativeLabel}`]:{marginTop:16},[`&.${Ve.error}`]:{color:(t.vars||t).palette.error.main}}))),en=ue("span",{name:"MuiStepLabel",slot:"IconContainer",overridesResolver:(t,s)=>s.iconContainer})({flexShrink:0,display:"flex",paddingRight:8,[`&.${Ve.alternativeLabel}`]:{paddingRight:0}}),tn=ue("span",{name:"MuiStepLabel",slot:"LabelContainer",overridesResolver:(t,s)=>s.labelContainer})(ze(({theme:t})=>({width:"100%",color:(t.vars||t).palette.text.secondary,[`&.${Ve.alternativeLabel}`]:{textAlign:"center"}}))),Sr=w.forwardRef(function(s,r){const n=Le({props:s,name:"MuiStepLabel"}),{children:i,className:c,componentsProps:o={},error:h=!1,icon:u,optional:l,slots:f={},slotProps:x={},StepIconComponent:b,StepIconProps:D,...R}=n,{alternativeLabel:k,orientation:V}=w.useContext(bt),{active:F,disabled:N,completed:$,icon:T}=w.useContext(Nt),B=u||T;let P=b;B&&!P&&(P=Js);const _={...n,active:F,alternativeLabel:k,completed:$,disabled:N,error:h,orientation:V},d=Xs(_),a={slots:f,slotProps:{stepIcon:D,...o,...x}},[m,j]=pt("root",{elementType:Qs,externalForwardedProps:{...a,...R},ownerState:_,ref:r,className:ve(d.root,c)}),[O,U]=pt("label",{elementType:Zs,externalForwardedProps:a,ownerState:_}),[X,ne]=pt("stepIcon",{elementType:P,externalForwardedProps:a,ownerState:_});return e.jsxs(m,{...j,children:[B||X?e.jsx(en,{className:d.iconContainer,ownerState:_,children:e.jsx(X,{completed:$,active:F,error:h,icon:B,...ne})}):null,e.jsxs(tn,{className:d.labelContainer,ownerState:_,children:[i?e.jsx(O,{...U,className:ve(d.label,U==null?void 0:U.className),children:i}):null,l]})]})});Sr.muiName="StepLabel";function rn(t){return Re("MuiStepConnector",t)}ke("MuiStepConnector",["root","horizontal","vertical","alternativeLabel","active","completed","disabled","line","lineHorizontal","lineVertical"]);const sn=t=>{const{classes:s,orientation:r,alternativeLabel:n,active:i,completed:c,disabled:o}=t,h={root:["root",r,n&&"alternativeLabel",i&&"active",c&&"completed",o&&"disabled"],line:["line",`line${me(r)}`]};return Ie(h,rn,s)},nn=ue("div",{name:"MuiStepConnector",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:r}=t;return[s.root,s[r.orientation],r.alternativeLabel&&s.alternativeLabel,r.completed&&s.completed]}})({flex:"1 1 auto",variants:[{props:{orientation:"vertical"},style:{marginLeft:12}},{props:{alternativeLabel:!0},style:{position:"absolute",top:12,left:"calc(-50% + 20px)",right:"calc(50% + 20px)"}}]}),on=ue("span",{name:"MuiStepConnector",slot:"Line",overridesResolver:(t,s)=>{const{ownerState:r}=t;return[s.line,s[`line${me(r.orientation)}`]]}})(ze(({theme:t})=>{const s=t.palette.mode==="light"?t.palette.grey[400]:t.palette.grey[600];return{display:"block",borderColor:t.vars?t.vars.palette.StepConnector.border:s,variants:[{props:{orientation:"horizontal"},style:{borderTopStyle:"solid",borderTopWidth:1}},{props:{orientation:"vertical"},style:{borderLeftStyle:"solid",borderLeftWidth:1,minHeight:24}}]}})),an=w.forwardRef(function(s,r){const n=Le({props:s,name:"MuiStepConnector"}),{className:i,...c}=n,{alternativeLabel:o,orientation:h="horizontal"}=w.useContext(bt),{active:u,disabled:l,completed:f}=w.useContext(Nt),x={...n,alternativeLabel:o,orientation:h,active:u,completed:f,disabled:l},b=sn(x);return e.jsx(nn,{className:ve(b.root,i),ref:r,ownerState:x,...c,children:e.jsx(on,{className:b.line,ownerState:x})})});function ln(t){return Re("MuiStepper",t)}ke("MuiStepper",["root","horizontal","vertical","nonLinear","alternativeLabel"]);const cn=t=>{const{orientation:s,nonLinear:r,alternativeLabel:n,classes:i}=t;return Ie({root:["root",s,r&&"nonLinear",n&&"alternativeLabel"]},ln,i)},dn=ue("div",{name:"MuiStepper",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:r}=t;return[s.root,s[r.orientation],r.alternativeLabel&&s.alternativeLabel,r.nonLinear&&s.nonLinear]}})({display:"flex",variants:[{props:{orientation:"horizontal"},style:{flexDirection:"row",alignItems:"center"}},{props:{orientation:"vertical"},style:{flexDirection:"column"}},{props:{alternativeLabel:!0},style:{alignItems:"flex-start"}}]}),un=e.jsx(an,{}),pn=w.forwardRef(function(s,r){const n=Le({props:s,name:"MuiStepper"}),{activeStep:i=0,alternativeLabel:c=!1,children:o,className:h,component:u="div",connector:l=un,nonLinear:f=!1,orientation:x="horizontal",...b}=n,D={...n,nonLinear:f,alternativeLabel:c,orientation:x,component:u},R=cn(D),k=w.Children.toArray(o).filter(Boolean),V=k.map((N,$)=>w.cloneElement(N,{index:$,last:$+1===k.length,...N.props})),F=w.useMemo(()=>({activeStep:i,alternativeLabel:c,connector:l,nonLinear:f,orientation:x}),[i,c,l,f,x]);return e.jsx(bt.Provider,{value:F,children:e.jsx(dn,{as:u,ownerState:D,className:ve(R.root,h),ref:r,...b,children:V})})}),Vt=se(e.jsx("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}));var ht={exports:{}};/* @license
Papa Parse
v5.5.2
https://github.com/mholt/PapaParse
License: MIT
*/var hn=ht.exports,er;function fn(){return er||(er=1,function(t,s){((r,n)=>{t.exports=n()})(hn,function r(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},i,c=!n.document&&!!n.postMessage,o=n.IS_PAPA_WORKER||!1,h={},u=0,l={};function f(d){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(a){var m=B(a);m.chunkSize=parseInt(m.chunkSize),a.step||a.chunk||(m.chunkSize=null),this._handle=new k(m),(this._handle.streamer=this)._config=m}).call(this,d),this.parseChunk=function(a,m){var j=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<j){let U=this._config.newline;U||(O=this._config.quoteChar||'"',U=this._handle.guessLineEndings(a,O)),a=[...a.split(U).slice(j)].join(U)}this.isFirstChunk&&_(this._config.beforeFirstChunk)&&(O=this._config.beforeFirstChunk(a))!==void 0&&(a=O),this.isFirstChunk=!1,this._halted=!1;var j=this._partialLine+a,O=(this._partialLine="",this._handle.parse(j,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(a=O.meta.cursor,j=(this._finished||(this._partialLine=j.substring(a-this._baseIndex),this._baseIndex=a),O&&O.data&&(this._rowCount+=O.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),o)n.postMessage({results:O,workerId:l.WORKER_ID,finished:j});else if(_(this._config.chunk)&&!m){if(this._config.chunk(O,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=O=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(O.data),this._completeResults.errors=this._completeResults.errors.concat(O.errors),this._completeResults.meta=O.meta),this._completed||!j||!_(this._config.complete)||O&&O.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),j||O&&O.meta.paused||this._nextChunk(),O}this._halted=!0},this._sendError=function(a){_(this._config.error)?this._config.error(a):o&&this._config.error&&n.postMessage({workerId:l.WORKER_ID,error:a,finished:!1})}}function x(d){var a;(d=d||{}).chunkSize||(d.chunkSize=l.RemoteChunkSize),f.call(this,d),this._nextChunk=c?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(m){this._input=m,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(a=new XMLHttpRequest,this._config.withCredentials&&(a.withCredentials=this._config.withCredentials),c||(a.onload=P(this._chunkLoaded,this),a.onerror=P(this._chunkError,this)),a.open(this._config.downloadRequestBody?"POST":"GET",this._input,!c),this._config.downloadRequestHeaders){var m,j=this._config.downloadRequestHeaders;for(m in j)a.setRequestHeader(m,j[m])}var O;this._config.chunkSize&&(O=this._start+this._config.chunkSize-1,a.setRequestHeader("Range","bytes="+this._start+"-"+O));try{a.send(this._config.downloadRequestBody)}catch(U){this._chunkError(U.message)}c&&a.status===0&&this._chunkError()}},this._chunkLoaded=function(){a.readyState===4&&(a.status<200||400<=a.status?this._chunkError():(this._start+=this._config.chunkSize||a.responseText.length,this._finished=!this._config.chunkSize||this._start>=(m=>(m=m.getResponseHeader("Content-Range"))!==null?parseInt(m.substring(m.lastIndexOf("/")+1)):-1)(a),this.parseChunk(a.responseText)))},this._chunkError=function(m){m=a.statusText||m,this._sendError(new Error(m))}}function b(d){(d=d||{}).chunkSize||(d.chunkSize=l.LocalChunkSize),f.call(this,d);var a,m,j=typeof FileReader<"u";this.stream=function(O){this._input=O,m=O.slice||O.webkitSlice||O.mozSlice,j?((a=new FileReader).onload=P(this._chunkLoaded,this),a.onerror=P(this._chunkError,this)):a=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var O=this._input,U=(this._config.chunkSize&&(U=Math.min(this._start+this._config.chunkSize,this._input.size),O=m.call(O,this._start,U)),a.readAsText(O,this._config.encoding));j||this._chunkLoaded({target:{result:U}})},this._chunkLoaded=function(O){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(O.target.result)},this._chunkError=function(){this._sendError(a.error)}}function D(d){var a;f.call(this,d=d||{}),this.stream=function(m){return a=m,this._nextChunk()},this._nextChunk=function(){var m,j;if(!this._finished)return m=this._config.chunkSize,a=m?(j=a.substring(0,m),a.substring(m)):(j=a,""),this._finished=!a,this.parseChunk(j)}}function R(d){f.call(this,d=d||{});var a=[],m=!0,j=!1;this.pause=function(){f.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){f.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(O){this._input=O,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){j&&a.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),a.length?this.parseChunk(a.shift()):m=!0},this._streamData=P(function(O){try{a.push(typeof O=="string"?O:O.toString(this._config.encoding)),m&&(m=!1,this._checkIsFinished(),this.parseChunk(a.shift()))}catch(U){this._streamError(U)}},this),this._streamError=P(function(O){this._streamCleanUp(),this._sendError(O)},this),this._streamEnd=P(function(){this._streamCleanUp(),j=!0,this._streamData("")},this),this._streamCleanUp=P(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function k(d){var a,m,j,O,U=Math.pow(2,53),X=-U,ne=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,E=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,g=this,M=0,p=0,L=!1,S=!1,I=[],C={data:[],errors:[],meta:{}};function Y(W){return d.skipEmptyLines==="greedy"?W.join("").trim()==="":W.length===1&&W[0].length===0}function q(){if(C&&j&&(G("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+l.DefaultDelimiter+"'"),j=!1),d.skipEmptyLines&&(C.data=C.data.filter(function(A){return!Y(A)})),K()){let A=function(oe,ee){_(d.transformHeader)&&(oe=d.transformHeader(oe,ee)),I.push(oe)};if(C)if(Array.isArray(C.data[0])){for(var W=0;K()&&W<C.data.length;W++)C.data[W].forEach(A);C.data.splice(0,1)}else C.data.forEach(A)}function z(A,oe){for(var ee=d.header?{}:[],te=0;te<A.length;te++){var re=te,Q=A[te],Q=((je,J)=>(ie=>(d.dynamicTypingFunction&&d.dynamicTyping[ie]===void 0&&(d.dynamicTyping[ie]=d.dynamicTypingFunction(ie)),(d.dynamicTyping[ie]||d.dynamicTyping)===!0))(je)?J==="true"||J==="TRUE"||J!=="false"&&J!=="FALSE"&&((ie=>{if(ne.test(ie)&&(ie=parseFloat(ie),X<ie&&ie<U))return 1})(J)?parseFloat(J):E.test(J)?new Date(J):J===""?null:J):J)(re=d.header?te>=I.length?"__parsed_extra":I[te]:re,Q=d.transform?d.transform(Q,re):Q);re==="__parsed_extra"?(ee[re]=ee[re]||[],ee[re].push(Q)):ee[re]=Q}return d.header&&(te>I.length?G("FieldMismatch","TooManyFields","Too many fields: expected "+I.length+" fields but parsed "+te,p+oe):te<I.length&&G("FieldMismatch","TooFewFields","Too few fields: expected "+I.length+" fields but parsed "+te,p+oe)),ee}var H;C&&(d.header||d.dynamicTyping||d.transform)&&(H=1,!C.data.length||Array.isArray(C.data[0])?(C.data=C.data.map(z),H=C.data.length):C.data=z(C.data,0),d.header&&C.meta&&(C.meta.fields=I),p+=H)}function K(){return d.header&&I.length===0}function G(W,z,H,A){W={type:W,code:z,message:H},A!==void 0&&(W.row=A),C.errors.push(W)}_(d.step)&&(O=d.step,d.step=function(W){C=W,K()?q():(q(),C.data.length!==0&&(M+=W.data.length,d.preview&&M>d.preview?m.abort():(C.data=C.data[0],O(C,g))))}),this.parse=function(W,z,H){var A=d.quoteChar||'"',A=(d.newline||(d.newline=this.guessLineEndings(W,A)),j=!1,d.delimiter?_(d.delimiter)&&(d.delimiter=d.delimiter(W),C.meta.delimiter=d.delimiter):((A=((oe,ee,te,re,Q)=>{var je,J,ie,_e;Q=Q||[",","	","|",";",l.RECORD_SEP,l.UNIT_SEP];for(var Ge=0;Ge<Q.length;Ge++){for(var we,et=Q[Ge],ge=0,Te=0,fe=0,ye=(ie=void 0,new F({comments:re,delimiter:et,newline:ee,preview:10}).parse(oe)),Me=0;Me<ye.data.length;Me++)te&&Y(ye.data[Me])?fe++:(we=ye.data[Me].length,Te+=we,ie===void 0?ie=we:0<we&&(ge+=Math.abs(we-ie),ie=we));0<ye.data.length&&(Te/=ye.data.length-fe),(J===void 0||ge<=J)&&(_e===void 0||_e<Te)&&1.99<Te&&(J=ge,je=et,_e=Te)}return{successful:!!(d.delimiter=je),bestDelimiter:je}})(W,d.newline,d.skipEmptyLines,d.comments,d.delimitersToGuess)).successful?d.delimiter=A.bestDelimiter:(j=!0,d.delimiter=l.DefaultDelimiter),C.meta.delimiter=d.delimiter),B(d));return d.preview&&d.header&&A.preview++,a=W,m=new F(A),C=m.parse(a,z,H),q(),L?{meta:{paused:!0}}:C||{meta:{paused:!1}}},this.paused=function(){return L},this.pause=function(){L=!0,m.abort(),a=_(d.chunk)?"":a.substring(m.getCharIndex())},this.resume=function(){g.streamer._halted?(L=!1,g.streamer.parseChunk(a,!0)):setTimeout(g.resume,3)},this.aborted=function(){return S},this.abort=function(){S=!0,m.abort(),C.meta.aborted=!0,_(d.complete)&&d.complete(C),a=""},this.guessLineEndings=function(oe,A){oe=oe.substring(0,1048576);var A=new RegExp(V(A)+"([^]*?)"+V(A),"gm"),H=(oe=oe.replace(A,"")).split("\r"),A=oe.split(`
`),oe=1<A.length&&A[0].length<H[0].length;if(H.length===1||oe)return`
`;for(var ee=0,te=0;te<H.length;te++)H[te][0]===`
`&&ee++;return ee>=H.length/2?`\r
`:"\r"}}function V(d){return d.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function F(d){var a=(d=d||{}).delimiter,m=d.newline,j=d.comments,O=d.step,U=d.preview,X=d.fastMode,ne=null,E=!1,g=d.quoteChar==null?'"':d.quoteChar,M=g;if(d.escapeChar!==void 0&&(M=d.escapeChar),(typeof a!="string"||-1<l.BAD_DELIMITERS.indexOf(a))&&(a=","),j===a)throw new Error("Comment character same as delimiter");j===!0?j="#":(typeof j!="string"||-1<l.BAD_DELIMITERS.indexOf(j))&&(j=!1),m!==`
`&&m!=="\r"&&m!==`\r
`&&(m=`
`);var p=0,L=!1;this.parse=function(S,I,C){if(typeof S!="string")throw new Error("Input must be a string");var Y=S.length,q=a.length,K=m.length,G=j.length,W=_(O),z=[],H=[],A=[],oe=p=0;if(!S)return ge();if(X||X!==!1&&S.indexOf(g)===-1){for(var ee=S.split(m),te=0;te<ee.length;te++){if(A=ee[te],p+=A.length,te!==ee.length-1)p+=m.length;else if(C)return ge();if(!j||A.substring(0,G)!==j){if(W){if(z=[],_e(A.split(a)),Te(),L)return ge()}else _e(A.split(a));if(U&&U<=te)return z=z.slice(0,U),ge(!0)}}return ge()}for(var re=S.indexOf(a,p),Q=S.indexOf(m,p),je=new RegExp(V(M)+V(g),"g"),J=S.indexOf(g,p);;)if(S[p]===g)for(J=p,p++;;){if((J=S.indexOf(g,J+1))===-1)return C||H.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:z.length,index:p}),we();if(J===Y-1)return we(S.substring(p,J).replace(je,g));if(g===M&&S[J+1]===M)J++;else if(g===M||J===0||S[J-1]!==M){re!==-1&&re<J+1&&(re=S.indexOf(a,J+1));var ie=Ge((Q=Q!==-1&&Q<J+1?S.indexOf(m,J+1):Q)===-1?re:Math.min(re,Q));if(S.substr(J+1+ie,q)===a){A.push(S.substring(p,J).replace(je,g)),S[p=J+1+ie+q]!==g&&(J=S.indexOf(g,p)),re=S.indexOf(a,p),Q=S.indexOf(m,p);break}if(ie=Ge(Q),S.substring(J+1+ie,J+1+ie+K)===m){if(A.push(S.substring(p,J).replace(je,g)),et(J+1+ie+K),re=S.indexOf(a,p),J=S.indexOf(g,p),W&&(Te(),L))return ge();if(U&&z.length>=U)return ge(!0);break}H.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:z.length,index:p}),J++}}else if(j&&A.length===0&&S.substring(p,p+G)===j){if(Q===-1)return ge();p=Q+K,Q=S.indexOf(m,p),re=S.indexOf(a,p)}else if(re!==-1&&(re<Q||Q===-1))A.push(S.substring(p,re)),p=re+q,re=S.indexOf(a,p);else{if(Q===-1)break;if(A.push(S.substring(p,Q)),et(Q+K),W&&(Te(),L))return ge();if(U&&z.length>=U)return ge(!0)}return we();function _e(fe){z.push(fe),oe=p}function Ge(fe){var ye=0;return ye=fe!==-1&&(fe=S.substring(J+1,fe))&&fe.trim()===""?fe.length:ye}function we(fe){return C||(fe===void 0&&(fe=S.substring(p)),A.push(fe),p=Y,_e(A),W&&Te()),ge()}function et(fe){p=fe,_e(A),A=[],Q=S.indexOf(m,p)}function ge(fe){if(d.header&&!I&&z.length&&!E){var ye=z[0],Me={},vt=new Set(ye);let Bt=!1;for(let Je=0;Je<ye.length;Je++){let Fe=ye[Je];if(Me[Fe=_(d.transformHeader)?d.transformHeader(Fe,Je):Fe]){let tt,Ut=Me[Fe];for(;tt=Fe+"_"+Ut,Ut++,vt.has(tt););vt.add(tt),ye[Je]=tt,Me[Fe]++,Bt=!0,(ne=ne===null?{}:ne)[tt]=Fe}else Me[Fe]=1,ye[Je]=Fe;vt.add(Fe)}Bt&&console.warn("Duplicate headers found and renamed."),E=!0}return{data:z,errors:H,meta:{delimiter:a,linebreak:m,aborted:L,truncated:!!fe,cursor:oe+(I||0),renamedHeaders:ne}}}function Te(){O(ge()),z=[],H=[]}},this.abort=function(){L=!0},this.getCharIndex=function(){return p}}function N(d){var a=d.data,m=h[a.workerId],j=!1;if(a.error)m.userError(a.error,a.file);else if(a.results&&a.results.data){var O={abort:function(){j=!0,$(a.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:T,resume:T};if(_(m.userStep)){for(var U=0;U<a.results.data.length&&(m.userStep({data:a.results.data[U],errors:a.results.errors,meta:a.results.meta},O),!j);U++);delete a.results}else _(m.userChunk)&&(m.userChunk(a.results,O,a.file),delete a.results)}a.finished&&!j&&$(a.workerId,a.results)}function $(d,a){var m=h[d];_(m.userComplete)&&m.userComplete(a),m.terminate(),delete h[d]}function T(){throw new Error("Not implemented.")}function B(d){if(typeof d!="object"||d===null)return d;var a,m=Array.isArray(d)?[]:{};for(a in d)m[a]=B(d[a]);return m}function P(d,a){return function(){d.apply(a,arguments)}}function _(d){return typeof d=="function"}return l.parse=function(d,a){var m=(a=a||{}).dynamicTyping||!1;if(_(m)&&(a.dynamicTypingFunction=m,m={}),a.dynamicTyping=m,a.transform=!!_(a.transform)&&a.transform,!a.worker||!l.WORKERS_SUPPORTED)return m=null,l.NODE_STREAM_INPUT,typeof d=="string"?(d=(j=>j.charCodeAt(0)!==65279?j:j.slice(1))(d),m=new(a.download?x:D)(a)):d.readable===!0&&_(d.read)&&_(d.on)?m=new R(a):(n.File&&d instanceof File||d instanceof Object)&&(m=new b(a)),m.stream(d);(m=(()=>{var j;return!!l.WORKERS_SUPPORTED&&(j=(()=>{var O=n.URL||n.webkitURL||null,U=r.toString();return l.BLOB_URL||(l.BLOB_URL=O.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",U,")();"],{type:"text/javascript"})))})(),(j=new n.Worker(j)).onmessage=N,j.id=u++,h[j.id]=j)})()).userStep=a.step,m.userChunk=a.chunk,m.userComplete=a.complete,m.userError=a.error,a.step=_(a.step),a.chunk=_(a.chunk),a.complete=_(a.complete),a.error=_(a.error),delete a.worker,m.postMessage({input:d,config:a,workerId:m.id})},l.unparse=function(d,a){var m=!1,j=!0,O=",",U=`\r
`,X='"',ne=X+X,E=!1,g=null,M=!1,p=((()=>{if(typeof a=="object"){if(typeof a.delimiter!="string"||l.BAD_DELIMITERS.filter(function(I){return a.delimiter.indexOf(I)!==-1}).length||(O=a.delimiter),typeof a.quotes!="boolean"&&typeof a.quotes!="function"&&!Array.isArray(a.quotes)||(m=a.quotes),typeof a.skipEmptyLines!="boolean"&&typeof a.skipEmptyLines!="string"||(E=a.skipEmptyLines),typeof a.newline=="string"&&(U=a.newline),typeof a.quoteChar=="string"&&(X=a.quoteChar),typeof a.header=="boolean"&&(j=a.header),Array.isArray(a.columns)){if(a.columns.length===0)throw new Error("Option columns is empty");g=a.columns}a.escapeChar!==void 0&&(ne=a.escapeChar+X),a.escapeFormulae instanceof RegExp?M=a.escapeFormulae:typeof a.escapeFormulae=="boolean"&&a.escapeFormulae&&(M=/^[=+\-@\t\r].*$/)}})(),new RegExp(V(X),"g"));if(typeof d=="string"&&(d=JSON.parse(d)),Array.isArray(d)){if(!d.length||Array.isArray(d[0]))return L(null,d,E);if(typeof d[0]=="object")return L(g||Object.keys(d[0]),d,E)}else if(typeof d=="object")return typeof d.data=="string"&&(d.data=JSON.parse(d.data)),Array.isArray(d.data)&&(d.fields||(d.fields=d.meta&&d.meta.fields||g),d.fields||(d.fields=Array.isArray(d.data[0])?d.fields:typeof d.data[0]=="object"?Object.keys(d.data[0]):[]),Array.isArray(d.data[0])||typeof d.data[0]=="object"||(d.data=[d.data])),L(d.fields||[],d.data||[],E);throw new Error("Unable to serialize unrecognized input");function L(I,C,Y){var q="",K=(typeof I=="string"&&(I=JSON.parse(I)),typeof C=="string"&&(C=JSON.parse(C)),Array.isArray(I)&&0<I.length),G=!Array.isArray(C[0]);if(K&&j){for(var W=0;W<I.length;W++)0<W&&(q+=O),q+=S(I[W],W);0<C.length&&(q+=U)}for(var z=0;z<C.length;z++){var H=(K?I:C[z]).length,A=!1,oe=K?Object.keys(C[z]).length===0:C[z].length===0;if(Y&&!K&&(A=Y==="greedy"?C[z].join("").trim()==="":C[z].length===1&&C[z][0].length===0),Y==="greedy"&&K){for(var ee=[],te=0;te<H;te++){var re=G?I[te]:te;ee.push(C[z][re])}A=ee.join("").trim()===""}if(!A){for(var Q=0;Q<H;Q++){0<Q&&!oe&&(q+=O);var je=K&&G?I[Q]:Q;q+=S(C[z][je],Q)}z<C.length-1&&(!Y||0<H&&!oe)&&(q+=U)}}return q}function S(I,C){var Y,q;return I==null?"":I.constructor===Date?JSON.stringify(I).slice(1,25):(q=!1,M&&typeof I=="string"&&M.test(I)&&(I="'"+I,q=!0),Y=I.toString().replace(p,ne),(q=q||m===!0||typeof m=="function"&&m(I,C)||Array.isArray(m)&&m[C]||((K,G)=>{for(var W=0;W<G.length;W++)if(-1<K.indexOf(G[W]))return!0;return!1})(Y,l.BAD_DELIMITERS)||-1<Y.indexOf(O)||Y.charAt(0)===" "||Y.charAt(Y.length-1)===" ")?X+Y+X:Y)}},l.RECORD_SEP="",l.UNIT_SEP="",l.BYTE_ORDER_MARK="\uFEFF",l.BAD_DELIMITERS=["\r",`
`,'"',l.BYTE_ORDER_MARK],l.WORKERS_SUPPORTED=!c&&!!n.Worker,l.NODE_STREAM_INPUT=1,l.LocalChunkSize=10485760,l.RemoteChunkSize=5242880,l.DefaultDelimiter=",",l.Parser=F,l.ParserHandle=k,l.NetworkStreamer=x,l.FileStreamer=b,l.StringStreamer=D,l.ReadableStreamStreamer=R,n.jQuery&&((i=n.jQuery).fn.parse=function(d){var a=d.config||{},m=[];return this.each(function(U){if(!(i(this).prop("tagName").toUpperCase()==="INPUT"&&i(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var X=0;X<this.files.length;X++)m.push({file:this.files[X],inputElem:this,instanceConfig:i.extend({},a)})}),j(),this;function j(){if(m.length===0)_(d.complete)&&d.complete();else{var U,X,ne,E,g=m[0];if(_(d.before)){var M=d.before(g.file,g.inputElem);if(typeof M=="object"){if(M.action==="abort")return U="AbortError",X=g.file,ne=g.inputElem,E=M.reason,void(_(d.error)&&d.error({name:U},X,ne,E));if(M.action==="skip")return void O();typeof M.config=="object"&&(g.instanceConfig=i.extend(g.instanceConfig,M.config))}else if(M==="skip")return void O()}var p=g.instanceConfig.complete;g.instanceConfig.complete=function(L){_(p)&&p(L,g.file,g.inputElem),O()},l.parse(g.file,g.instanceConfig)}}function O(){m.splice(0,1),j()}}),o&&(n.onmessage=function(d){d=d.data,l.WORKER_ID===void 0&&d&&(l.WORKER_ID=d.workerId),typeof d.input=="string"?n.postMessage({workerId:l.WORKER_ID,results:l.parse(d.input,d.config),finished:!0}):(n.File&&d.input instanceof File||d.input instanceof Object)&&(d=l.parse(d.input,d.config))&&n.postMessage({workerId:l.WORKER_ID,results:d,finished:!0})}),(x.prototype=Object.create(f.prototype)).constructor=x,(b.prototype=Object.create(f.prototype)).constructor=b,(D.prototype=Object.create(D.prototype)).constructor=D,(R.prototype=Object.create(f.prototype)).constructor=R,l})}(ht)),ht.exports}var xn=fn();const mn=Ir(xn),gn=async(t,s)=>{switch(s){case"csv":return yn(t);case"excel":return bn(t);case"json":return vn(t);case"xml":return jn(t);case"pdf":return Sn(t);case"txt":return Cn(t);default:throw new Error(`Unsupported file type: ${s}`)}},yn=t=>new Promise((s,r)=>{mn.parse(t,{header:!0,skipEmptyLines:!0,dynamicTyping:!0,complete:n=>{const i=n.meta.fields||[],c=n.data;s({columns:i,data:c.slice(0,100)})},error:n=>{r(new Error(`Error parsing CSV: ${n.message}`))}})}),bn=t=>new Promise((s,r)=>{const n=new FileReader;n.onload=async i=>{var c;try{const o=(c=i.target)==null?void 0:c.result;if(!o){r(new Error("Failed to read Excel file"));return}const h=await lr(()=>import("./xlsx-DkH2s96g.js"),[]),u=h.read(o,{type:"array"}),l=u.SheetNames[0],f=u.Sheets[l],x=h.utils.sheet_to_json(f,{header:1});if(x.length===0){r(new Error("Excel file is empty"));return}const b=x[0].map(String),D=x.slice(1).map(R=>{const k={};return R.forEach((V,F)=>{F<b.length&&(k[b[F]]=V)}),k});s({columns:b,data:D.slice(0,100)})}catch(o){r(new Error(`Error parsing Excel file: ${o instanceof Error?o.message:"Unknown error"}`))}},n.onerror=()=>{r(new Error("Error reading Excel file"))},n.readAsArrayBuffer(t)}),vn=t=>new Promise((s,r)=>{const n=new FileReader;n.onload=i=>{var c;try{const o=(c=i.target)==null?void 0:c.result,h=JSON.parse(o);if(Array.isArray(h)){if(h.length===0){r(new Error("JSON file contains an empty array"));return}const u=Array.from(new Set(h.flatMap(l=>Object.keys(l))));s({columns:u,data:h.slice(0,100)})}else if(h&&typeof h=="object"){const u=Object.keys(h).find(l=>Array.isArray(h[l]));if(u&&h[u].length>0){const l=h[u],f=Array.from(new Set(l.flatMap(x=>Object.keys(x))));s({columns:f,data:l.slice(0,100)})}else{const l=Object.keys(h);s({columns:l,data:[h]})}}else r(new Error("JSON file format not recognized"))}catch(o){r(new Error(`Error parsing JSON file: ${o instanceof Error?o.message:"Invalid JSON"}`))}},n.onerror=()=>{r(new Error("Error reading JSON file"))},n.readAsText(t)}),jn=t=>new Promise((s,r)=>{const n=new FileReader;n.onload=i=>{var c,o;try{const h=(c=i.target)==null?void 0:c.result,l=new DOMParser().parseFromString(h,"text/xml"),f=l.getElementsByTagName("*"),x=new Map;for(let $=0;$<f.length;$++){const T=f[$].tagName;x.set(T,(x.get(T)||0)+1)}const b=Array.from(x.entries()).filter(([$,T])=>T>1).map(([$])=>$).sort(($,T)=>(x.get(T)||0)-(x.get($)||0));if(b.length===0){r(new Error("Could not identify repeating elements in XML"));return}const D=b[0],R=l.getElementsByTagName(D);if(R.length===0){r(new Error(`No elements found with tag ${D}`));return}const k=R[0],F=Array.from(k.children).map($=>$.tagName),N=[];for(let $=0;$<Math.min(R.length,100);$++){const T=R[$],B={};for(const P of F){const _=((o=T.getElementsByTagName(P)[0])==null?void 0:o.textContent)||"";B[P]=_}N.push(B)}s({columns:F,data:N})}catch(h){r(new Error(`Error parsing XML file: ${h instanceof Error?h.message:"Invalid XML"}`))}},n.onerror=()=>{r(new Error("Error reading XML file"))},n.readAsText(t)}),Sn=t=>new Promise((s,r)=>{const n=new FileReader;n.onload=async i=>{var c;try{if(!((c=i.target)==null?void 0:c.result)){r(new Error("Failed to read PDF file"));return}s({columns:["Information"],data:[{Information:"PDF files are not currently supported for direct parsing in the browser."},{Information:"Please convert your PDF to CSV, Excel, or JSON format for processing."},{Information:"Alternatively, copy and paste the data from your PDF into a text file."},{Information:`File name: ${t.name}`},{Information:`File size: ${(t.size/1024).toFixed(2)} KB`},{Information:"Supported formats: CSV, Excel (.xlsx, .xls), JSON, XML, TXT"}]})}catch(o){r(new Error(`Error processing PDF: ${o instanceof Error?o.message:"Unknown error"}`))}},n.onerror=()=>{r(new Error("Error reading PDF file"))},n.readAsArrayBuffer(t)}),Cn=t=>new Promise((s,r)=>{const n=new FileReader;n.onload=i=>{var c;try{const o=(c=i.target)==null?void 0:c.result;if(!o){r(new Error("Failed to read text file"));return}const h=o.split(`
`).map(x=>x.trim()).filter(x=>x.length>0);if(h.length===0){r(new Error("Text file is empty"));return}const u=[",","	","|",";"];let l="",f=0;for(const x of u){const b=h.slice(0,10).map(k=>k.split(x).length),D=b.reduce((k,V)=>k+V,0)/b.length;b.every(k=>Math.abs(k-D)<=1&&k>1)&&D>f&&(f=D,l=x)}if(l&&f>1){const x=h[0].split(l).map(D=>D.trim()),b=[];for(let D=1;D<Math.min(h.length,100);D++){const R=h[D].split(l).map(V=>V.trim()),k={};for(let V=0;V<x.length;V++)k[x[V]]=R[V]||"";b.push(k)}s({columns:x,data:b})}else{const x=h.slice(0,100).map((b,D)=>({LineNumber:D+1,Text:b}));s({columns:["LineNumber","Text"],data:x})}}catch(o){r(new Error(`Error parsing text file: ${o instanceof Error?o.message:"Unknown error"}`))}},n.onerror=()=>{r(new Error("Error reading text file"))},n.readAsText(t)}),wn=()=>{const t=dt(),s=He(n=>n.formatter.selectedTool),r=n=>{const i=n.target.value,c=Yt.find(o=>o.id===i);c&&t(Mr(c))};return e.jsxs(v,{sx:{my:3},children:[e.jsx(y,{variant:"h6",gutterBottom:!0,children:"Select Target Tool"}),e.jsxs(le,{container:!0,spacing:2,children:[e.jsx(le,{size:{xs:12,md:6},children:e.jsxs(Ue,{fullWidth:!0,children:[e.jsx(Ye,{id:"tool-select-label",children:"Tool"}),e.jsx(We,{labelId:"tool-select-label",id:"tool-select",value:(s==null?void 0:s.id)||"",label:"Tool",onChange:r,children:Yt.map(n=>e.jsx(ae,{value:n.id,children:n.name},n.id))})]})}),e.jsx(le,{size:12,children:s&&e.jsxs(he,{variant:"outlined",sx:{p:2,mt:2,borderColor:"primary.light"},children:[e.jsx(y,{variant:"subtitle1",gutterBottom:!0,children:s.name}),e.jsx(y,{variant:"body2",paragraph:!0,children:s.description}),e.jsxs(y,{variant:"body2",color:"text.secondary",children:["Required fields: ",s.requiredFields.map(n=>n.name).join(", ")]})]})})]})]})},Tn=()=>{const t=dt(),s=w.useRef(null),{sourceColumns:r,selectedTool:n}=He($=>$.formatter),[i,c]=w.useState("csv"),[o,h]=w.useState(!1),[u,l]=w.useState(null),[f,x]=w.useState(null),b=$=>{c($.target.value)},D=async $=>{var B;const T=(B=$.target.files)==null?void 0:B[0];if(T){x(T.name),h(!0),l(null);try{t($e("uploading"));const P={id:`file-${Date.now()}`,name:T.name,type:i,size:T.size,lastModified:T.lastModified},{columns:_,data:d}=await gn(T,i);t(Or(P)),t($r(_)),t(Lr(d)),t($e("idle")),setTimeout(()=>{t(Be(1))},500)}catch(P){l(P instanceof Error?P.message:"Failed to parse file"),t($e("error"))}finally{h(!1)}}},R=()=>{var $;($=s.current)==null||$.click()},k=$=>{var B;$.preventDefault(),$.stopPropagation();const T=(B=$.dataTransfer.files)==null?void 0:B[0];if(T&&s.current){const P=new DataTransfer;P.items.add(T),s.current.files=P.files,D({target:{files:P.files}})}},V=$=>{$.preventDefault(),$.stopPropagation()},F=()=>{t(Be(1))},N=r.length>0&&n!==null;return e.jsxs(v,{sx:{width:"100%"},children:[e.jsx(y,{variant:"h5",gutterBottom:!0,children:"Upload Data File"}),e.jsx(y,{variant:"body1",paragraph:!0,children:"Select a file to upload. The formatter supports CSV, Excel (.xlsx, .xls, .xlsm), PDF, JSON, XML, and plain text files."}),e.jsxs(le,{container:!0,spacing:3,children:[e.jsx(le,{size:{xs:12,md:4},children:e.jsxs(Ue,{fullWidth:!0,children:[e.jsx(Ye,{id:"file-type-select-label",children:"File Type"}),e.jsxs(We,{labelId:"file-type-select-label",id:"file-type-select",value:i,label:"File Type",onChange:b,children:[e.jsx(ae,{value:"csv",children:"CSV"}),e.jsx(ae,{value:"excel",children:"Excel (.xlsx/.xls/.xlsm)"}),e.jsx(ae,{value:"json",children:"JSON"}),e.jsx(ae,{value:"xml",children:"XML"}),e.jsx(ae,{value:"pdf",children:"PDF"}),e.jsx(ae,{value:"txt",children:"Text File"})]})]})}),e.jsxs(le,{size:12,children:[e.jsx("input",{type:"file",ref:s,onChange:D,style:{display:"none"},accept:i==="csv"?".csv":i==="excel"?".xlsx,.xls,.xlsm":i==="json"?".json":i==="xml"?".xml":i==="pdf"?".pdf":i==="txt"?".txt":void 0}),e.jsx(he,{elevation:0,onDrop:k,onDragOver:V,sx:{border:"2px dashed #ccc",borderRadius:2,p:3,textAlign:"center",cursor:"pointer",bgcolor:"#f8f9fa","&:hover":{borderColor:"primary.main"}},onClick:R,children:o?e.jsxs(v,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx(Qe,{}),e.jsx(y,{variant:"body1",sx:{mt:2},children:"Processing file..."})]}):e.jsxs(v,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx(Wt,{fontSize:"large",color:"primary"}),e.jsx(y,{variant:"h6",sx:{mt:2},children:f?`Selected: ${f}`:"Drag & drop file here or click to browse"}),e.jsxs(y,{variant:"body2",color:"text.secondary",sx:{mt:1},children:["Supports ",i==="csv"?"CSV":i==="excel"?"Excel (.xlsx, .xls, .xlsm)":i==="json"?"JSON":i==="xml"?"XML":i==="pdf"?"PDF":"Text"," files"]})]})}),u&&e.jsx(pe,{severity:"error",sx:{mt:2},children:u}),f&&!o&&!u&&e.jsxs(pe,{severity:"success",sx:{mt:2},children:["File selected: ",f]})]}),e.jsx(le,{size:12,sx:{mt:2,display:"flex",justifyContent:"center"},children:e.jsx(Z,{variant:"contained",size:"large",onClick:R,startIcon:e.jsx(Wt,{}),disabled:o,children:"Browse Files"})})]}),e.jsx(xe,{sx:{my:4}}),e.jsx(wn,{}),e.jsx(v,{sx:{display:"flex",justifyContent:"flex-end",mt:4},children:e.jsx(Z,{variant:"contained",size:"large",endIcon:e.jsx(Vt,{}),onClick:F,disabled:!N,children:"Continue to Field Mapping"})}),!N&&e.jsx(y,{variant:"body2",color:"text.secondary",sx:{mt:2,textAlign:"right"},children:r.length?"Select a target tool to continue":"Upload a file to continue"})]})},nt=se(e.jsx("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"})),Fn=(t,s)=>!t||!t.length||!s||!s.length?[]:t.map(r=>{const n={};return s.forEach(i=>{const{sourceField:c,targetField:o,transformations:h}=i;let u;if(c==="__default__"&&h&&h.length>0){const l=h.find(f=>f.type==="convert"&&f.params.defaultValue);l?(console.log(`Using default value for ${o}:`,l.params.defaultValue),u=l.params.defaultValue):(console.log(`No default value found for ${o}, using null`),u=null)}else u=r[c],console.log(`Using source value for ${o} from ${c}:`,u);h&&h.length>0&&(u=En(u,h,o)),n[o]=u}),n}),En=(t,s,r)=>s.reduce((n,i)=>Cr(n,i,r),t),Cr=(t,s,r)=>{const{type:n,params:i}=s,c=r?{...i,fieldName:r}:i;switch(n){case"split":return kn(t,c);case"join":return In(t,c);case"format":return Mn(t,c);case"convert":return On(t,c);case"extract":return Dn(t,c);case"replace":return Rn(t,c);default:return t}},Dn=(t,s)=>{if(typeof t!="string")return t;const{pattern:r}=s;try{const n=new RegExp(r),i=t.match(n);if(i&&i.length>0)return i[1]||i[0]}catch{console.error("Invalid regex pattern:",r)}return t},Rn=(t,s)=>{if(typeof t!="string")return t;const{from:r,to:n="",useRegex:i=!1}=s;if(!r)return t;try{if(i){const c=new RegExp(r,"g");return t.replace(c,n)}else return t.replace(new RegExp(r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),n)}catch(c){return console.error("Error in replace transformation:",c),t}},kn=(t,s)=>{if(typeof t!="string")return t;const{delimiter:r,index:n}=s,i=t.split(r);return n!==void 0?i[n]||"":i},In=(t,s)=>{if(!Array.isArray(t))return t;const{delimiter:r=", "}=s;return t.join(r)},Mn=(t,s)=>{const{format:r,type:n,fieldName:i}=s;if(n==="date"&&t)try{const c=new Date(t);if(isNaN(c.getTime()))return t;const o=String(t),h=/\d{1,2}:\d{2}(:\d{2})?/.test(o),u=(i||"").toLowerCase(),l=u.includes("date")&&!u.includes("time"),f=h&&!l,x=b=>{const D=b.getHours().toString().padStart(2,"0"),R=b.getMinutes().toString().padStart(2,"0"),k=b.getSeconds().toString().padStart(2,"0");return`${D}:${R}:${k}`};switch(r){case"MM/DD/YYYY":const b=`${(c.getMonth()+1).toString().padStart(2,"0")}/${c.getDate().toString().padStart(2,"0")}/${c.getFullYear()}`;return f?`${b} ${x(c)}`:b;case"YYYY-MM-DD":const D=`${c.getFullYear()}-${(c.getMonth()+1).toString().padStart(2,"0")}-${c.getDate().toString().padStart(2,"0")}`;return f?`${D} ${x(c)}`:D;case"ISO":return c.toISOString();default:return t}}catch{return t}if(n==="number"&&t!==void 0&&t!==null)try{const c=Number(t);if(isNaN(c))return t;switch(r){case"integer":return Math.round(c);case"fixed2":return c.toFixed(2);case"currency":return`$${c.toFixed(2)}`;case"percent":return`${(c*100).toFixed(1)}%`;default:return t}}catch{return t}return t},On=(t,s)=>{const{targetType:r}=s;switch(r){case"string":return t!=null?String(t):"";case"number":if(t==null||t==="")return null;const n=Number(t);return isNaN(n)?t:n;case"boolean":return typeof t=="string"?["true","yes","1","y"].includes(t.toLowerCase()):!!t;case"date":if(!t)return null;try{const i=new Date(t);return isNaN(i.getTime())?t:i}catch{return t}default:return t}},$n=se(e.jsx("path",{d:"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5"})),Ln=({id:t,isMapped:s,targetFields:r,sampleValue:n,dataType:i})=>{const c={backgroundColor:s?"#f0f7ff":void 0,border:s?"1px solid #90caf9":"1px solid #e0e0e0",cursor:"grab",padding:"8px 12px",borderRadius:"4px",marginBottom:"8px",position:"relative"},o=u=>{console.log("DRAG START on source field:",t),u.dataTransfer.setData("text/plain",t),u.dataTransfer.effectAllowed="move",console.log("Verifying dataTransfer was set:",u.dataTransfer.types);const l=document.createElement("div");l.className="drag-ghost",l.innerHTML=`<div style="padding: 10px; background: #1976d2; color: white; border-radius: 4px;">Dragging: ${t}</div>`,document.body.appendChild(l),u.dataTransfer.setDragImage(l,20,20);const f=u.currentTarget;f.style.opacity="0.6",f.style.boxShadow="0 0 10px rgba(0, 0, 0, 0.2)",setTimeout(()=>{document.body.removeChild(l)},0),console.log("Drag started with field:",t)},h=u=>{const l=u.currentTarget;l.style.opacity="",l.style.boxShadow="",console.log("Drag ended for field:",t)};return e.jsx("div",{style:c,"data-field-id":t,className:"draggable-source-field",draggable:!0,onDragStart:o,onDragEnd:h,children:e.jsxs(v,{sx:{display:"flex",flexDirection:"column",width:"100%"},children:[e.jsxs(v,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsx(y,{variant:"body2",fontWeight:"medium",children:t}),s&&e.jsx(de,{size:"small",icon:e.jsx($n,{fontSize:"small"}),label:r.length===1?r[0]:`${r.length} fields`,color:"primary",variant:"outlined"})]}),n!==void 0&&e.jsxs(v,{sx:{mt:.5,display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:"0.75rem"},children:[e.jsx(y,{variant:"caption",sx:{color:"text.secondary",fontFamily:"monospace",bgcolor:"grey.100",px:.5,borderRadius:.5,maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:typeof n=="object"?JSON.stringify(n):String(n)}),i&&e.jsx(de,{label:i,size:"small",variant:"outlined",sx:{height:"16px",fontSize:"0.65rem","& .MuiChip-label":{px:.5,py:0}}})]})]})})},zn=({sourceColumns:t,filter:s,setFilter:r,mappings:n,sampleData:i=[]})=>{const c=w.useMemo(()=>{if(!s)return t;const f=s.toLowerCase();return t.filter(x=>x.toLowerCase().includes(f))},[t,s]),o=w.useMemo(()=>{const f={};return n.forEach(x=>{f[x.sourceField]||(f[x.sourceField]=[]),f[x.sourceField].push(x.targetField)}),f},[n]),h=w.useMemo(()=>Object.keys(o).length,[o]),u=w.useMemo(()=>{if(!i||i.length===0)return{};const f=i[0],x={};return t.forEach(b=>{x[b]=f[b]}),x},[i,t]),l=w.useMemo(()=>{const f={};return Object.entries(u).forEach(([x,b])=>{if(b==null){f[x]="Unknown";return}if(typeof b=="string"){if([/^\d{4}-\d{2}-\d{2}$/,/^\d{1,2}\/\d{1,2}\/\d{2,4}$/,/^\d{4}\/\d{2}\/\d{2}$/].some(k=>k.test(b))){f[x]="Date";return}if([/^\d{1,2}:\d{2}(:\d{2})?$/,/^\d{1,2}:\d{2}(:\d{2})?\s*(AM|PM)$/i].some(k=>k.test(b))){f[x]="Time";return}if(!isNaN(Number(b))){f[x]="Number";return}f[x]="Text";return}typeof b=="number"?f[x]="Number":typeof b=="boolean"?f[x]="Boolean":Array.isArray(b)?f[x]="Array":typeof b=="object"?f[x]="Object":f[x]=typeof b}),f},[u]);return e.jsxs(he,{sx:{height:"100%",p:2,display:"flex",flexDirection:"column",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",border:"2px solid #e0e0e0",borderRadius:"8px",overflow:"hidden"},children:[e.jsx(be,{size:"small",placeholder:"Search source fields...",value:s,onChange:f=>r(f.target.value),fullWidth:!0,sx:{mb:2},InputProps:{startAdornment:e.jsx(Oe,{position:"start",children:e.jsx(at,{fontSize:"small"})})}}),e.jsxs(v,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsxs(y,{variant:"body2",color:"text.secondary",children:[c.length," fields"]}),e.jsxs(y,{variant:"body2",color:"text.secondary",children:[h," mapped"]})]}),e.jsx(v,{sx:{mb:2,p:1,bgcolor:"rgba(25, 118, 210, 0.08)",borderRadius:1,border:"1px dashed",borderColor:"primary.main"},children:e.jsx(y,{variant:"body2",color:"primary",sx:{fontWeight:"bold"},children:"Drag fields from here to the Target Fields panel"})}),e.jsx(xe,{sx:{mb:2}}),e.jsxs(v,{sx:{flexGrow:1,overflow:"auto",maxHeight:"calc(100% - 180px)",scrollbarWidth:"thin",border:"1px solid #e0e0e0",borderRadius:"4px",padding:"8px",backgroundColor:"#fafafa","&::-webkit-scrollbar":{width:"10px"},"&::-webkit-scrollbar-track":{background:"#f1f1f1",borderRadius:"4px"},"&::-webkit-scrollbar-thumb":{background:"#2196f3",borderRadius:"4px","&:hover":{background:"#1976d2"}}},children:[c.map(f=>e.jsx(Ln,{id:f,isMapped:!!o[f],targetFields:o[f]||[],sampleValue:u[f],dataType:l[f]},f)),c.length===0&&e.jsx(v,{sx:{textAlign:"center",py:4},children:e.jsx(y,{variant:"body2",color:"text.secondary",children:"No fields match your search"})})]})]})},wr=se(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-2h2zm0-4h-2V7h2z"})),_n=se(e.jsx("path",{d:"m20.5 10 .5-2h-4l1-4h-2l-1 4h-4l1-4h-2L9 8H5l-.5 2h4l-1 4h-4L3 16h4l-1 4h2l1-4h4l-1 4h2l1-4h4l.5-2h-4l1-4zm-7 4h-4l1-4h4z"})),An=se(e.jsx("path",{d:"M20 3h-1V1h-2v2H7V1H5v2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 18H4V8h16z"})),Pn=se(e.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2m-9 14-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"})),Nn=({open:t,onClose:s,fieldName:r,mapping:n,sampleData:i,onSave:c})=>{const[o,h]=w.useState(0),[u,l]=w.useState([]),[f,x]=w.useState("auto"),[b,D]=w.useState(""),[R,k]=w.useState(","),[V,F]=w.useState(0),[N,$]=w.useState("string");w.useEffect(()=>{if(n){if(n.sourceField&&i.length>0){const a=i.map(m=>m[n.sourceField]).filter(m=>m!=null).slice(0,5);l(a)}n.transformations&&n.transformations.length>0&&n.transformations.forEach(a=>{switch(a.type){case"format":a.params.dateFormat&&(a.params.dateFormat==="custom"?(x("custom"),D(a.params.customFormat||"")):x(a.params.dateFormat));break;case"split":k(a.params.delimiter||","),F(a.params.index||0);break;case"convert":$(a.params.toType||"string");break}})}},[n,i]);const T=(a,m)=>{h(m)},B=()=>{const a=[];o===0&&f!=="auto"&&a.push({type:"format",params:{dateFormat:f,fieldName:r,...f==="custom"?{customFormat:b}:{}}}),o===1&&a.push({type:"split",params:{delimiter:R,index:V}}),o===2&&a.push({type:"convert",params:{toType:N}}),c(r,a)},P=u.length>0,d=(()=>{if(!P)return[];switch(o){case 0:return u.map(a=>{if(!a)return"N/A";try{const m=new Date(a);if(isNaN(m.getTime()))return"Invalid date";const j=String(a),O=/\d{1,2}:\d{2}(:\d{2})?/.test(j),U=r.toLowerCase(),X=U.includes("date")&&!U.includes("time"),ne=O&&!X,E=g=>{const M=g.getHours().toString().padStart(2,"0"),p=g.getMinutes().toString().padStart(2,"0"),L=g.getSeconds().toString().padStart(2,"0");return`${M}:${p}:${L}`};switch(f){case"auto":return m.toLocaleString();case"MM/DD/YYYY":const g=`${m.getMonth()+1}/${m.getDate()}/${m.getFullYear()}`;return ne?`${g} ${E(m)}`:g;case"YYYY-MM-DD":const M=`${m.getFullYear()}-${(m.getMonth()+1).toString().padStart(2,"0")}-${m.getDate().toString().padStart(2,"0")}`;return ne?`${M} ${E(m)}`:M;case"DD/MM/YYYY":const p=`${m.getDate()}/${m.getMonth()+1}/${m.getFullYear()}`;return ne?`${p} ${E(m)}`:p;case"custom":return b.replace("YYYY",m.getFullYear().toString()).replace("MM",(m.getMonth()+1).toString().padStart(2,"0")).replace("DD",m.getDate().toString().padStart(2,"0")).replace("HH",m.getHours().toString().padStart(2,"0")).replace("mm",m.getMinutes().toString().padStart(2,"0")).replace("ss",m.getSeconds().toString().padStart(2,"0"));default:return m.toLocaleString()}}catch{return"Error formatting date"}});case 1:return u.map(a=>{if(!a)return"N/A";try{return a.toString().split(R)[V]||`Index ${V} not found`}catch{return"Error splitting value"}});case 2:return u.map(a=>{if(a==null)return"N/A";try{switch(N){case"string":return String(a);case"number":return Number(a);case"boolean":return(!!a).toString();default:return String(a)}}catch{return"Error converting value"}})}return[]})();return e.jsxs(it,{open:t,onClose:s,maxWidth:"md",fullWidth:!0,children:[e.jsxs(ot,{children:["Transform Field: ",r]}),e.jsx(lt,{dividers:!0,children:e.jsxs(v,{sx:{width:"100%"},children:[e.jsx(v,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(gt,{value:o,onChange:T,"aria-label":"transformation tabs",children:[e.jsx(Ee,{label:"Date/Time Format"}),e.jsx(Ee,{label:"Split/Extract"}),e.jsx(Ee,{label:"Type Conversion"})]})}),e.jsxs(v,{role:"tabpanel",hidden:o!==0,sx:{p:2},children:[e.jsx(y,{variant:"subtitle1",gutterBottom:!0,children:"Date Format Settings"}),e.jsx(y,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Choose how date and time values should be formatted."}),e.jsxs(Ue,{fullWidth:!0,sx:{mb:2},children:[e.jsx(Ye,{id:"date-format-label",children:"Date Format"}),e.jsxs(We,{labelId:"date-format-label",id:"date-format-select",value:f,label:"Date Format",onChange:a=>x(a.target.value),children:[e.jsx(ae,{value:"auto",children:"Auto-detect"}),e.jsx(ae,{value:"MM/DD/YYYY",children:"MM/DD/YYYY"}),e.jsx(ae,{value:"DD/MM/YYYY",children:"DD/MM/YYYY"}),e.jsx(ae,{value:"YYYY-MM-DD",children:"YYYY-MM-DD"}),e.jsx(ae,{value:"custom",children:"Custom Format"})]})]}),f==="custom"&&e.jsx(be,{fullWidth:!0,label:"Custom Format",value:b,onChange:a=>D(a.target.value),helperText:"Use YYYY for year, MM for month, DD for day, HH for hour, mm for minute, ss for second",sx:{mb:2}})]}),e.jsxs(v,{role:"tabpanel",hidden:o!==1,sx:{p:2},children:[e.jsx(y,{variant:"subtitle1",gutterBottom:!0,children:"Split or Extract Value"}),e.jsx(y,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Split a field by a delimiter and extract a specific part."}),e.jsx(be,{fullWidth:!0,label:"Delimiter",value:R,onChange:a=>k(a.target.value),helperText:"Character or text that separates the parts",sx:{mb:2}}),e.jsx(be,{fullWidth:!0,label:"Index",type:"number",value:V,onChange:a=>F(parseInt(a.target.value)||0),helperText:"Position of the part to extract (0 = first part)",sx:{mb:2}})]}),e.jsxs(v,{role:"tabpanel",hidden:o!==2,sx:{p:2},children:[e.jsx(y,{variant:"subtitle1",gutterBottom:!0,children:"Type Conversion"}),e.jsx(y,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Convert the value to a different data type."}),e.jsxs(Ue,{fullWidth:!0,sx:{mb:2},children:[e.jsx(Ye,{id:"convert-type-label",children:"Convert To"}),e.jsxs(We,{labelId:"convert-type-label",id:"convert-type-select",value:N,label:"Convert To",onChange:a=>$(a.target.value),children:[e.jsx(ae,{value:"string",children:"Text (String)"}),e.jsx(ae,{value:"number",children:"Number"}),e.jsx(ae,{value:"boolean",children:"True/False (Boolean)"})]})]})]}),e.jsx(xe,{sx:{my:2}}),e.jsx(y,{variant:"subtitle1",gutterBottom:!0,children:"Preview"}),P?e.jsxs(v,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsxs(v,{sx:{display:"flex",borderBottom:1,borderColor:"divider",pb:1},children:[e.jsx(y,{variant:"body2",fontWeight:"bold",sx:{width:"50%"},children:"Original Value"}),e.jsx(y,{variant:"body2",fontWeight:"bold",sx:{width:"50%"},children:"Transformed Value"})]}),u.map((a,m)=>e.jsxs(v,{sx:{display:"flex",py:1,borderBottom:"1px solid #eee"},children:[e.jsx(y,{variant:"body2",sx:{width:"50%"},children:a==null?"Null/Empty":String(a)}),e.jsx(y,{variant:"body2",sx:{width:"50%"},children:d[m]})]},m))]}):e.jsx(pe,{severity:"info",children:"No sample data available for preview."})]})}),e.jsxs(ct,{children:[e.jsx(Z,{onClick:s,children:"Cancel"}),e.jsx(Z,{onClick:B,variant:"contained",children:"Apply Transformation"})]})]})},Vn=t=>{switch(t.dataType){case"string":return`DEFAULT-${t.name}`;case"number":return"0";case"boolean":return"false";case"date":return new Date().toISOString().split("T")[0];case"location":return"0.0,0.0";default:return""}},Bn=({open:t,onClose:s,unmappedRequiredFields:r,onAddDefaultMappings:n})=>{const[i,c]=w.useState(()=>{const l={};return r.forEach(f=>{l[f.name]=Vn(f)}),l}),o=(l,f)=>{c(x=>({...x,[l]:f}))},h=()=>{console.log("Creating default mappings for fields:",r),console.log("Default values:",i);const l=r.map(f=>{const x={sourceField:"__default__",targetField:f.name,transformations:[{type:"convert",params:{defaultValue:i[f.name],targetType:f.dataType}}]};return console.log(`Created default mapping for ${f.name}:`,x),x});console.log("All default mappings:",l),n(l),s()},u=l=>{switch(l){case"number":return"number";case"date":return"date";default:return"text"}};return e.jsxs(it,{open:t,onClose:s,"aria-labelledby":"default-value-dialog-title",maxWidth:"md",fullWidth:!0,children:[e.jsx(ot,{id:"default-value-dialog-title",children:"Set Default Values for Required Fields"}),e.jsxs(lt,{children:[e.jsx(y,{variant:"body1",sx:{mb:3},children:"The following required fields don't have mappings. Please provide default values for them."}),e.jsx(le,{container:!0,spacing:3,children:r.map(l=>e.jsxs(le,{size:{xs:12,sm:6},children:[e.jsxs(v,{sx:{mb:1},children:[e.jsxs(y,{variant:"subtitle2",children:[l.name,e.jsx(de,{size:"small",label:l.dataType,color:"primary",variant:"outlined",sx:{ml:1}})]}),e.jsx(y,{variant:"caption",color:"text.secondary",children:l.description})]}),l.dataType==="boolean"?e.jsxs(be,{select:!0,fullWidth:!0,value:i[l.name]||"false",onChange:f=>o(l.name,f.target.value),variant:"outlined",size:"small",children:[e.jsx(ae,{value:"true",children:"True"}),e.jsx(ae,{value:"false",children:"False"})]}):e.jsx(be,{fullWidth:!0,value:i[l.name]||"",onChange:f=>o(l.name,f.target.value),type:u(l.dataType),variant:"outlined",size:"small",placeholder:`Enter default value for ${l.name}`,InputLabelProps:{shrink:!0}}),e.jsx(ts,{children:"Default value for all records"})]},l.name))})]}),e.jsxs(ct,{children:[e.jsx(Z,{onClick:s,color:"primary",children:"Cancel"}),e.jsx(Z,{onClick:h,color:"primary",variant:"contained",children:"Apply Default Values"})]})]})},Un=se(e.jsx("path",{d:"M16.01 11H4v2h12.01v3L20 12l-3.99-4z"})),Lt=se(e.jsx("path",{d:"M7.5 5.6 10 7 8.6 4.5 10 2 7.5 3.4 5 2l1.4 2.5L5 7zm12 9.8L17 14l1.4 2.5L17 19l2.5-1.4L22 19l-1.4-2.5L22 14zM22 2l-2.5 1.4L17 2l1.4 2.5L17 7l2.5-1.4L22 7l-1.4-2.5zm-7.63 5.29a.996.996 0 0 0-1.41 0L1.29 18.96c-.39.39-.39 1.02 0 1.41l2.34 2.34c.39.39 1.02.39 1.41 0L16.7 11.05c.39-.39.39-1.02 0-1.41zm-1.03 5.49-2.12-2.12 2.44-2.44 2.12 2.12z"})),xt=se(e.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"})),Tr=se(e.jsx("path",{d:"M16.59 7.58 10 14.17l-3.59-3.58L5 12l5 5 8-8zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"})),Hn=({mapping:t,sampleData:s,onClose:r})=>{const n=_t(),i=w.useMemo(()=>!t||!s.length?[]:s.slice(0,5).map(o=>({sourceValue:o[t.sourceField],transformedValue:(t.transformations||[]).reduce((h,u)=>Cr(h,u),o[t.sourceField])})),[t,s]);if(!t)return e.jsx(he,{sx:{p:2,mt:2,backgroundColor:ce(n.palette.info.light,.1),border:`1px dashed ${n.palette.info.main}`,borderRadius:1},children:e.jsx(y,{variant:"body2",color:"text.secondary",align:"center",children:"Select a field mapping to see transformation preview"})});if(!i.length||!t.sourceField)return e.jsx(he,{sx:{p:2,mt:2,backgroundColor:ce(n.palette.warning.light,.1),border:`1px dashed ${n.palette.warning.main}`,borderRadius:1},children:e.jsxs(y,{variant:"body2",color:"text.secondary",children:["No sample data available for ",t.sourceField||"this field"]})});const c=t.transformations||[];return e.jsxs(he,{sx:{p:2,mt:2,borderRadius:1,border:`1px solid ${n.palette.divider}`,boxShadow:n.shadows[1],position:"relative"},children:[r&&e.jsx(De,{size:"small",onClick:r,sx:{position:"absolute",top:8,right:8,color:n.palette.grey[500],"&:hover":{backgroundColor:ce(n.palette.grey[100],.9),color:n.palette.grey[800]}},"aria-label":"close preview",children:e.jsx(Vr,{fontSize:"small"})}),e.jsxs(v,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1,pr:4},children:[e.jsxs(y,{variant:"subtitle2",color:"primary",gutterBottom:!0,children:["Field Transformation Preview: ",t.targetField]}),e.jsx(de,{size:"small",label:`${c.length} transformation${c.length!==1?"s":""}`,color:c.length>0?"primary":"default",icon:c.length>0?e.jsx(Lt,{}):void 0})]}),e.jsx(xe,{sx:{mb:2}}),e.jsx(v,{sx:{maxHeight:200,overflow:"auto"},children:i.map((o,h)=>{const u=o.sourceValue!==void 0&&o.sourceValue!==null,l=c.length>0,f=typeof o.sourceValue,x=typeof o.transformedValue,b=f!==x;return e.jsxs(v,{sx:{mb:1,p:1,borderRadius:1,backgroundColor:h%2===0?ce(n.palette.background.default,.5):"transparent",display:"flex",alignItems:"center"},children:[e.jsxs(v,{sx:{flexBasis:"45%"},children:[e.jsxs(y,{variant:"caption",color:"text.secondary",children:["Source (",t.sourceField,")"]}),e.jsx(y,{variant:"body2",sx:{fontFamily:"monospace",backgroundColor:u?ce(n.palette.success.light,.1):ce(n.palette.error.light,.1),p:.5,borderRadius:.5,wordBreak:"break-all"},children:u?String(o.sourceValue):"(empty)"}),e.jsx(y,{variant:"caption",color:"text.secondary",children:f})]}),e.jsx(v,{sx:{flexBasis:"10%",textAlign:"center"},children:e.jsx(Un,{color:l?"primary":"action"})}),e.jsxs(v,{sx:{flexBasis:"45%"},children:[e.jsxs(y,{variant:"caption",color:"text.secondary",children:["Result (",t.targetField,")"]}),e.jsx(y,{variant:"body2",sx:{fontFamily:"monospace",backgroundColor:o.transformedValue!==void 0?ce(n.palette.success.light,.1):ce(n.palette.error.light,.1),p:.5,borderRadius:.5,wordBreak:"break-all"},children:o.transformedValue!==void 0?String(o.transformedValue):"(empty)"}),e.jsxs(v,{sx:{display:"flex",justifyContent:"space-between",mt:.5},children:[e.jsx(y,{variant:"caption",color:"text.secondary",children:x}),b&&e.jsx(de,{size:"small",label:`Type: ${f}  ${x}`,color:"warning",variant:"outlined",sx:{height:16,fontSize:"0.6rem"}})]})]})]},h)})}),c.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(xe,{sx:{my:2}}),e.jsx(y,{variant:"subtitle2",gutterBottom:!0,children:"Transformation Steps Applied:"}),e.jsx(v,{sx:{display:"flex",flexDirection:"column",gap:1},children:c.map((o,h)=>{var u,l,f,x,b,D;return e.jsxs(v,{sx:{display:"flex",alignItems:"center",p:1,borderRadius:1,backgroundColor:ce(n.palette.primary.light,.05),border:`1px solid ${ce(n.palette.primary.light,.2)}`},children:[e.jsxs(v,{sx:{mr:1,color:n.palette.primary.main},children:[h+1,"."]}),e.jsxs(y,{variant:"body2",children:[e.jsxs("strong",{children:[o.type,":"]})," "," ",o.type==="convert"&&((u=o.params)==null?void 0:u.dataType)&&`Convert to ${o.params.dataType}`,o.type==="convert"&&((l=o.params)==null?void 0:l.defaultValue)!==void 0&&`Set default value to "${o.params.defaultValue}"`,o.type==="format"&&((f=o.params)==null?void 0:f.pattern)&&`Format using pattern "${o.params.pattern}"`,o.type==="extract"&&((x=o.params)==null?void 0:x.pattern)&&`Extract using pattern "${o.params.pattern}"`,o.type==="replace"&&((b=o.params)==null?void 0:b.from)&&((D=o.params)==null?void 0:D.to)&&`Replace "${o.params.from}" with "${o.params.to}"`]})]},h)})})]}),t.targetField&&e.jsxs(v,{sx:{mt:2,p:1,borderRadius:1,display:"flex",alignItems:"center",backgroundColor:i.some(o=>o.transformedValue===void 0||o.transformedValue===null)?ce(n.palette.warning.light,.1):ce(n.palette.success.light,.1)},children:[i.some(o=>o.transformedValue===void 0||o.transformedValue===null)?e.jsx(xt,{color:"warning",sx:{mr:1}}):e.jsx(Tr,{color:"success",sx:{mr:1}}),e.jsx(y,{variant:"body2",children:i.some(o=>o.transformedValue===void 0||o.transformedValue===null)?"Some values could not be transformed. Consider adding a default value.":"All sample values were successfully transformed."})]})]})},Yn=se(e.jsx("path",{d:"M11 18h2v-2h-2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8m0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4"})),Wn=ue(({className:t,...s})=>e.jsx(Br,{...s,classes:{popper:t}}))(()=>({"& .MuiTooltip-tooltip":{backgroundColor:"transparent",padding:0,maxWidth:320}})),qn=ue(he)(({theme:t})=>({padding:t.spacing(2),backgroundColor:t.palette.background.paper,boxShadow:t.shadows[3],borderRadius:t.shape.borderRadius,border:`1px solid ${t.palette.divider}`,minWidth:200,maxWidth:320})),Gn=ue(y)(({theme:t})=>({fontWeight:600,marginBottom:t.spacing(1),borderBottom:`1px solid ${t.palette.divider}`,paddingBottom:t.spacing(.5),color:t.palette.primary.main})),Ke=({title:t,children:s,content:r,icon:n=!1,placement:i="top",enterDelay:c=100,leaveDelay:o=100})=>{console.log(`EnhancedTooltip rendering: ${t} with icon=${n}`);const h=n?e.jsxs(v,{sx:{display:"inline-flex",alignItems:"center"},children:[s,e.jsx(Yn,{color:"action",fontSize:"small",sx:{ml:.5,opacity:.7}})]}):s;return e.jsx(Wn,{title:e.jsxs(qn,{children:[e.jsx(Gn,{variant:"subtitle2",children:t}),r]}),placement:i,arrow:!0,enterDelay:c,leaveDelay:o,children:h})},Jn=({toolConfig:t,showAllFields:s,setShowAllFields:r,filter:n,setFilter:i,mappings:c,onMappingChange:o,onRemoveMapping:h,validationErrors:u,sampleData:l,sourceColumns:f=[]})=>{const x=_t();console.log("TargetFieldsPanel received sourceColumns:",f),console.log("TargetFieldsPanel received toolConfig:",t),console.log("TargetFieldsPanel received mappings:",c);const[b,D]=w.useState(null),[R,k]=w.useState(null),[V,F]=w.useState({Timing:!0,Location:!0,"Incident Details":!0}),N=w.useMemo(()=>{const p={};return u.forEach(L=>{p[L.field]={message:L.message,severity:L.severity}}),p},[u]),$=w.useMemo(()=>{const p={};return c.forEach(L=>{p[L.targetField]=L.sourceField}),p},[c]),T=w.useMemo(()=>{const p={};return[...t.requiredFields,...t.optionalFields].forEach(S=>{let I;S.dataType==="date"||S.name.toLowerCase().includes("time")||S.name.toLowerCase().includes("date")?I="Timing":S.dataType==="location"||S.name.toLowerCase().includes("lat")||S.name.toLowerCase().includes("lon")||S.name.toLowerCase().includes("address")?I="Location":I="Incident Details",p[I]||(p[I]=[]),p[I].push(S)}),p},[t]),B=w.useMemo(()=>{if(!n)return s?[...t.requiredFields,...t.optionalFields]:T;const p=n.toLowerCase(),S=[...t.requiredFields,...t.optionalFields].filter(C=>{var Y;return C.name.toLowerCase().includes(p)||((Y=C.description)==null?void 0:Y.toLowerCase().includes(p))});if(s)return S;const I={};return S.forEach(C=>{let Y;for(const[q,K]of Object.entries(T))if(K.some(G=>G.id===C.id)){Y=q;break}Y||(Y="Other"),I[Y]||(I[Y]=[]),I[Y].push(C)}),I},[t,n,s,T]),P=p=>{F({...V,[p]:!V[p]})},_=(p,L)=>{console.log("Dropdown selection - mapping",L,"to",p);try{if(!L){h(p);return}o({sourceField:L,targetField:p}),console.log("Mapping updated via dropdown successfully")}catch(S){console.error("Error updating mapping via dropdown:",S)}},d=p=>{D(p)},a=()=>{D(null)},m=p=>{k(L=>L===p?null:p)},j=(p,L)=>{const S=c.find(I=>I.targetField===p);S&&o({...S,transformations:L}),D(null)},O=p=>{switch(p){case"string":return{icon:e.jsx(qt,{fontSize:"small"}),color:"info"};case"number":return{icon:e.jsx(_n,{fontSize:"small"}),color:"secondary"};case"date":return{icon:e.jsx(An,{fontSize:"small"}),color:"warning"};case"boolean":return{icon:e.jsx(Pn,{fontSize:"small"}),color:"success"};case"location":return{icon:e.jsx(ns,{fontSize:"small"}),color:"error"};default:return{icon:e.jsx(qt,{fontSize:"small"}),color:"default"}}},U=p=>{const L=$[p.name],S=N[p.name],I=R===p.name;console.log(`Rendering field ${p.name}, mapped to: ${L||"none"}`);const C=z=>{z.preventDefault(),z.stopPropagation(),z.dataTransfer.dropEffect="move";const H=z.currentTarget;H.style.boxShadow="0 0 0 2px #1976d2",H.style.borderColor="#1976d2",H.style.backgroundColor="#f0f7ff",H.style.transform="scale(1.01)",H.style.transition="all 0.2s ease",console.log("DRAG OVER on target field:",p.name)},Y=z=>{z.preventDefault(),z.stopPropagation();const H=z.currentTarget;H.style.boxShadow="",H.style.borderColor=S?S.severity==="error"?"#f44336":"#ff9800":L?"#4caf50":"#e0e0e0",H.style.backgroundColor=S?S.severity==="error"?"#fff5f5":"#fffbf0":L?"#f4fbf4":"#ffffff",H.style.transform="",console.log("DRAG LEAVE from field:",p.name)},q=z=>{z.preventDefault(),z.stopPropagation(),console.log("DROP EVENT TRIGGERED on field:",p.name);try{const H=z.dataTransfer.getData("text/plain");if(console.log("Dropped source field data:",H),!H){console.error("No source field data found in the drop event");return}const A=z.currentTarget;A.style.boxShadow="",A.style.borderColor="",A.style.backgroundColor="",A.style.transform="",o({sourceField:H,targetField:p.name}),k(p.name),A.style.boxShadow="0 0 0 2px #4caf50",A.style.borderColor="#4caf50",A.style.backgroundColor="#f4fbf4",A.style.transform="scale(1.02)";const oe=H;setTimeout(()=>{try{oe?(A.style.borderColor="#4caf50",A.style.backgroundColor="#f4fbf4"):(A.style.borderColor=S?S.severity==="error"?"#f44336":"#ff9800":"#e0e0e0",A.style.backgroundColor=S?S.severity==="error"?"#fff5f5":"#fffbf0":"#ffffff"),A.style.boxShadow="",A.style.transform=""}catch(ee){console.error("Error in animation cleanup:",ee)}},1e3),console.log(`Successfully dropped ${H} onto ${p.name}`)}catch(H){console.error("Error in drop handler:",H)}},K=()=>{L&&m(p.name)},G=()=>e.jsxs(v,{children:[e.jsxs(y,{variant:"body2",children:[e.jsx("strong",{children:"Required Format:"})," ",p.format||"No specific format required"]}),p.examples&&e.jsxs(v,{sx:{mt:1},children:[e.jsx(y,{variant:"body2",children:e.jsx("strong",{children:"Examples:"})}),e.jsx(v,{component:"ul",sx:{mt:.5,pl:2},children:p.examples.map((z,H)=>e.jsx(v,{component:"li",children:e.jsx(y,{variant:"body2",fontFamily:"monospace",children:z})},H))})]}),p.validation&&e.jsxs(y,{variant:"body2",sx:{mt:1},children:[e.jsx("strong",{children:"Validation:"})," ",String(p.validation)]})]}),W=()=>{let z="";switch(p.dataType){case"string":z="Text value. Can contain any characters.";break;case"number":z="Numeric value. Can be integer or decimal.";break;case"date":z="Date value. Should be in a standard format.";break;case"boolean":z="True/False value.";break;case"location":z="Geographic coordinates or address.";break;default:z=`${p.dataType} data type.`}return e.jsxs(v,{children:[e.jsx(y,{variant:"body2",children:z}),p.dataType==="date"&&e.jsx(y,{variant:"body2",sx:{mt:1},children:"Common formats: YYYY-MM-DD, MM/DD/YYYY"})]})};return e.jsxs(v,{sx:{p:2,mb:2,border:"1px solid",borderColor:S?S.severity==="error"?"error.main":"warning.main":L?"success.light":"divider",borderRadius:1,bgcolor:S?S.severity==="error"?ce(x.palette.error.light,.1):ce(x.palette.warning.light,.1):L?ce(x.palette.success.light,.1):"background.paper",position:"relative",transition:"all 0.3s ease",userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",cursor:L?"pointer":"default",...I&&{boxShadow:"0 0 0 2px #1976d2",border:"1px solid #1976d2"},"&:hover":L?{boxShadow:"0 2px 4px rgba(0,0,0,0.1)",transform:"translateY(-2px)"}:{}},draggable:!1,id:`target-field-${p.name}`,"data-target-field":p.name,onDragOver:C,onDragLeave:Y,onDrop:q,onClick:K,children:[e.jsxs(v,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsxs(v,{children:[e.jsx(Ke,{title:`${p.name} Field`,content:G(),placement:"top-start",icon:!0,children:e.jsxs(y,{variant:"subtitle2",component:"div",sx:{display:"inline-flex",alignItems:"center",cursor:"help"},children:[p.name,p.isRequired&&e.jsx(de,{size:"small",label:"Required",color:"primary",sx:{ml:1,height:20}}),L&&e.jsx(de,{size:"small",label:"Click to preview",color:"info",variant:"outlined",sx:{ml:1,height:20,display:{xs:"none",sm:"flex"},animation:I?"none":"pulse 1.5s infinite","@keyframes pulse":{"0%":{boxShadow:"0 0 0 0 rgba(33, 150, 243, 0.4)"},"70%":{boxShadow:"0 0 0 6px rgba(33, 150, 243, 0)"},"100%":{boxShadow:"0 0 0 0 rgba(33, 150, 243, 0)"}}}})]})}),p.dataType&&e.jsx(Ke,{title:`${p.dataType} Data Type`,content:W(),children:e.jsx(de,{size:"small",label:p.dataType,color:O(p.dataType).color,variant:"outlined",icon:O(p.dataType).icon,sx:{mt:1,mr:1,height:20}})}),e.jsx(y,{variant:"body2",color:"text.secondary",children:p.description})]}),e.jsxs(v,{sx:{display:"flex",alignItems:"flex-start"},children:[S&&e.jsx(Ke,{title:"Validation Issue",content:e.jsx(y,{variant:"body2",children:S.message}),type:S.severity==="error"?"warning":"info",children:e.jsx(v,{sx:{display:"flex",alignItems:"center",mr:1},children:S.severity==="error"?e.jsx(wr,{color:"error",fontSize:"small"}):e.jsx(fr,{color:"warning",fontSize:"small"})})}),L&&e.jsxs(e.Fragment,{children:[e.jsx(Ke,{title:"Edit Transformations",content:e.jsx(y,{variant:"body2",children:"Configure data transformations for this field mapping. Apply operations like splitting, joining, formatting and type conversion."}),children:e.jsx(De,{size:"small",onClick:z=>{z.stopPropagation(),d(p.name)},sx:{mr:1},children:e.jsx(xr,{fontSize:"small"})})}),e.jsx(Ke,{title:"Remove Mapping",content:e.jsx(y,{variant:"body2",children:"Remove the current mapping between source and target fields."}),type:"warning",children:e.jsx(De,{size:"small",onClick:z=>{z.stopPropagation(),h(p.name)},children:e.jsx(ft,{fontSize:"small"})})})]})]})]}),e.jsxs(Ue,{fullWidth:!0,size:"small",children:[e.jsx(Ye,{id:`${p.id}-source-label`,children:"Select source field"}),e.jsxs(We,{labelId:`${p.id}-source-label`,id:`${p.id}-source-select`,value:L||"",label:"Select source field",onChange:z=>{try{_(p.name,z.target.value),z.target.value?k(p.name):R===p.name&&k(null)}catch(H){console.error("Error in dropdown change handler:",H)}},MenuProps:{anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},slotProps:{paper:{elevation:4,style:{maxHeight:300}}}},renderValue:z=>z||e.jsx("em",{style:{color:"rgba(0, 0, 0, 0.54)"},children:"Select field or drag from left"}),endAdornment:L&&e.jsx(Oe,{position:"end",children:e.jsx(Ke,{title:"Field is Mapped",content:e.jsxs(y,{variant:"body2",children:['This field is mapped to source field "',L,'". Click the field to preview the mapping.']}),children:e.jsx(st,{color:"success",fontSize:"small"})})}),onClick:z=>z.stopPropagation(),children:[e.jsx(ae,{value:"",children:e.jsx("em",{style:{color:"rgba(0, 0, 0, 0.54)"},children:"Select field or drag from left"})}),Array.isArray(f)&&f.length>0?f.map(z=>{const H=l&&l.length>0?l[0][z]:void 0;let A="Unknown";H!=null&&(typeof H=="string"?[/^\d{4}-\d{2}-\d{2}$/,/^\d{1,2}\/\d{1,2}\/\d{2,4}$/].some(te=>te.test(H))?A="Date":/^\d{1,2}:\d{2}(:\d{2})?(\s*(AM|PM))?$/i.test(H)?A="Time":isNaN(Number(H))?A="Text":A="Number":A=typeof H);const oe=ee=>ee==null?"":typeof ee=="object"?JSON.stringify(ee).substring(0,30):String(ee).substring(0,30);return e.jsx(ae,{value:z,children:e.jsxs(v,{sx:{display:"flex",flexDirection:"column",width:"100%"},children:[e.jsx(y,{variant:"body2",children:z}),H!==void 0&&e.jsxs(v,{sx:{display:"flex",justifyContent:"space-between",mt:.5},children:[e.jsx(y,{variant:"caption",sx:{fontFamily:"monospace",bgcolor:"grey.100",px:.5,borderRadius:.5,maxWidth:"120px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:"text.secondary"},children:oe(H)}),e.jsx(de,{label:A,size:"small",sx:{height:16,fontSize:"0.65rem","& .MuiChip-label":{px:.5,py:0}}})]})]})},z)}):e.jsx(ae,{disabled:!0,children:e.jsx("em",{children:"No source fields available"})})]})]})]},p.id)},X=()=>{if(s){const p=Array.isArray(B)?B:Object.values(B).flat();return e.jsx(v,{children:p.map(U)})}else return Object.entries(B).map(([p,L])=>e.jsxs(ur,{expanded:V[p]||!1,onChange:()=>P(p),sx:{mb:2},children:[e.jsxs(pr,{expandIcon:e.jsx(yt,{}),children:[e.jsx(y,{variant:"subtitle1",children:p}),e.jsxs(y,{variant:"body2",color:"text.secondary",sx:{ml:2},children:[L.length," fields"]})]}),e.jsx(hr,{children:L.map(U)})]},p))},[ne,E]=w.useState(!1),g=w.useMemo(()=>t.requiredFields.filter(L=>!c.some(S=>S.targetField===L.name)),[t.requiredFields,c]),M=p=>{console.log("Received default mappings:",p),p.forEach(L=>{console.log("Adding default mapping for:",L.targetField,L),o(L)}),console.log("Current mappings after adding defaults:",c)};return e.jsxs(he,{sx:{p:2,height:"100%",display:"flex",flexDirection:"column",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",border:"2px solid #e0e0e0",borderRadius:"8px",overflow:"hidden"},children:[e.jsxs(v,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[g.length>0&&e.jsxs(Z,{variant:"outlined",size:"small",startIcon:e.jsx(Ur,{}),onClick:()=>E(!0),color:"primary",children:["Set Default Values (",g.length,")"]}),e.jsx(rt,{control:e.jsx(Hr,{checked:s,onChange:p=>r(p.target.checked),size:"small"}),label:"Show all fields A-Z"})]}),g.length>0&&e.jsxs(pe,{severity:"warning",sx:{mb:2},action:e.jsx(Z,{color:"inherit",size:"small",onClick:()=>E(!0),children:"Set Defaults"}),children:[g.length," required ",g.length===1?"field":"fields"," not mapped. Please map or set default values to continue."]}),e.jsx(be,{size:"small",placeholder:"Search target fields...",value:n,onChange:p=>i(p.target.value),fullWidth:!0,sx:{mb:2},InputProps:{startAdornment:e.jsx(Oe,{position:"start",children:e.jsx(at,{fontSize:"small"})})}}),e.jsx(xe,{sx:{mb:2}}),e.jsx(v,{sx:{mb:2,p:1,bgcolor:"rgba(25, 118, 210, 0.08)",borderRadius:1,border:"1px dashed",borderColor:"primary.main"},children:e.jsx(y,{variant:"body2",color:"primary",sx:{fontWeight:"bold"},children:"Drop source fields onto target fields or use the drop-down menus below"})}),R&&e.jsx(Hn,{mapping:c.find(p=>p.targetField===R)||null,sampleData:l,onClose:()=>k(null)}),e.jsx(v,{sx:{flexGrow:1,maxHeight:"calc(100% - 220px)",overflow:"auto",scrollbarWidth:"thin",border:"1px solid #e0e0e0",borderRadius:"4px",padding:"8px",backgroundColor:"#fafafa","&::-webkit-scrollbar":{width:"10px"},"&::-webkit-scrollbar-track":{background:"#f1f1f1",borderRadius:"4px"},"&::-webkit-scrollbar-thumb":{background:"#2196f3",borderRadius:"4px","&:hover":{background:"#1976d2"}}},children:X()}),b&&e.jsx(Nn,{open:!!b,onClose:a,fieldName:b,mapping:c.find(p=>p.targetField===b),sampleData:l,onSave:j}),e.jsx(Bn,{open:ne,onClose:()=>E(!1),unmappedRequiredFields:g,onAddDefaultMappings:M})]})},Kn=({validationErrors:t,jumpToField:s})=>{const[r,n]=Ze.useState(!1),i=t.filter(h=>h.severity==="error").length,c=t.filter(h=>h.severity==="warning").length,o=()=>{n(!r)};return e.jsxs(he,{sx:{p:2,position:"sticky",top:16},children:[e.jsxs(v,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer"},onClick:o,children:[e.jsxs(y,{variant:"h6",color:i>0?"error":"warning",children:["Validation Issues ",i>0?`(${i} errors, ${c} warnings)`:`(${c} warnings)`]}),e.jsx(Z,{size:"small",endIcon:r?e.jsx(cr,{}):e.jsx(yt,{}),children:r?"Collapse":"Expand"})]}),e.jsxs(mr,{in:r,children:[e.jsx(xe,{sx:{my:1}}),e.jsx(v,{sx:{maxHeight:"200px",overflow:"auto"},children:e.jsx(qe,{dense:!0,children:t.map((h,u)=>e.jsxs(Se,{sx:{bgcolor:h.severity==="error"?"error.lightest":"warning.lightest",mb:.5,borderRadius:1},children:[e.jsx(Pe,{children:h.severity==="error"?e.jsx(wr,{color:"error"}):e.jsx(fr,{color:"warning"})}),e.jsx(Ce,{primary:h.field,secondary:h.message}),e.jsx(Z,{size:"small",variant:"outlined",color:h.severity==="error"?"error":"warning",onClick:()=>s(h.field),children:"Go to Field"})]},u))})})]})]})},Xn=se(e.jsx("path",{d:"m12 4-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"})),Qn=(t,s)=>{if(t==null)return t;try{switch(s.type){case"format":return Zn(t,s.params);case"split":return eo(t,s.params);case"join":return to(t,s.params);case"convert":return ro(t,s.params);default:return t}}catch(r){return console.error("Error transforming value:",r),t}},Zn=(t,s)=>{if(s.dateFormat){const r=new Date(t);if(isNaN(r.getTime()))return t;const n=String(t),i=/\d{1,2}:\d{2}(:\d{2})?/.test(n),c=(s.fieldName||"").toLowerCase(),o=c.includes("date")&&!c.includes("time"),h=i&&!o,u=l=>{const f=l.getHours().toString().padStart(2,"0"),x=l.getMinutes().toString().padStart(2,"0"),b=l.getSeconds().toString().padStart(2,"0");return`${f}:${x}:${b}`};switch(s.dateFormat){case"MM/DD/YYYY":const l=`${r.getMonth()+1}/${r.getDate()}/${r.getFullYear()}`;return h?`${l} ${u(r)}`:l;case"DD/MM/YYYY":const f=`${r.getDate()}/${r.getMonth()+1}/${r.getFullYear()}`;return h?`${f} ${u(r)}`:f;case"YYYY-MM-DD":const x=`${r.getFullYear()}-${(r.getMonth()+1).toString().padStart(2,"0")}-${r.getDate().toString().padStart(2,"0")}`;return h?`${x} ${u(r)}`:x;case"custom":return s.customFormat.replace("YYYY",r.getFullYear().toString()).replace("MM",(r.getMonth()+1).toString().padStart(2,"0")).replace("DD",r.getDate().toString().padStart(2,"0")).replace("HH",r.getHours().toString().padStart(2,"0")).replace("mm",r.getMinutes().toString().padStart(2,"0")).replace("ss",r.getSeconds().toString().padStart(2,"0"));default:return t}}return t},eo=(t,s)=>{const r=String(t),n=s.delimiter||",",i=s.index||0,c=r.split(n);return c.length>i?c[i].trim():t},to=(t,s)=>{if(!Array.isArray(t))return t;const r=s.delimiter||",";return t.join(r)},ro=(t,s)=>{switch(s.toType||"string"){case"string":return String(t);case"number":const n=Number(t);return isNaN(n)?t:n;case"boolean":if(typeof t=="string"){const i=t.toLowerCase();if(["true","yes","1","y"].includes(i))return!0;if(["false","no","0","n"].includes(i))return!1}return!!t;default:return t}},so=({sampleData:t,mappings:s})=>{const r=w.useMemo(()=>t.length>0?t[0]:null,[t]),n=w.useMemo(()=>{if(!r)return null;const o={};return s.forEach(h=>{if(h.sourceField&&r[h.sourceField]!==void 0){let u=r[h.sourceField];h.transformations&&h.transformations.length>0&&h.transformations.forEach(l=>{u=Qn(u,l)}),o[h.targetField]=u}}),o},[r,s]);if(!r||!n)return e.jsx(v,{sx:{p:2,textAlign:"center"},children:e.jsx(y,{variant:"body2",color:"text.secondary",children:"No data available for preview. Upload a file and map fields to see a live preview."})});const i=Object.keys(r).slice(0,6),c=Object.keys(n).slice(0,6);return e.jsxs(v,{children:[e.jsxs(v,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(y,{variant:"subtitle1",children:"Live Preview"}),e.jsx(y,{variant:"body2",color:"text.secondary",children:"Showing sample data transformation"})]}),e.jsxs(v,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(kt,{component:he,variant:"outlined",sx:{flex:1},children:e.jsxs(It,{size:"small",children:[e.jsx(Mt,{children:e.jsx(Xe,{children:i.map(o=>e.jsx(Ne,{children:e.jsx(y,{variant:"caption",fontWeight:"bold",children:o})},o))})}),e.jsx(Ot,{children:e.jsx(Xe,{children:i.map(o=>e.jsx(Ne,{children:e.jsx(y,{variant:"caption",children:r[o]!==null&&r[o]!==void 0?String(r[o]):"null"})},o))})})]})}),e.jsx(v,{sx:{display:"flex",justifyContent:"center",alignItems:"center",px:2},children:e.jsx(Xn,{color:"primary"})}),e.jsx(kt,{component:he,variant:"outlined",sx:{flex:1},children:e.jsxs(It,{size:"small",children:[e.jsx(Mt,{children:e.jsx(Xe,{children:c.map(o=>e.jsx(Ne,{children:e.jsx(y,{variant:"caption",fontWeight:"bold",children:o})},o))})}),e.jsx(Ot,{children:e.jsx(Xe,{children:c.map(o=>e.jsx(Ne,{children:e.jsx(y,{variant:"caption",children:n[o]!==null&&n[o]!==void 0?String(n[o]):"null"})},o))})})]})})]})]})},tr=se(e.jsx("path",{d:"M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2m0 12H4V8h16z"})),no=se(e.jsx("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"})),Fr=(t,s)=>{w.useEffect(()=>{if(s)try{localStorage.setItem(`tmpl:${t.id}`,JSON.stringify(t)),console.log(`Template "${t.name}" saved to localStorage`)}catch(o){console.error("Failed to save template to localStorage:",o)}},[t,s]);const r=()=>{try{return Object.keys(localStorage).filter(l=>l.startsWith("tmpl:")).map(l=>{const f=localStorage.getItem(l);return f?JSON.parse(f):null}).filter(Boolean).sort((l,f)=>f.lastModified-l.lastModified)}catch(o){return console.error("Failed to load templates from localStorage:",o),[]}};return{loadTemplates:r,deleteTemplate:o=>{try{return localStorage.removeItem(`tmpl:${o}`),!0}catch(h){return console.error("Failed to delete template:",h),!1}},saveToServer:async()=>(console.log("Saving template to server:",t),new Promise(o=>{setTimeout(()=>{console.log("Template saved to server successfully"),o()},500)})),loadFromServer:async()=>r()}},oo=({currentTemplate:t,setCurrentTemplate:s,setTemplateDirty:r})=>{const[n,i]=w.useState(null),[c,o]=w.useState(!1),[h,u]=w.useState(!1),[l,f]=w.useState(t.name),[x,b]=w.useState(t.description||""),[D,R]=w.useState([]),{loadTemplates:k,deleteTemplate:V,saveToServer:F}=Fr(t,!1);w.useEffect(()=>{const j=k();R(j)},[]);const N=j=>{i(j.currentTarget)},$=()=>{i(null)},T=()=>{f(t.name),b(t.description||""),o(!0),$()},B=()=>{const j=k();R(j),u(!0),$()},P=()=>{const j={...t,name:l,description:x,lastModified:Date.now()};s(j),F(),r(!1),o(!1)},_=j=>{s(j),r(!1),u(!1)},d=j=>{V(j);const O=k();R(O)},a=j=>{const O={...j,id:`template-${Date.now()}`,name:`${j.name} (Copy)`,lastModified:Date.now()};localStorage.setItem(`tmpl:${O.id}`,JSON.stringify(O));const U=k();R(U)},m=j=>new Date(j).toLocaleString();return e.jsxs(e.Fragment,{children:[e.jsx(Z,{variant:"outlined",size:"small",onClick:N,startIcon:e.jsx(tr,{}),children:"Templates"}),e.jsxs(rs,{anchorEl:n,open:!!n,onClose:$,children:[e.jsxs(ae,{onClick:T,children:[e.jsx(dr,{fontSize:"small",sx:{mr:1}}),"Save Template As..."]}),e.jsxs(ae,{onClick:B,children:[e.jsx(tr,{fontSize:"small",sx:{mr:1}}),"Load Template"]})]}),e.jsxs(it,{open:c,onClose:()=>o(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(ot,{children:"Save Mapping Template"}),e.jsxs(lt,{children:[e.jsx(be,{autoFocus:!0,margin:"dense",label:"Template Name",fullWidth:!0,value:l,onChange:j=>f(j.target.value),sx:{mb:2}}),e.jsx(be,{margin:"dense",label:"Description (optional)",fullWidth:!0,multiline:!0,rows:2,value:x,onChange:j=>b(j.target.value)})]}),e.jsxs(ct,{children:[e.jsx(Z,{onClick:()=>o(!1),children:"Cancel"}),e.jsx(Z,{onClick:P,variant:"contained",children:"Save Template"})]})]}),e.jsxs(it,{open:h,onClose:()=>u(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(ot,{children:"Load Mapping Template"}),e.jsx(lt,{children:D.length===0?e.jsxs(v,{sx:{textAlign:"center",py:4},children:[e.jsx(y,{variant:"body1",children:"No saved templates found."}),e.jsx(y,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"Create and save a template to see it here."})]}):e.jsx(qe,{children:D.map(j=>e.jsxs(Ze.Fragment,{children:[e.jsxs(Se,{component:"button",onClick:()=>_(j),sx:{py:2},children:[e.jsx(Ce,{primary:e.jsxs(y,{variant:"subtitle1",children:[j.name,j.toolId&&e.jsxs(y,{component:"span",variant:"body2",color:"text.secondary",sx:{ml:1},children:["(",j.toolId,")"]})]}),secondary:e.jsxs(v,{children:[j.description&&e.jsx(y,{variant:"body2",children:j.description}),e.jsxs(y,{variant:"caption",color:"text.secondary",children:["Last modified: ",m(j.lastModified),j.mappings&&`  ${j.mappings.length} mappings`]})]})}),e.jsxs(Rt,{children:[e.jsx(De,{edge:"end",onClick:()=>a(j),sx:{mr:1},children:e.jsx(no,{fontSize:"small"})}),e.jsx(De,{edge:"end",onClick:()=>d(j.id),children:e.jsx(ft,{fontSize:"small"})})]})]}),e.jsx(xe,{})]},j.id))})}),e.jsx(ct,{children:e.jsx(Z,{onClick:()=>u(!1),children:"Cancel"})})]})]})},ao=()=>{const t=dt(),{sourceColumns:s,sampleData:r,selectedTool:n,mappings:i,processingStatus:c}=He(g=>g.formatter),[o,h]=w.useState({id:`template-${Date.now()}`,name:"Untitled Mapping",toolId:(n==null?void 0:n.id)||"",mappings:i||[],lastModified:Date.now()}),[u,l]=w.useState(!1),[f,x]=w.useState(!1),[b,D]=w.useState([]),[R,k]=w.useState({message:"",severity:"info",open:!1}),[V,F]=w.useState(""),[N,$]=w.useState(""),[T,B]=w.useState(!1),P=n||void 0,{saveToServer:_}=Fr(o,u);w.useEffect(()=>{console.log("Redux mappings changed:",i),h(g=>{const M={...g,mappings:[...i],lastModified:Date.now()};return console.log("Updated template with Redux mappings:",M),M}),i.length>0&&l(!0)},[i]),w.useEffect(()=>{m()},[i,P]);const d=g=>{console.log("handleMappingChange called with:",g);try{const M=[...i],p=M.findIndex(L=>L.targetField===g.targetField);p>=0?(console.log(`Updating existing mapping for ${g.targetField}`),M[p]=g):(console.log(`Adding new mapping for ${g.targetField}`),M.push(g)),t(jt(M)),console.log("Mapping updated successfully:",g),k({message:`Mapped ${g.sourceField} to ${g.targetField}`,severity:"success",open:!0})}catch(M){console.error("Error updating mapping:",M)}},a=g=>{console.log("handleRemoveMapping called for:",g);try{const M=i.filter(p=>p.targetField!==g);t(jt(M)),console.log(`Mapping for ${g} removed successfully`)}catch(M){console.error("Error removing mapping:",M)}},m=()=>{if(!P)return;const g=[];P.requiredFields.forEach(M=>{const p=i.find(L=>L.targetField===M.name);console.log(`Checking required field ${M.name}, mapping:`,p),p||g.push({field:M.name,message:`Required field ${M.name} is not mapped`,severity:"error"})}),D(g)},j=async()=>{if(!(!s||!P)){x(!0);try{const g=[...o.mappings],M=S=>g.some(I=>I.targetField===S),p=S=>S.toLowerCase().replace(/[\s_-]/g,"");[...P.requiredFields,...P.optionalFields].forEach(S=>{if(M(S.name))return;const I=s.find(G=>G.toLowerCase()===S.name.toLowerCase());if(I){g.push({sourceField:I,targetField:S.name});return}const C=p(S.name),Y=s.find(G=>p(G)===C);if(Y){g.push({sourceField:Y,targetField:S.name});return}const K=s.map(p).findIndex(G=>G.includes(C)||C.includes(G));K>=0&&g.push({sourceField:s[K],targetField:S.name})}),t(jt(g))}finally{x(!1)}}},O=async()=>{try{await _(),l(!1)}catch(g){console.error("Failed to save template:",g)}},U=()=>{t(Be(0))},X=()=>{try{t($e("transforming")),console.log("Transforming data with mappings:",o.mappings),console.log("Sample data:",r);const g=Fn(r,o.mappings);console.log("Transformed data:",g),t(zr(g)),t($e("mapping")),t(Be(2))}catch(g){console.error("Error transforming data:",g),t($e("error")),k({message:`Error transforming data: ${g instanceof Error?g.message:"Unknown error"}`,severity:"error",open:!0})}},ne=w.useMemo(()=>{if(console.log("Checking if can proceed with validationErrors:",b),console.log("Current mappings:",i),P){const g=P.requiredFields.filter(M=>!i.some(p=>p.targetField===M.name));return console.log("Unmapped required fields:",g),g.length===0}return b.every(g=>g.severity!=="error")},[b,i,P]),E=g=>{var S;g.preventDefault();const M=g.dataTransfer.getData("text/plain");if(!M){k({message:"Drag and drop error: No source field data found",severity:"error",open:!0});return}const L=(S=g.target.closest("[data-target-field]"))==null?void 0:S.getAttribute("data-target-field");if(!L){k({message:"Drag and drop error: No target field found. Try dropping directly on a target field.",severity:"warning",open:!0});return}d({sourceField:M,targetField:L}),k({message:`Mapped ${M} to ${L}`,severity:"success",open:!0})};return s.length?P?c==="uploading"?e.jsxs(v,{sx:{p:3,textAlign:"center"},children:[e.jsx(Qe,{}),e.jsx(y,{sx:{mt:2},children:"Processing file data..."})]}):e.jsxs(v,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsxs(v,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsxs(y,{variant:"h5",children:["Map Fields for ",P.name]}),e.jsxs(os,{direction:"row",spacing:1,children:[e.jsx(Z,{variant:"outlined",size:"small",startIcon:e.jsx(dr,{}),onClick:O,disabled:!u,children:"Save Template"}),e.jsx(oo,{currentTemplate:o,setCurrentTemplate:h,setTemplateDirty:l})]})]}),e.jsxs(v,{sx:{display:"flex",gap:2,height:"700px",minHeight:"700px",border:"1px solid #eaeaea",borderRadius:"4px",padding:"4px"},children:[e.jsxs(v,{sx:{width:"35%",height:"100%",display:"flex",flexDirection:"column",position:"relative",borderRight:"1px solid #eaeaea",paddingRight:"8px"},children:[e.jsx(y,{variant:"h6",sx:{position:"sticky",top:0,zIndex:10,backgroundColor:"#fff",paddingBottom:"8px",borderBottom:"2px solid #1976d2",marginBottom:"8px",color:"#1976d2",fontWeight:"bold",textAlign:"center"},children:"Source Fields Panel  (Scrollable)"}),e.jsx(zn,{sourceColumns:s,filter:V,setFilter:F,mappings:o.mappings,sampleData:r})]}),e.jsxs(v,{sx:{width:"65%",height:"100%",display:"flex",flexDirection:"column",gap:2,overflow:"hidden",position:"relative"},onDragOver:g=>{g.target===g.currentTarget&&(g.preventDefault(),console.log("Parent container dragOver"))},onDrop:g=>{g.target===g.currentTarget&&(g.preventDefault(),E(g),console.log("Parent container drop"))},children:[e.jsx(y,{variant:"h6",sx:{position:"sticky",top:0,zIndex:10,backgroundColor:"#fff",paddingBottom:"8px",borderBottom:"2px solid #1976d2",marginBottom:"8px",color:"#1976d2",fontWeight:"bold",textAlign:"center"},children:"Target Fields Panel  (Scrollable)"}),e.jsx(Jn,{toolConfig:P,showAllFields:T,setShowAllFields:B,filter:N,setFilter:$,mappings:o.mappings,onMappingChange:d,onRemoveMapping:a,validationErrors:b,sampleData:r,sourceColumns:s}),b.length>0&&e.jsx(v,{sx:{flexShrink:0,marginTop:"auto",borderTop:"1px solid #eaeaea",paddingTop:"8px"},children:e.jsx(Kn,{validationErrors:b,jumpToField:g=>{const M=document.getElementById(`target-field-${g}`);M&&(M.scrollIntoView({behavior:"smooth",block:"center"}),M.classList.add("highlight-field"),setTimeout(()=>{M.classList.remove("highlight-field")},2e3))}})})]})]}),e.jsx(he,{sx:{p:2,mt:2},children:e.jsx(so,{sampleData:r,mappings:o.mappings})}),e.jsxs(v,{sx:{display:"flex",justifyContent:"space-between",mt:2},children:[e.jsx(Z,{variant:"outlined",startIcon:e.jsx(nt,{}),onClick:U,children:"Back"}),e.jsxs(v,{children:[e.jsx(Z,{variant:"outlined",onClick:j,disabled:f||!s.length,sx:{mr:1},children:f?e.jsxs(e.Fragment,{children:[e.jsx(Qe,{size:20,sx:{mr:1}}),"Auto-mapping..."]}):"Auto-Map Fields"}),e.jsx(Z,{variant:"contained",endIcon:e.jsx(Vt,{}),onClick:X,disabled:!ne,children:"Continue"})]})]}),e.jsx(gr,{open:R.open,autoHideDuration:6e3,onClose:()=>k({...R,open:!1}),children:e.jsx(pe,{onClose:()=>k({...R,open:!1}),severity:R.severity,children:R.message})})]}):e.jsxs(v,{sx:{p:3,textAlign:"center"},children:[e.jsx(pe,{severity:"error",children:"No tool selected. Please select a tool first."}),e.jsx(Z,{sx:{mt:2},variant:"outlined",startIcon:e.jsx(nt,{}),onClick:U,children:"Go Back to Upload"})]}):e.jsxs(v,{sx:{p:3,textAlign:"center"},children:[e.jsx(pe,{severity:"error",children:"No source columns available. Please upload a file first."}),e.jsx(Z,{sx:{mt:2},variant:"outlined",startIcon:e.jsx(nt,{}),onClick:U,children:"Go Back to Upload"})]})},rr=se(e.jsx("path",{d:"M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"})),io=se([e.jsx("path",{d:"M12 5.99 19.53 19H4.47zM12 2 1 21h22z"},"0"),e.jsx("path",{d:"M13 16h-2v2h2zm0-6h-2v5h2z"},"1")]),lo=({data:t,validationErrors:s,highlightedCell:r})=>{const[n,i]=w.useState(0),[c,o]=w.useState(10),[h,u]=w.useState(""),[l,f]=w.useState("");w.useEffect(()=>{if(r){const T=Math.floor(r.rowIndex/c);T!==n&&i(T)}},[r,c,n]);const x=t.length>0?Object.keys(t[0]):[],b={};s.forEach(T=>{T.rowIndex!==void 0&&(b[T.rowIndex]||(b[T.rowIndex]={}),b[T.rowIndex][T.field]||(b[T.rowIndex][T.field]=[]),b[T.rowIndex][T.field].push(T))});const D=(T,B)=>{i(B)},R=T=>{o(parseInt(T.target.value,10)),i(0)},k=T=>{u(T.target.value),i(0)},V=T=>{f(T.target.value),i(0)},F=()=>{f(""),i(0)},N=t.filter(T=>{if(!l)return!0;if(h){const B=T[h];return B!==void 0&&String(B).toLowerCase().includes(l.toLowerCase())}return Object.values(T).some(B=>B!==void 0&&String(B).toLowerCase().includes(l.toLowerCase()))}),$=N.slice(n*c,n*c+c);return t.length===0?e.jsx(v,{children:e.jsx(y,{variant:"h6",gutterBottom:!0,children:"No data available for preview"})}):e.jsxs(v,{children:[e.jsx(_r,{styles:{"@keyframes pulse":{"0%":{opacity:.7},"100%":{opacity:1}}}}),e.jsxs(v,{sx:{display:"flex",gap:2,mb:2},children:[e.jsx(be,{label:"Search",value:l,onChange:V,sx:{flexGrow:1},InputProps:{startAdornment:e.jsx(Oe,{position:"start",children:e.jsx(at,{})}),endAdornment:l&&e.jsx(Oe,{position:"end",children:e.jsx(De,{onClick:F,edge:"end",size:"small",children:e.jsx($t,{})})})}}),e.jsxs(Ue,{sx:{minWidth:200},children:[e.jsx(Ye,{id:"filter-field-label",children:"Filter Field"}),e.jsxs(We,{labelId:"filter-field-label",id:"filter-field",value:h,label:"Filter Field",onChange:k,children:[e.jsx(ae,{value:"",children:"All Fields"}),x.map(T=>e.jsx(ae,{value:T,children:T},T))]})]})]}),e.jsxs(he,{sx:{width:"100%",mb:2},children:[e.jsx(kt,{sx:{maxHeight:500},children:e.jsxs(It,{stickyHeader:!0,"aria-label":"data preview table",children:[e.jsx(Mt,{children:e.jsxs(Xe,{children:[e.jsx(Ne,{children:"#"}),x.map(T=>e.jsx(Ne,{children:T},T))]})}),e.jsx(Ot,{children:$.map((T,B)=>{const P=n*c+B,_=b[P];return e.jsxs(Xe,{hover:!0,sx:{"&:last-child td, &:last-child th":{border:0},backgroundColor:_?"#fff8f8":"inherit"},children:[e.jsx(Ne,{children:P+1}),x.map(d=>{const a=(_==null?void 0:_[d])||[],m=a.length>0,j=r&&r.rowIndex===P&&r.field===d;return e.jsxs(Ne,{sx:{backgroundColor:j?"#fff3e0":m?"#ffebee":"inherit",position:"relative",border:j?"2px solid #ff9800":"inherit",transition:"all 0.3s ease"},children:[T[d]!==void 0?String(T[d]):"",m&&e.jsx(v,{sx:{position:"absolute",top:0,right:0},children:e.jsx(de,{color:"error",size:"small",label:a.length,sx:{height:16,fontSize:"0.6rem"}})}),j&&e.jsx(v,{sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",border:"2px solid #ff9800",borderRadius:"4px",pointerEvents:"none",animation:"pulse 1s ease-in-out infinite alternate"}})]},d)})]},B)})})]})}),e.jsx(as,{rowsPerPageOptions:[5,10,25,50,100],component:"div",count:N.length,rowsPerPage:c,page:n,onPageChange:D,onRowsPerPageChange:R})]})]})};class co{constructor(){Ht(this,"defaultFields",{})}registerField(s,r){console.log(`Registering default value for ${s}:`,r),this.defaultFields[s]=r}hasDefaultValue(s){return this.defaultFields[s]!==void 0}getDefaultValue(s){return this.defaultFields[s]}registerMappings(s){this.defaultFields={},s.forEach(r=>{if(r.sourceField==="__default__"&&r.transformations){const n=r.transformations.find(i=>i.type==="convert"&&i.params&&i.params.defaultValue!==void 0);n&&n.params.defaultValue!==void 0&&this.registerField(r.targetField,n.params.defaultValue)}}),console.log("Registered default values:",this.defaultFields)}clear(){this.defaultFields={}}}const sr=new co,uo=(t,s)=>{const r=[];return t.forEach((n,i)=>{s.forEach(c=>{let o=n[c.name];const h=sr.hasDefaultValue(c.name);if((o==null||o==="")&&h&&(o=sr.getDefaultValue(c.name),console.log(`Using default value for validation of ${c.name}:`,o)),c.name==="Incident ID"){c.isRequired&&!h&&(o==null||o==="")&&r.push({rowIndex:i,field:c.name,message:`${c.name} is required`,type:"required"});return}if(c.name.includes("Time")&&typeof o=="string"){c.isRequired&&!h&&(o==null||o==="")&&r.push({rowIndex:i,field:c.name,message:`${c.name} is required`,type:"required"});return}if(c.isRequired&&!h&&(o==null||o==="")){r.push({rowIndex:i,field:c.name,message:`${c.name} is required`,type:"required"});return}if(o==null||o==="")return;const u=po(o,c.dataType,c.name,i);if(u){r.push(u);return}c.validationRules&&c.validationRules.forEach(l=>{const f=ho(o,l,c.name,i);f&&r.push(f)})})}),console.log("Validation completed with errors:",r),r},po=(t,s,r,n)=>{switch(s){case"string":if(typeof t!="string")return{rowIndex:n,field:r,message:`${r} must be a string`,type:"custom"};break;case"number":if(typeof t!="number"&&(typeof t!="string"||isNaN(Number(t))))return{rowIndex:n,field:r,message:`${r} must be a number`,type:"custom"};break;case"date":if(!(typeof t=="string"||t instanceof Date))return{rowIndex:n,field:r,message:`${r} must be a date`,type:"custom"};const i=new Date(t);if(isNaN(i.getTime()))return{rowIndex:n,field:r,message:`${r} contains an invalid date format`,type:"custom"};break;case"boolean":if(typeof t!="boolean"&&t!=="true"&&t!=="false"&&t!=="0"&&t!=="1")return{rowIndex:n,field:r,message:`${r} must be a boolean value`,type:"custom"};break;case"location":if(typeof t=="string"){if(!/^-?\d+(\.\d+)?,\s*-?\d+(\.\d+)?$/.test(t))return{rowIndex:n,field:r,message:`${r} must be a valid location format (latitude,longitude)`,type:"custom"}}else if(!t.lat||!t.lng)return{rowIndex:n,field:r,message:`${r} must be a valid location object or string`,type:"custom"};break}return null},ho=(t,s,r,n)=>{switch(s.type){case"required":break;case"min":if(typeof t=="number"||!isNaN(Number(t))){if(Number(t)<s.params.value)return{rowIndex:n,field:r,message:`${r} must be at least ${s.params.value}`,type:"min"}}else if(typeof t=="string"&&t.length<s.params.value)return{rowIndex:n,field:r,message:`${r} must be at least ${s.params.value} characters`,type:"min"};break;case"max":if(typeof t=="number"||!isNaN(Number(t))){if(Number(t)>s.params.value)return{rowIndex:n,field:r,message:`${r} must be at most ${s.params.value}`,type:"max"}}else if(typeof t=="string"&&t.length>s.params.value)return{rowIndex:n,field:r,message:`${r} must be at most ${s.params.value} characters`,type:"max"};break;case"pattern":if(typeof t=="string"&&!new RegExp(s.params.regex).test(t))return{rowIndex:n,field:r,message:s.params.message||`${r} does not match the required pattern`,type:"pattern"};break;case"oneOf":const i=s.params.values;if(!i.includes(t))return{rowIndex:n,field:r,message:`${r} must be one of: ${i.join(", ")}`,type:"oneOf"};break;case"custom":if(s.params.validateFn&&typeof s.params.validateFn=="function"&&!s.params.validateFn(t))return{rowIndex:n,field:r,message:s.params.message||`${r} is invalid`,type:"custom"};break}return null},fo=t=>{const s={total:t.length,byType:{},byField:{}};return t.forEach(r=>{s.byType[r.type]||(s.byType[r.type]=0),s.byType[r.type]++,s.byField[r.field]||(s.byField[r.field]=0),s.byField[r.field]++}),s},Ft=t=>{const{children:s,value:r,index:n,...i}=t;return e.jsx("div",{role:"tabpanel",hidden:r!==n,id:`validation-tabpanel-${n}`,"aria-labelledby":`validation-tab-${n}`,...i,children:r===n&&e.jsx(v,{sx:{p:2},children:s})})},xo=({errors:t,onJumpToError:s})=>{const[r,n]=w.useState(0),[i,c]=w.useState(""),o=fo(t),h=(x,b)=>{n(b)},u=t.filter(x=>x.field.toLowerCase().includes(i.toLowerCase())||x.message.toLowerCase().includes(i.toLowerCase())),l={};u.forEach(x=>{l[x.field]||(l[x.field]=[]),l[x.field].push(x)});const f=x=>{let b="default";switch(x){case"required":b="error";break;case"pattern":case"min":case"max":b="warning";break;case"oneOf":case"custom":b="info";break}return e.jsx(de,{size:"small",label:x,color:b})};return e.jsxs(he,{sx:{p:0,mb:3},children:[e.jsx(v,{sx:{p:2,bgcolor:t.length>0?"#ffebee":"#e8f5e9",borderRadius:"4px 4px 0 0"},children:e.jsxs(y,{variant:"h6",component:"h3",sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(xt,{}),"Validation Results",e.jsx(de,{label:`${t.length} ${t.length===1?"error":"errors"}`,color:t.length>0?"error":"success",sx:{ml:2}})]})}),e.jsx(xe,{}),e.jsx(v,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(gt,{value:r,onChange:h,"aria-label":"validation tabs",children:[e.jsx(Ee,{label:"Summary",id:"validation-tab-0","aria-controls":"validation-tabpanel-0"}),e.jsx(Ee,{label:"By Field",id:"validation-tab-1","aria-controls":"validation-tabpanel-1"}),e.jsx(Ee,{label:"All Errors",id:"validation-tab-2","aria-controls":"validation-tabpanel-2"})]})}),e.jsx(Ft,{value:r,index:0,children:t.length===0?e.jsx(pe,{severity:"success",children:"No validation errors found. Your data is ready for export!"}):e.jsxs(e.Fragment,{children:[e.jsxs(pe,{severity:"warning",children:["Found ",t.length," validation ",t.length===1?"error":"errors"," that need to be addressed before export."]}),e.jsxs(v,{sx:{mt:2},children:[e.jsx(y,{variant:"subtitle1",gutterBottom:!0,children:"Error Distribution by Field"}),e.jsx(v,{sx:{display:"flex",flexWrap:"wrap",gap:1,mb:2},children:Object.entries(o.byField).map(([x,b])=>e.jsx(de,{label:`${x}: ${b}`,color:"error",variant:"outlined",onClick:()=>n(1)},x))}),e.jsx(y,{variant:"subtitle1",gutterBottom:!0,children:"Error Types"}),e.jsx(v,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:Object.entries(o.byType).map(([x,b])=>e.jsx(de,{label:`${x}: ${b}`,color:"primary",variant:"outlined"},x))})]})]})}),e.jsxs(Ft,{value:r,index:1,children:[e.jsx(be,{fullWidth:!0,placeholder:"Search errors by field or message",value:i,onChange:x=>c(x.target.value),sx:{mb:2},InputProps:{startAdornment:e.jsx(Oe,{position:"start",children:e.jsx(at,{})}),endAdornment:i&&e.jsx(Oe,{position:"end",children:e.jsx(De,{onClick:()=>c(""),edge:"end",size:"small",children:e.jsx($t,{})})})}}),Object.keys(l).length===0?e.jsx(pe,{severity:"info",children:"No errors match your search criteria."}):Object.entries(l).map(([x,b])=>e.jsxs(ur,{defaultExpanded:Object.keys(l).length===1,children:[e.jsx(pr,{expandIcon:e.jsx(yt,{}),children:e.jsxs(v,{sx:{display:"flex",alignItems:"center",gap:1,width:"100%"},children:[e.jsx(y,{children:x}),e.jsx(de,{size:"small",label:b.length,color:"error",sx:{ml:"auto"}})]})}),e.jsx(hr,{children:e.jsx(qe,{dense:!0,disablePadding:!0,children:b.map((D,R)=>e.jsxs(Ze.Fragment,{children:[R>0&&e.jsx(xe,{component:"li"}),e.jsx(Se,{secondaryAction:D.rowIndex!==void 0&&s&&e.jsx(Z,{size:"small",variant:"outlined",onClick:()=>D.rowIndex!==void 0&&s(D.rowIndex,D.field),children:"Jump to Row"}),children:e.jsx(Ce,{primary:e.jsxs(v,{sx:{display:"flex",alignItems:"center",gap:1},children:[D.message,f(D.type)]}),secondary:D.rowIndex!==void 0?`Row ${D.rowIndex+1}`:"Global error"})})]},R))})})]},x))]}),e.jsxs(Ft,{value:r,index:2,children:[e.jsx(be,{fullWidth:!0,placeholder:"Search errors by field or message",value:i,onChange:x=>c(x.target.value),sx:{mb:2},InputProps:{startAdornment:e.jsx(Oe,{position:"start",children:e.jsx(at,{})}),endAdornment:i&&e.jsx(Oe,{position:"end",children:e.jsx(De,{onClick:()=>c(""),edge:"end",size:"small",children:e.jsx($t,{})})})}}),e.jsx(qe,{dense:!0,children:u.length===0?e.jsx(pe,{severity:"info",children:"No errors match your search criteria."}):u.map((x,b)=>e.jsxs(Ze.Fragment,{children:[b>0&&e.jsx(xe,{component:"li"}),e.jsx(Se,{secondaryAction:x.rowIndex!==void 0&&s&&e.jsx(Z,{size:"small",variant:"outlined",onClick:()=>x.rowIndex!==void 0&&s(x.rowIndex,x.field),children:"Jump to Row"}),children:e.jsx(Ce,{primary:e.jsxs(v,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsxs(y,{component:"span",sx:{fontWeight:500},children:[x.field,":"]}),x.message,f(x.type)]}),secondary:x.rowIndex!==void 0?`Row ${x.rowIndex+1}`:"Global error"})})]},b))})]})]})},mo=se(e.jsx("path",{d:"M2 17h2v.5H3v1h1v.5H2v1h3v-4H2zm1-9h1V4H2v1h1zm-1 3h1.8L2 13.1v.9h3v-1H3.2L5 10.9V10H2zm5-6v2h14V5zm0 14h14v-2H7zm0-6h14v-2H7z"})),nr=se(e.jsx("path",{d:"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"})),go=t=>{switch(t){case"string":return"Default Value";case"number":return"0";case"date":return new Date().toISOString().split("T")[0];case"boolean":return"false";case"location":return"0.0,0.0";default:return""}},yo=({errors:t,targetFields:s,mappings:r,onAddDefaultValue:n,onJumpToMapping:i})=>{const c=_t(),[o,h]=w.useState(!1),[u,l]=w.useState(null),[f,x]=w.useState(""),b=w.useMemo(()=>{const F={};return t.forEach(N=>{F[N.field]||(F[N.field]={errors:[],count:0}),F[N.field].errors.push(N),F[N.field].count++}),F},[t]),D=w.useMemo(()=>Object.entries(b).sort((F,N)=>N[1].count-F[1].count).map(([F,N])=>{const $=s.find(d=>d.name===F);if(!$)return null;const T=r.some(d=>d.targetField===F),B=r.some(d=>d.targetField===F&&d.sourceField==="__default__"),P=N.errors.some(d=>d.type==="required");let _="unknown";return P&&!T?_="map_field":P&&!B?_="add_default":!P&&T&&(_="fix_transformation"),{fieldName:F,fieldDef:$,errorCount:N.count,errors:N.errors,hasMapping:T,hasDefaultMapping:B,actionType:_}}).filter(Boolean),[b,s,r]),R=w.useMemo(()=>D.filter(F=>(F==null?void 0:F.actionType)==="add_default").length,[D]),k=F=>{l(F),x(go(F.dataType)),h(!0)},V=()=>{if(!u)return;const F={sourceField:"__default__",targetField:u.name,transformations:[{type:"convert",params:{defaultValue:f,targetType:u.dataType}}]};n(F),h(!1)};return t.length===0?e.jsx(pe,{severity:"success",sx:{my:2},children:"No validation errors detected. Your data is ready for export!"}):e.jsxs(he,{sx:{p:0,my:2,borderRadius:1,border:`1px solid ${c.palette.divider}`,overflow:"hidden"},elevation:2,children:[e.jsxs(v,{sx:{p:2,bgcolor:c.palette.mode==="dark"?ce(c.palette.error.dark,.2):ce(c.palette.error.light,.1),borderBottom:`1px solid ${c.palette.divider}`},children:[e.jsxs(y,{variant:"h6",sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(xt,{color:"error"}),"Validation Solutions",e.jsx(de,{label:`${t.length} ${t.length===1?"issue":"issues"}`,color:"error",size:"small",sx:{ml:1}})]}),e.jsx(y,{variant:"body2",color:"text.secondary",sx:{mt:.5},children:R>0?`${R} ${R===1?"issue":"issues"} can be fixed with default values.`:"Review the suggested actions to resolve validation issues."})]}),e.jsxs(qe,{sx:{py:0},children:[R>0&&e.jsxs(Se,{sx:{bgcolor:ce(c.palette.success.light,.1),borderBottom:`1px solid ${c.palette.divider}`,"&:hover":{bgcolor:ce(c.palette.success.light,.2)}},children:[e.jsx(Pe,{children:e.jsx(Lt,{color:"success"})}),e.jsx(Ce,{primary:"Fix Required Fields with Default Values",secondary:`Add default values to ${R} unmapped required ${R===1?"field":"fields"}`}),e.jsx(Rt,{children:e.jsx(Z,{variant:"outlined",color:"success",size:"small",onClick:()=>{const F=D.find(N=>(N==null?void 0:N.actionType)==="add_default");F!=null&&F.fieldDef&&k(F.fieldDef)},children:"Set Default Values"})})]}),D.map((F,N)=>{var P;if(!F)return null;let $=e.jsx(xt,{color:"error"}),T="error",B="";switch(F.actionType){case"map_field":$=e.jsx(mo,{color:"info"}),T="info",B="Field requires mapping to source data";break;case"add_default":$=e.jsx(nr,{color:"success"}),T="success",B="Field requires a value, add a default";break;case"fix_transformation":$=e.jsx(xr,{color:"warning"}),T="warning",B="Field has validation issues with current mapping";break}return e.jsxs(Ze.Fragment,{children:[N>0&&e.jsx(xe,{}),e.jsxs(Se,{sx:{py:1.5,"&:hover":{bgcolor:ce(c.palette.primary.light,.05)}},children:[e.jsx(Pe,{children:$}),e.jsx(Ce,{primary:e.jsxs(v,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(y,{variant:"subtitle2",children:F.fieldName}),e.jsx(de,{size:"small",label:`${F.errorCount} ${F.errorCount===1?"error":"errors"}`,color:"error",variant:"outlined"}),F.fieldDef&&e.jsx(de,{size:"small",label:F.fieldDef.dataType,color:"default",variant:"outlined"})]}),secondary:e.jsxs(v,{sx:{mt:.5},children:[e.jsx(y,{variant:"body2",color:"text.secondary",children:B}),e.jsxs(y,{variant:"caption",color:"error",sx:{display:"block",mt:.5},children:[(P=F.errors[0])==null?void 0:P.message,F.errors.length>1&&` (+ ${F.errors.length-1} more)`]})]})}),e.jsxs(Rt,{children:[F.actionType==="add_default"&&F.fieldDef&&e.jsx(Z,{variant:"outlined",color:T,size:"small",startIcon:e.jsx(nr,{}),onClick:()=>k(F.fieldDef),children:"Add Default"}),(F.actionType==="map_field"||F.actionType==="fix_transformation")&&e.jsx(Z,{variant:"outlined",color:T,size:"small",startIcon:e.jsx(Yr,{}),onClick:()=>i(F.fieldName),children:F.actionType==="map_field"?"Map Field":"Fix Mapping"})]})]})]},F.fieldName)})]}),e.jsxs(it,{open:o,onClose:()=>h(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsxs(ot,{children:["Set Default Value for ",u==null?void 0:u.name]}),e.jsx(lt,{children:e.jsxs(v,{sx:{mt:1},children:[e.jsx(y,{variant:"body2",gutterBottom:!0,children:u==null?void 0:u.description}),e.jsxs(v,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[e.jsx(y,{variant:"caption",children:"Data Type:"}),e.jsx(de,{size:"small",label:u==null?void 0:u.dataType,color:"primary",variant:"outlined"})]}),(u==null?void 0:u.dataType)==="boolean"?e.jsxs(be,{select:!0,fullWidth:!0,value:f,onChange:F=>x(F.target.value),label:"Default Value",variant:"outlined",margin:"normal",children:[e.jsx(ae,{value:"true",children:"True"}),e.jsx(ae,{value:"false",children:"False"})]}):e.jsx(be,{fullWidth:!0,value:f,onChange:F=>x(F.target.value),label:"Default Value",variant:"outlined",margin:"normal",type:(u==null?void 0:u.dataType)==="number"?"number":"text",helperText:`This value will be used for all records where ${u==null?void 0:u.name} is not mapped or empty`})]})}),e.jsxs(ct,{children:[e.jsx(Z,{onClick:()=>h(!1),children:"Cancel"}),e.jsx(Z,{onClick:V,variant:"contained",color:"primary",startIcon:e.jsx(Lt,{}),children:"Apply Default Value"})]})]})]})},or=t=>{const{children:s,value:r,index:n,...i}=t;return e.jsx("div",{role:"tabpanel",hidden:r!==n,id:`preview-tabpanel-${n}`,"aria-labelledby":`preview-tab-${n}`,...i,children:r===n&&e.jsx(v,{sx:{p:2},children:s})})},bo=()=>{const t=dt(),{sourceFile:s,transformedData:r,validationErrors:n,selectedTool:i,mappings:c}=He(T=>T.formatter),[o,h]=w.useState(0),[u,l]=w.useState(!1),[f,x]=w.useState(null),b=w.useRef(null),D=(T,B)=>{h(B)},R=()=>{t(Be(1))},k=()=>{t(Be(3))},V=()=>{if(!(!r||!i)){l(!0);try{const T=[...i.requiredFields,...i.optionalFields],B=He(a=>a.formatter.mappings),P={};B&&B.forEach(a=>{if(a.sourceField==="__default__"&&a.transformations){const m=a.transformations.find(j=>j.type==="convert"&&j.params&&j.params.defaultValue!==void 0);m&&(P[a.targetField]=!0,console.log(`Field ${a.targetField} has default value: ${m.params.defaultValue}`))}});const _=r.map(a=>{const m={...a};return Object.keys(P).forEach(j=>{typeof window<"u"&&window.defaultValueRegistry&&window.defaultValueRegistry.register(j,!0)}),m}),d=uo(_,T);t(Ar(d)),d.length===0?t($e("complete")):t($e("error"))}catch(T){console.error("Validation error:",T),t($e("error"))}finally{l(!1)}}},F=(T,B)=>{h(0),x({rowIndex:T,field:B}),setTimeout(()=>{b.current&&b.current.scrollIntoView({behavior:"smooth"})},100),setTimeout(()=>{x(null)},3e3)},N=T=>{console.log("Adding default value mapping:",T),t(Pr(T)),setTimeout(()=>{V()},100)},$=T=>{t(Be(1))};return w.useEffect(()=>{r&&r.length>0&&V()},[r]),!r||r.length===0?e.jsxs(he,{sx:{p:3,textAlign:"center"},children:[e.jsxs(pe,{severity:"warning",sx:{mb:2},children:[e.jsx(fs,{children:"No Data Available"}),"There is no transformed data to preview. Please go back to the field mapping step."]}),e.jsx(Z,{variant:"contained",startIcon:e.jsx(rr,{}),onClick:R,children:"Back to Field Mapping"})]}):e.jsxs(v,{children:[e.jsx(y,{variant:"h5",gutterBottom:!0,sx:{mb:3},children:"Preview & Validate Data"}),e.jsx(he,{sx:{p:2,mb:3},children:e.jsxs(le,{container:!0,spacing:2,children:[e.jsx(le,{size:{xs:12,md:6},children:e.jsxs(v,{children:[e.jsx(y,{variant:"subtitle2",color:"text.secondary",children:"Source File"}),e.jsxs(y,{variant:"body1",children:[(s==null?void 0:s.name)||"No file"," (",s==null?void 0:s.type,")"]})]})}),e.jsx(le,{size:{xs:12,md:6},children:e.jsxs(v,{children:[e.jsx(y,{variant:"subtitle2",color:"text.secondary",children:"Records"}),e.jsxs(y,{variant:"body1",children:[r.length," records processed"]})]})}),e.jsx(le,{size:12,children:e.jsxs(v,{children:[e.jsx(y,{variant:"subtitle2",color:"text.secondary",children:"Validation Status"}),e.jsx(v,{sx:{display:"flex",alignItems:"center",gap:1},children:u?e.jsxs(e.Fragment,{children:[e.jsx(Qe,{size:20}),e.jsx(y,{children:"Validating data..."})]}):n.length===0?e.jsxs(e.Fragment,{children:[e.jsx(Tr,{color:"success"}),e.jsx(y,{color:"success.main",children:"Data validation passed! Ready for export."})]}):e.jsxs(e.Fragment,{children:[e.jsx(io,{color:"error"}),e.jsxs(y,{color:"error",children:[n.length," validation ",n.length===1?"error":"errors"," found"]})]})})]})})]})}),e.jsx(v,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(gt,{value:o,onChange:D,"aria-label":"preview and validation tabs",children:[e.jsx(Ee,{label:"Data Preview",id:"preview-tab-0","aria-controls":"preview-tabpanel-0"}),e.jsx(Ee,{label:`Validation & Solutions ${n.length>0?`(${n.length})`:""}`,id:"preview-tab-1","aria-controls":"preview-tabpanel-1",sx:{color:n.length>0?"error.main":"inherit"}})]})}),e.jsx(or,{value:o,index:0,children:e.jsx(v,{ref:b,children:e.jsx(lo,{data:r,validationErrors:n,highlightedCell:f})})}),e.jsxs(or,{value:o,index:1,children:[n.length>0&&i&&e.jsx(yo,{errors:n,targetFields:[...i.requiredFields,...i.optionalFields],mappings:c,onAddDefaultValue:N,onJumpToMapping:$}),e.jsx(xo,{errors:n,onJumpToError:F})]}),e.jsx(xe,{sx:{my:3}}),e.jsxs(v,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(Z,{variant:"outlined",startIcon:e.jsx(rr,{}),onClick:R,children:"Back to Field Mapping"}),e.jsx(Z,{variant:"contained",endIcon:e.jsx(Vt,{}),onClick:k,disabled:n.length>0,children:"Continue to Export"})]})]})},Er=se(e.jsx("path",{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"})),vo=se(e.jsx("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"})),mt=se(e.jsx("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm2 16H8v-2h8zm0-4H8v-2h8zm-3-5V3.5L18.5 9z"})),zt=se(e.jsx("path",{d:"M15 4v2h3v12h-3v2h5V4zM4 20h5v-2H6V6h3V4H4z"})),Dr=se(e.jsx("path",{d:"M4 7v2c0 .55-.45 1-1 1H2v4h1c.55 0 1 .45 1 1v2c0 1.65 1.35 3 3 3h3v-2H7c-.55 0-1-.45-1-1v-2c0-1.3-.84-2.42-2-2.83v-.34C5.16 11.42 6 10.3 6 9V7c0-.55.45-1 1-1h3V4H7C5.35 4 4 5.35 4 7m17 3c-.55 0-1-.45-1-1V7c0-1.65-1.35-3-3-3h-3v2h3c.55 0 1 .45 1 1v2c0 1.3.84 2.42 2 2.83v.34c-1.16.41-2 1.52-2 2.83v2c0 .55-.45 1-1 1h-3v2h3c1.65 0 3-1.35 3-3v-2c0-.55.45-1 1-1h1v-4z"})),jo=se(e.jsx("path",{d:"M9.4 16.6 4.8 12l4.6-4.6L8 6l-6 6 6 6zm5.2 0 4.6-4.6-4.6-4.6L16 6l6 6-6 6z"})),So=({selectedFormat:t,onFormatChange:s})=>{const r=n=>{s(n.target.value)};return e.jsx(At,{variant:"outlined",sx:{height:"100%"},children:e.jsxs(Pt,{children:[e.jsx(y,{variant:"h6",gutterBottom:!0,children:"Select Export Format"}),e.jsx(Ue,{component:"fieldset",children:e.jsxs(Ps,{"aria-label":"export-format",name:"export-format",value:t,onChange:r,children:[e.jsxs(v,{sx:{mb:2,p:1,border:"1px solid",borderColor:t==="csv"?"primary.main":"divider",borderRadius:1,bgcolor:t==="csv"?"action.hover":"transparent"},children:[e.jsx(rt,{value:"csv",control:e.jsx(ut,{}),label:e.jsxs(v,{sx:{display:"flex",alignItems:"center",flexWrap:"wrap",gap:1},children:[e.jsx(is,{color:"primary"}),e.jsx(y,{variant:"body1",children:"CSV"}),e.jsx(de,{size:"small",label:"Most Compatible",color:"success"})]})}),e.jsx(y,{variant:"body2",color:"text.secondary",sx:{ml:4},children:"Comma-separated values format, widely supported by spreadsheet applications like Excel and Google Sheets."})]}),e.jsxs(v,{sx:{mb:2,p:1,border:"1px solid",borderColor:t==="json"?"primary.main":"divider",borderRadius:1,bgcolor:t==="json"?"action.hover":"transparent"},children:[e.jsx(rt,{value:"json",control:e.jsx(ut,{}),label:e.jsxs(v,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(jo,{color:"info"}),e.jsx(y,{variant:"body1",children:"JSON"})]})}),e.jsx(y,{variant:"body2",color:"text.secondary",sx:{ml:4},children:"JavaScript Object Notation, ideal for programmatic use or importing into other applications."})]}),e.jsxs(v,{sx:{p:1,border:"1px solid",borderColor:t==="excel"?"primary.main":"divider",borderRadius:1,bgcolor:t==="excel"?"action.hover":"transparent"},children:[e.jsx(rt,{value:"excel",control:e.jsx(ut,{}),label:e.jsxs(v,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(mt,{color:"success"}),e.jsx(y,{variant:"body1",children:"Excel"})]})}),e.jsx(y,{variant:"body2",color:"text.secondary",sx:{ml:4},children:"Export directly to native Excel format (.xlsx) with proper formatting and column sizing."})]}),e.jsxs(v,{sx:{p:1,border:"1px solid",borderColor:t==="pdf"?"primary.main":"divider",borderRadius:1,bgcolor:t==="pdf"?"action.hover":"transparent"},children:[e.jsx(rt,{value:"pdf",control:e.jsx(ut,{}),label:e.jsxs(v,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(yr,{color:"error"}),e.jsx(y,{variant:"body1",children:"PDF"}),e.jsx(de,{size:"small",label:"Professional",color:"secondary"})]})}),e.jsx(y,{variant:"body2",color:"text.secondary",sx:{ml:4},children:"Create a professional PDF document with formatted data table, ideal for reports and presentations."})]})]})})]})})},Co=se(e.jsx("path",{d:"M15.73 3H8.27L3 8.27v7.46L8.27 21h7.46L21 15.73V8.27zM12 17.3c-.72 0-1.3-.58-1.3-1.3s.58-1.3 1.3-1.3 1.3.58 1.3 1.3-.58 1.3-1.3 1.3m1-4.3h-2V7h2z"})),Et=[{id:"fire-map-pro",name:"Fire Map Pro",description:"Professional mapping and visualization for incident locations and analysis",icon:e.jsx(Kt,{fontSize:"large",sx:{color:"#dc2626"}}),requiredFields:["incidentId","latitude","longitude"],optionalFields:["incidentType","incidentDate","incidentTime","address","city","state","priority","respondingUnit","responseCategory"]},{id:"response-time-analyzer",name:"Response Time Analyzer",description:"Analyze incident response times and visualize performance metrics",icon:e.jsx(ls,{fontSize:"large",sx:{color:"#2196f3"}}),requiredFields:["incidentId","incidentDate"],optionalFields:["dispatchTime","enRouteTime","arrivalTime","latitude","longitude"]},{id:"call-density-heatmap",name:"Call Density Heatmap",description:"Visualize incident density across geographic areas",icon:e.jsx(Kt,{fontSize:"large",sx:{color:"#ff9800"}}),requiredFields:["incidentId","latitude","longitude"]},{id:"incident-dashboard",name:"Incident Dashboard",description:"Interactive dashboard for incident analysis and reporting",icon:e.jsx(cs,{fontSize:"large",sx:{color:"#4caf50"}}),requiredFields:["incidentId","incidentType","incidentDate"]},{id:"trend-analyzer",name:"Trend Analyzer",description:"Identify incident trends and patterns over time",icon:e.jsx(Wr,{fontSize:"large",sx:{color:"#9c27b0"}}),requiredFields:["incidentId","incidentDate","incidentType"]}],wo=({selectedTool:t,onToolSelect:s,transformedData:r,onSendToTool:n,isSending:i})=>{console.log(" SEND TO TOOL PANEL RENDER - FRESH BUILD JUN 13 2025 16:48 - selectedTool:",t),console.log(" SEND TO TOOL PANEL RENDER - onSendToTool function:",!!n),console.log(" SEND TO TOOL PANEL RENDER - transformedData length:",r==null?void 0:r.length);const c=u=>{s(u.target.value)},h=t?(u=>{const l=Et.find(R=>R.id===u);if(!l)return{compatible:!1,missingFields:[]};const f=Object.keys(r[0]),x=l.requiredFields.filter(R=>!f.includes(R)),b=l.optionalFields?l.optionalFields.filter(R=>f.includes(R)):[],D=l.optionalFields?l.optionalFields.filter(R=>!f.includes(R)):[];return{compatible:x.length===0,missingFields:x,hasOptionalFields:b,missingOptionalFields:D}})(t):{compatible:!1,missingFields:[]};return e.jsxs(v,{children:[e.jsx(y,{variant:"h6",gutterBottom:!0,children:"Send to FireEMS Tool"}),e.jsx(pe,{severity:"info",sx:{mb:3},children:"Send your formatted data directly to another FireEMS tool for analysis and visualization."}),e.jsxs(Ue,{fullWidth:!0,sx:{mb:3},children:[e.jsx(Ye,{id:"tool-select-label",children:"Select Tool"}),e.jsxs(We,{labelId:"tool-select-label",id:"tool-select",value:t||"",label:"Select Tool",onChange:c,children:[e.jsx(ae,{value:"",children:e.jsx("em",{children:"Select a tool..."})}),Et.map(u=>e.jsx(ae,{value:u.id,children:u.name},u.id))]})]}),t&&e.jsx(le,{container:!0,spacing:3,children:Et.filter(u=>u.id===t).map(u=>e.jsx(le,{size:12,children:e.jsxs(At,{variant:"outlined",children:[e.jsxs(Pt,{children:[e.jsxs(v,{sx:{display:"flex",alignItems:"center",mb:2},children:[u.icon,e.jsxs(v,{sx:{ml:2},children:[e.jsx(y,{variant:"h6",children:u.name}),e.jsx(y,{variant:"body2",color:"text.secondary",children:u.description})]})]}),e.jsx(xe,{sx:{mb:2}}),e.jsx(y,{variant:"subtitle2",gutterBottom:!0,children:"Required Fields:"}),e.jsx(v,{sx:{display:"flex",flexWrap:"wrap",gap:.5,mb:2},children:u.requiredFields.map((l,f)=>e.jsx(y,{variant:"body2",sx:{backgroundColor:h.missingFields.includes(l)?"error.light":"success.light",color:h.missingFields.includes(l)?"error.contrastText":"success.contrastText",borderRadius:1,px:1,py:.5},children:l},f))}),u.optionalFields&&e.jsxs(e.Fragment,{children:[e.jsx(y,{variant:"subtitle2",gutterBottom:!0,children:"Optional Fields:"}),e.jsx(v,{sx:{display:"flex",flexWrap:"wrap",gap:.5,mb:2},children:u.optionalFields.map((l,f)=>{var x,b;return e.jsx(y,{variant:"body2",sx:{backgroundColor:(x=h.hasOptionalFields)!=null&&x.includes(l)?"info.light":"action.disabledBackground",color:(b=h.hasOptionalFields)!=null&&b.includes(l)?"info.contrastText":"text.secondary",borderRadius:1,px:1,py:.5},children:l},f)})})]}),!h.compatible&&e.jsxs(pe,{severity:"warning",icon:e.jsx(Co,{}),sx:{mb:2},children:[e.jsx(y,{variant:"body2",gutterBottom:!0,children:"Your data is missing required fields for this tool:"}),e.jsx("ul",{style:{margin:0,paddingLeft:"20px"},children:h.missingFields.map((l,f)=>e.jsx("li",{children:l},f))})]}),h.compatible&&e.jsxs(pe,{severity:"success",sx:{mb:2},children:[e.jsx(y,{variant:"body2",gutterBottom:!0,children:"Your data is compatible with this tool. All required fields are present."}),u.optionalFields&&h.hasOptionalFields&&h.hasOptionalFields.length>0&&e.jsxs(y,{variant:"body2",children:[h.hasOptionalFields.length," of ",u.optionalFields.length," optional fields are available for enhanced analysis."]})]})]}),e.jsx(ws,{children:e.jsx(Z,{type:"button",variant:"contained",color:"primary",fullWidth:!0,disabled:!h.compatible||i,startIcon:i?e.jsx(Qe,{size:20}):e.jsx(Er,{}),onClick:l=>{l.preventDefault(),l.stopPropagation(),console.log(" SEND TO TOOL BUTTON CLICKED - FRESH BUILD JUN 13 2025 16:49 - tool.id:",u.id),console.log(" SEND TO TOOL BUTTON - onSendToTool function:",n),n()},children:i?"Sending...":`Send to ${u.name}`})})]})},u.id))})]})},To=({dataCount:t,fields:s,format:r})=>{const n=()=>{let c=15;r==="json"?c=25:r==="excel"?c=30:r==="pdf"&&(c=40);const o=t*s.length*c;let h=0;r==="excel"?h=5120:r==="pdf"&&(h=15360);const u=o+h;return u<1048576?`${Math.round(u/1024)} KB`:`${(u/1048576).toFixed(2)} MB`},i=()=>{switch(r){case"csv":return e.jsx(zt,{color:"primary"});case"json":return e.jsx(Dr,{color:"info"});case"excel":return e.jsx(mt,{color:"success"});case"pdf":return e.jsx(yr,{color:"error"});default:return e.jsx(zt,{})}};return e.jsx(At,{variant:"outlined",sx:{height:"100%"},children:e.jsxs(Pt,{children:[e.jsx(y,{variant:"h6",gutterBottom:!0,children:"Export Summary"}),e.jsxs(qe,{disablePadding:!0,children:[e.jsxs(Se,{children:[e.jsx(Pe,{sx:{minWidth:"40px"},children:i()}),e.jsx(Ce,{primary:"Format",secondary:r.toUpperCase()})]}),e.jsx(xe,{component:"li"}),e.jsxs(Se,{children:[e.jsx(Pe,{sx:{minWidth:"40px"},children:e.jsx(st,{color:"success"})}),e.jsx(Ce,{primary:"Records",secondary:`${t} records will be exported`})]}),e.jsx(xe,{component:"li"}),e.jsxs(Se,{children:[e.jsx(Pe,{sx:{minWidth:"40px"},children:e.jsx(st,{color:"success"})}),e.jsx(Ce,{primary:"Fields",secondary:`${s.length} fields per record`})]}),e.jsx(xe,{component:"li"}),e.jsxs(Se,{children:[e.jsx(Pe,{sx:{minWidth:"40px"},children:e.jsx(st,{color:"success"})}),e.jsx(Ce,{primary:"Estimated Size",secondary:n()})]})]}),e.jsx(y,{variant:"subtitle2",sx:{mt:2},children:"Fields included:"}),e.jsx(v,{sx:{display:"flex",flexWrap:"wrap",gap:.5,mt:1},children:s.map((c,o)=>e.jsx(de,{label:c,size:"small"},o))})]})})};console.log(" EXPORT CONTAINER LOADED - NEW VERSION WITH UPFRONT TRANSFORMATION AT",new Date().toISOString());const Fo=t=>!t||t.length===0?t:JSON.parse(JSON.stringify(t)).map(r=>{const n={...r};return["Incident Date"].forEach(o=>{if(n[o]&&typeof n[o]=="string")try{const h=new Date(n[o]);if(isNaN(h.getTime()))n[o].includes(" ")&&(n[o]=n[o].split(" ")[0]);else{const u=(h.getMonth()+1).toString().padStart(2,"0"),l=h.getDate().toString().padStart(2,"0"),f=h.getFullYear();n[o]=`${u}/${l}/${f}`}}catch{n[o].includes(" ")&&(n[o]=n[o].split(" ")[0])}}),["Dispatch Time","En Route Time","Arrival Time","Incident Time"].forEach(o=>{if(n[o]&&typeof n[o]=="string")try{const h=new Date(n[o]);if(isNaN(h.getTime())){if(n[o].includes(" ")){const u=n[o].split(" ");u.length>1&&(n[o]=u[1])}}else{const u=h.getHours().toString().padStart(2,"0"),l=h.getMinutes().toString().padStart(2,"0"),f=h.getSeconds().toString().padStart(2,"0");n[o]=`${u}:${l}:${f}`}}catch{if(n[o].includes(" ")){const u=n[o].split(" ");u.length>1&&(n[o]=u[1])}}}),n}),ar=t=>{const{children:s,value:r,index:n,...i}=t;return e.jsx("div",{role:"tabpanel",hidden:r!==n,id:`export-tabpanel-${n}`,"aria-labelledby":`export-tab-${n}`,...i,children:r===n&&e.jsx(v,{sx:{p:2},children:s})})},Eo=()=>{const t=dt(),{sourceFile:s,transformedData:r,validationErrors:n}=He(E=>E.formatter),[i,c]=w.useState(0),[o,h]=w.useState("csv"),[u,l]=w.useState(null),[f,x]=w.useState(null),[b,D]=w.useState(!1),[R,k]=w.useState({success:!1,message:"",open:!1}),[V,F]=w.useState([]),[N,$]=w.useState(!1);w.useEffect(()=>{try{const E=localStorage.getItem("fireEmsExportHistory");E&&F(JSON.parse(E))}catch(E){console.error("Error loading export history:",E)}},[]),w.useEffect(()=>{try{localStorage.setItem("fireEmsExportHistory",JSON.stringify(V))}catch(E){console.error("Error saving export history:",E)}},[V]);const T=(E,g)=>{c(g)},B=E=>{h(E)},P=E=>{var g;if(console.log(" CRITICAL DEBUG: handleToolChange CALLED AT",new Date().toISOString()),console.log(" TOOL SELECTION CHANGED - TRANSFORMING DATA UPFRONT:",E),console.log(" transformedData exists:",!!r),console.log(" transformedData length:",r==null?void 0:r.length),console.log(' toolId === "response-time-analyzer":',E==="response-time-analyzer"),l(E),E==="response-time-analyzer"&&r&&r.length>0){console.log(" APPLYING RESPONSE TIME ANALYZER TRANSFORMATION - UPFRONT METHOD"),console.log("Original data sample (first record):",r[0]),console.log("Original field names:",Object.keys(r[0]));try{const M=Gt.transformToResponseTimeAnalyzer(r);if(!M.success){console.error(" Data transformation failed:",M.errors),x(null);return}const p=M.data||[];console.log(" UPFRONT TRANSFORMATION SUCCESS"),console.log("Transformed data sample (first record):",p[0]),console.log("Transformed field names:",Object.keys(p[0])),console.log("incidentTime value:",(g=p[0])==null?void 0:g.incidentTime),x(p)}catch(M){console.error(" Error during upfront transformation:",M),x(null)}}else x(null)},_=(E,g,M,p,L)=>{const S={id:`export-${Date.now()}-${Math.random().toString(36).substr(2,5)}`,timestamp:Date.now(),format:E,recordCount:g,success:M,destination:p,fileName:L};F(I=>[S,...I].slice(0,20))},d=()=>{F([])},a=()=>{const E=new Date;return E.toLocaleDateString()+" "+E.toLocaleTimeString()},m=async()=>{if(!r||r.length===0){k({success:!1,message:"No data to export",open:!0});return}D(!0);try{const E=Fo(r);let g=`formatted_data_${Date.now()}`;if(o==="excel"){const C=await lr(()=>import("./xlsx-DkH2s96g.js"),[]),Y=C.utils.json_to_sheet(E),q={},K=Object.keys(r[0]);K.forEach(W=>{q[W]=Math.max(10,W.length+2)}),r.forEach(W=>{K.forEach(z=>{const H=String(W[z]||"");q[z]=Math.min(50,Math.max(q[z],H.length+2))})}),Y["!cols"]=K.map(W=>({wch:q[W]}));const G=C.utils.book_new();G.Props={Title:"FireEMS Formatted Data",Subject:"Incident Data",Author:"FireEMS Data Formatter",CreatedDate:new Date},C.utils.book_append_sheet(G,Y,"Formatted Data"),g=`formatted_data_${Date.now()}.xlsx`,C.writeFile(G,g),_("Excel",E.length,!0,"File Download",g),k({success:!0,message:"Data exported successfully as EXCEL",open:!0}),D(!1);return}if(o==="pdf"){const C=new qr;C.setFontSize(18),C.text("FireEMS Formatted Data",14,22),C.setFontSize(11),C.text(`Export Date: ${a()}`,14,30),C.text(`Records: ${E.length}`,14,36);const Y=Object.keys(E[0]);E.length>500&&C.text("Note: Export limited to 500 records for PDF format.",14,42);const q=E.length>500?48:42,K=30,G=10,W=10;C.setFontSize(10),C.setTextColor(0,0,0),C.setFillColor(220,220,220),Y.forEach((H,A)=>{C.rect(W+A*K,q,K,G,"FD"),C.text(H,W+A*K+2,q+7)});const z=Math.min(E.length,20);for(let H=0;H<z;H++){const A=q+(H+1)*G;Y.forEach((oe,ee)=>{C.rect(W+ee*K,A,K,G,"S");const te=E[H][oe]||"";let re=String(te);re.length>10&&(re=re.substring(0,8)+"..."),C.text(re,W+ee*K+2,A+7)})}C.setFontSize(8),C.text(`Generated by FireEMS Tools - ${new Date().toLocaleString()}`,C.internal.pageSize.width/2,C.internal.pageSize.height-10,{align:"center"}),g=`formatted_data_${Date.now()}.pdf`,C.save(g),_("PDF",E.length,!0,"File Download",g),k({success:!0,message:"Data exported successfully as PDF",open:!0}),D(!1);return}let M="",p="";if(o==="csv"){const C=Object.keys(E[0]);M=C.join(",")+`
`,E.forEach(Y=>{const q=C.map(K=>{const G=Y[K];return G==null?"":typeof G=="string"&&(G.includes(",")||G.includes('"')||G.includes(`
`))?`"${G.replace(/"/g,'""')}"`:G});M+=q.join(",")+`
`}),g=`formatted_data_${Date.now()}.csv`,p="text/csv"}else o==="json"&&(M=JSON.stringify(E,null,2),g=`formatted_data_${Date.now()}.json`,p="application/json");const L=new Blob([M],{type:p}),S=URL.createObjectURL(L),I=document.createElement("a");I.href=S,I.download=g,document.body.appendChild(I),I.click(),document.body.removeChild(I),URL.revokeObjectURL(S),_(o.toUpperCase(),E.length,!0,"File Download",g),k({success:!0,message:`Data exported successfully as ${o.toUpperCase()}`,open:!0})}catch(E){console.error("Export error:",E),k({success:!1,message:`Error exporting data: ${E instanceof Error?E.message:"Unknown error"}`,open:!0}),_(o.toUpperCase(),r.length,!1,"File Download")}finally{D(!1)}},j=E=>({"response-time-analyzer":"Response Time Analyzer","call-density-heatmap":"Call Density Heatmap","incident-dashboard":"Incident Dashboard","trend-analyzer":"Trend Analyzer"})[E]||E,O=async()=>{var g,M;if(console.log(" CRITICAL DEBUG: handleSendToTool FUNCTION CALLED AT",new Date().toISOString()),console.log(" selectedExportTool:",u),console.log(" transformedData length:",r==null?void 0:r.length),console.log(" preTransformedData length:",f==null?void 0:f.length),console.log(" transformedData sample:",r==null?void 0:r[0]),!r||r.length===0||!u){console.log(" SEND TO TOOL FAILED - Missing data or tool selection"),console.log(" transformedData:",!!r),console.log(" transformedData.length:",r==null?void 0:r.length),console.log(" selectedExportTool:",u),k({success:!1,message:"No data or tool selected",open:!0});return}D(!0);const E=j(u);console.log(" Tool name resolved:",E);try{let p;if(console.log(' CHECKING TOOL TYPE - selectedExportTool === "response-time-analyzer":',u==="response-time-analyzer"),console.log(" CHECKING PRE-TRANSFORMED DATA AVAILABILITY:",!!f),u==="response-time-analyzer"&&f&&f.length>0)console.log(" USING PRE-TRANSFORMED DATA FROM TOOL SELECTION - NO REDUNDANT TRANSFORMATION"),console.log("Pre-transformed data sample (first record):",f[0]),console.log("Pre-transformed field names:",Object.keys(f[0])),console.log("incidentTime value:",(g=f[0])==null?void 0:g.incidentTime),p=f;else if(u==="fire-map-pro"){console.log(" APPLYING FIRE MAP PRO TRANSFORMATION");const S=Gt.transformToFireMapPro(r);if(!S.success)throw console.error(" Data transformation failed:",S.errors),new Error(`Data transformation failed: ${S.errors.join(", ")}`);p=((M=S.data)==null?void 0:M.features)||[]}else console.log(" USING STANDARD DATA FORMATTING"),console.log("DEBUG - USING ALREADY TRANSFORMED DATA: Sample data fields:",r.length>0?Object.keys(r[0]):"No data"),p=r.map(S=>{const I={...S};return console.log("DEBUG - USING MAPPED DATA: Record fields:",Object.keys(S)),Object.keys(I).forEach(C=>{if(I[C]&&typeof I[C]=="string"&&I[C].includes(" ")){const[Y,q]=I[C].split(" ");console.log(`DATETIME SPLIT: Field "${C}" = "${I[C]}" -> Date: "${Y}", Time: "${q}"`),C.toLowerCase().includes("date")?(console.log(`SETTING DATE FIELD "${C}" to "${Y}"`),I[C]=Y):C.toLowerCase().includes("time")&&(console.log(`SETTING TIME FIELD "${C}" to "${q}"`),I[C]=q)}}),I});const L={toolId:u,toolName:E,data:p,sourceFile:s==null?void 0:s.name,timestamp:Date.now(),fields:Object.keys(p[0]),recordCount:p.length,exportVersion:"2.0"};if(p.length>0){console.log("Sample record being sent (using user-mapped fields):",p[0]);const S=p[0],I=Object.keys(S);console.log("All field names (as mapped by user):",I),console.log("Field values:",S)}sessionStorage.removeItem("fireEmsExportedData"),console.log("VERIFY: Field names being stored in sessionStorage:",L.data&&L.data.length>0?Object.keys(L.data[0]):"No data"),sessionStorage.setItem("fireEmsExportedData",JSON.stringify(L)),console.log(`Data prepared for ${u}. Data size: ${p.length} records`),p.length>0&&(console.log("FIELD NAMES CHECK - Sample record being sent to session storage:"),console.log(JSON.stringify(p[0]))),_("Data Transfer",p.length,!0,E),k({success:!0,message:`Data sent to ${E} successfully!`,open:!0}),setTimeout(()=>{const C=`http://${window.location.hostname}:5006`;let Y="";if(u==="fire-map-pro")Y=`${window.location.origin}/app/fire-map-pro`;else if(u==="response-time-analyzer")Y=`${window.location.origin}/app/response-time-analyzer`;else if(u==="call-density-heatmap")Y=`${C}/call-density-heatmap`;else if(u==="incident-dashboard")Y=`${C}/incident-dashboard`;else if(u==="trend-analyzer")Y=`${C}/trend-analyzer`;else{console.log(`Tool ID not recognized: ${u}`);return}console.log(`Redirecting to: ${Y}`),window.location.href=Y},500)}catch(p){console.error("Send to tool error:",p),k({success:!1,message:`Error sending data to tool: ${p instanceof Error?p.message:"Unknown error"}`,open:!0}),_("Data Transfer",r.length,!1,E)}finally{D(!1)}},U=()=>{t(Be(2))};if(!r||r.length===0)return e.jsxs(v,{children:[e.jsx(pe,{severity:"warning",sx:{mb:2},children:"No data available to export. Please go back and ensure your data is processed correctly."}),e.jsx(Z,{variant:"outlined",startIcon:e.jsx(nt,{}),onClick:U,children:"Back to Validation"})]});const X=E=>new Date(E).toLocaleString(),ne=()=>V.length===0?e.jsx(v,{sx:{p:2,textAlign:"center"},children:e.jsx(y,{color:"text.secondary",children:"No export history available"})}):e.jsx(qe,{sx:{width:"100%",bgcolor:"background.paper"},dense:!0,children:V.map(E=>e.jsxs(Se,{secondaryAction:e.jsx(De,{edge:"end","aria-label":"delete",onClick:()=>{F(g=>g.filter(M=>M.id!==E.id))},children:e.jsx(ft,{fontSize:"small"})}),sx:{borderLeft:"4px solid",borderColor:E.success?"success.main":"error.main",mb:1,bgcolor:"background.paper","&:hover":{bgcolor:"action.hover"}},children:[e.jsxs(Pe,{children:[E.format==="Excel"&&e.jsx(mt,{color:"success"}),E.format==="CSV"&&e.jsx(zt,{color:"primary"}),E.format==="JSON"&&e.jsx(Dr,{color:"info"}),E.format==="PDF"&&e.jsx(mt,{color:"error"}),E.format==="Data Transfer"&&e.jsx(Er,{color:"secondary"})]}),e.jsx(Ce,{primary:e.jsx(y,{variant:"body2",fontWeight:"medium",children:E.format==="Data Transfer"?`Sent to ${E.destination}`:`${E.format} Export${E.fileName?` - ${E.fileName}`:""}`}),secondary:e.jsxs(y,{variant:"caption",display:"block",children:[X(E.timestamp),"  ",E.recordCount," records",!E.success&&"  Failed"]})})]},E.id))});return console.log(" EXPORT CONTAINER RENDER - FRESH BUILD JUN 13 2025 16:47 - transformedData length:",r==null?void 0:r.length),console.log(" EXPORT CONTAINER RENDER - selectedExportTool:",u),console.log(" EXPORT CONTAINER RENDER - tabValue:",i),e.jsxs(v,{children:[e.jsx(y,{variant:"h5",gutterBottom:!0,sx:{mb:3},children:"Export Formatted Data"}),e.jsxs(he,{sx:{p:2,mb:3},children:[e.jsxs(le,{container:!0,spacing:2,children:[e.jsx(le,{size:{xs:12,md:4},children:e.jsxs(v,{children:[e.jsx(y,{variant:"subtitle2",color:"text.secondary",children:"Source File"}),e.jsxs(y,{variant:"body1",children:[(s==null?void 0:s.name)||"No file"," (",s==null?void 0:s.type,")"]})]})}),e.jsx(le,{size:{xs:12,md:4},children:e.jsxs(v,{children:[e.jsx(y,{variant:"subtitle2",color:"text.secondary",children:"Records"}),e.jsxs(y,{variant:"body1",children:[r.length," records processed"]})]})}),e.jsx(le,{size:{xs:12,md:4},children:e.jsxs(v,{children:[e.jsx(y,{variant:"subtitle2",color:"text.secondary",children:"Validation Status"}),e.jsx(v,{sx:{display:"flex",alignItems:"center",gap:1},children:n.length===0?e.jsxs(e.Fragment,{children:[e.jsx(st,{color:"success"}),e.jsx(y,{color:"success.main",children:"All data is valid"})]}):e.jsx(e.Fragment,{children:e.jsxs(pe,{severity:"warning",sx:{mt:1},children:[n.length," validation issues found. Consider reviewing before export."]})})})]})})]}),e.jsxs(v,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:2,pt:2,borderTop:"1px solid",borderColor:"divider"},children:[e.jsxs(v,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(vo,{color:"action",fontSize:"small"}),e.jsx(y,{variant:"subtitle2",color:"text.secondary",children:"Export History"}),V.length>0&&e.jsx(vs,{badgeContent:V.length,color:"primary",sx:{ml:1}})]}),e.jsxs(v,{children:[e.jsx(De,{size:"small",onClick:()=>$(!N),"aria-label":N?"Hide history":"Show history",children:N?e.jsx(cr,{}):e.jsx(yt,{})}),V.length>0&&N&&e.jsx(Z,{size:"small",startIcon:e.jsx(ft,{}),onClick:d,sx:{ml:1},children:"Clear"})]})]}),e.jsx(mr,{in:N,children:e.jsx(v,{sx:{mt:2},children:ne()})})]}),e.jsx(v,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(gt,{value:i,onChange:T,"aria-label":"export options tabs",children:[e.jsx(Ee,{label:"Download File",id:"export-tab-0","aria-controls":"export-tabpanel-0"}),e.jsx(Ee,{label:"Send to Tool",id:"export-tab-1","aria-controls":"export-tabpanel-1"})]})}),e.jsx(ar,{value:i,index:0,children:e.jsxs(le,{container:!0,spacing:3,children:[e.jsx(le,{size:{xs:12,md:6},children:e.jsx(So,{selectedFormat:o,onFormatChange:B})}),e.jsx(le,{size:{xs:12,md:6},children:e.jsx(To,{dataCount:r.length,fields:Object.keys(r[0]),format:o})}),e.jsx(le,{size:12,children:e.jsx(Z,{variant:"contained",color:"primary",fullWidth:!0,size:"large",onClick:m,disabled:b,startIcon:b?e.jsx(Qe,{size:20}):e.jsx(ds,{}),sx:{mt:2},children:b?"Exporting...":`Download as ${o.toUpperCase()}`})})]})}),e.jsx(ar,{value:i,index:1,children:e.jsx(wo,{selectedTool:u,onToolSelect:P,transformedData:f||r,onSendToTool:O,isSending:b})}),e.jsx(xe,{sx:{my:3}}),e.jsx(v,{sx:{display:"flex",justifyContent:"space-between"},children:e.jsx(Z,{variant:"outlined",startIcon:e.jsx(nt,{}),onClick:U,children:"Back to Validation"})}),e.jsx(gr,{open:R.open,autoHideDuration:6e3,onClose:()=>k({...R,open:!1}),children:e.jsx(pe,{onClose:()=>k({...R,open:!1}),severity:R.success?"success":"error",children:R.message})})]})},Do=["Upload File","Map Fields","Preview & Validate","Export"],$o=()=>{const{currentStep:t}=He(n=>n.formatter),s=()=>{const n=window.location.pathname;return n.includes("fire-map-pro")?"FireEMS Fire Map Pro":n.includes("response-time-analyzer")?"FireEMS Response Time Analyzer":"FireEMS Data Formatter"};Ze.useEffect(()=>{const n=s();document.title=n},[]);const r=n=>{switch(n){case 0:return e.jsx(Tn,{});case 1:return e.jsx(ao,{});case 2:return e.jsx(bo,{});case 3:return e.jsx(Eo,{});default:return e.jsx(y,{children:"Unknown step"})}};return e.jsx(Nr,{maxWidth:"lg",sx:{mt:4,mb:4},children:e.jsxs(he,{elevation:3,sx:{p:3},children:[e.jsx(y,{variant:"h4",component:"h1",gutterBottom:!0,children:s()}),e.jsx(pn,{activeStep:t,sx:{mb:4},children:Do.map(n=>e.jsx(Us,{children:e.jsx(Sr,{children:n})},n))}),e.jsx(v,{sx:{mt:2},children:r(t)})]})})};export{$o as default};
