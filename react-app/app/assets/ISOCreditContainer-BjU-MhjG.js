var tt=Object.defineProperty;var it=(i,s,l)=>s in i?tt(i,s,{enumerable:!0,configurable:!0,writable:!0,value:l}):i[s]=l;var ae=(i,s,l)=>it(i,typeof s!="symbol"?s+"":s,l);import{e as se,j as e,r as M,t as o,v as t,b0 as K,G as f,aj as ne,cK as rt,aF as nt,bs as ot,ay as Y,az as J,bB as be,V as T,aA as Z,aB as ee,cL as ve,aQ as Je,P as N,H as te,I as ie,am as re,al as w,aS as O,aT as E,ce as Ke,a0 as ge,Z as Q,L as U,cM as V,K as me,cN as ye,w as at,by as st,y as ct,z as lt,A as dt,C as je,E as X,F as pt,aO as xt,D as ut,aL as ht,au as mt,aM as ft,bT as gt,aw as jt,W as Qe,ak as yt,aP as bt,Q as vt,R as $,b_ as St,a1 as xe,c2 as Ct,b8 as It,b9 as Ye,b3 as kt,aV as Ft}from"./index-DBGmiIig.js";import{S as C,A as Rt,a as Dt}from"./A11yProvider-C53o4tbA.js";import{T as Pt}from"./Tune-B1wS-9RD.js";import{a as ue}from"./jspdf.plugin.autotable-CtA5BUKo.js";import{E as Ze,M as wt,D as Ot}from"./Menu-B0MQDAlD.js";import{u as Et,F as Tt,a as Mt}from"./FullscreenExit-NYbzoVvc.js";const At=se(e.jsx("path",{d:"M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4"})),Lt=se(e.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-5.97 4.06L14.09 6l1.41 1.41L16.91 6l1.06 1.06-1.41 1.41 1.41 1.41-1.06 1.06-1.41-1.4-1.41 1.41-1.06-1.06 1.41-1.41zm-6.78.66h5v1.5h-5zM11.5 16h-2v2H8v-2H6v-1.5h2v-2h1.5v2h2zm6.5 1.25h-5v-1.5h5zm0-2.5h-5v-1.5h5z"})),Se=se(e.jsx("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02z"})),Bt=se([e.jsx("circle",{cx:"12",cy:"19",r:"2"},"0"),e.jsx("path",{d:"M10 3h4v12h-4z"},"1")]),Ce=se(e.jsx("path",{d:"M5 13.18v4L12 21l7-3.82v-4L12 17zM12 3 1 9l11 6 9-4.91V17h2V9z"})),Wt=({mode:i="assessment",onAssessmentChange:s,onScoreChange:l,onClassificationChange:p})=>{const[d,b]=M.useState({fireDepartment:{staffing:0,equipment:0,training:0,distribution:0},waterSupply:{capacity:0,distribution:0,alternative:0},communications:{dispatch:0,alerting:0},communityRiskReduction:{prevention:0,education:0,investigation:0}}),[k,j]=M.useState("fire-department"),[D,W]=M.useState(!0);M.useEffect(()=>{s(d),D&&h()},[d,D]);const h=()=>{const r=Object.values(d.fireDepartment).reduce((P,A)=>P+A,0),n=Object.values(d.waterSupply).reduce((P,A)=>P+A,0),x=Object.values(d.communications).reduce((P,A)=>P+A,0),I=Object.values(d.communityRiskReduction).reduce((P,A)=>P+A,0),B=r+n+x+I,z=m(B);l(B),p(z)},m=r=>{const n=r/105.5*100;return n>=90?1:n>=80?2:n>=70?3:n>=60?4:n>=50?5:n>=40?6:n>=30?7:n>=20?8:n>=10?9:10},y=r=>(n,x)=>{j(x?r:"")},g=(r,n)=>{b(x=>({...x,fireDepartment:{...x.fireDepartment,[r]:n}}))},F=(r,n)=>{b(x=>({...x,waterSupply:{...x.waterSupply,[r]:n}}))},v=(r,n)=>{b(x=>({...x,communications:{...x.communications,[r]:n}}))},R=(r,n)=>{b(x=>({...x,communityRiskReduction:{...x.communityRiskReduction,[r]:n}}))},u=()=>{b({fireDepartment:{staffing:0,equipment:0,training:0,distribution:0},waterSupply:{capacity:0,distribution:0,alternative:0},communications:{dispatch:0,alerting:0},communityRiskReduction:{prevention:0,education:0,investigation:0}})},S=()=>Object.values(d.fireDepartment).reduce((r,n)=>r+n,0)+Object.values(d.waterSupply).reduce((r,n)=>r+n,0)+Object.values(d.communications).reduce((r,n)=>r+n,0)+Object.values(d.communityRiskReduction).reduce((r,n)=>r+n,0);return e.jsxs(o,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[e.jsxs(o,{sx:{p:2,borderBottom:1,borderColor:"divider"},children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"ISO Assessment Input"}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Enter your fire department's capabilities to calculate ISO classification"}),e.jsxs(o,{sx:{mt:2},children:[e.jsxs(t,{variant:"body2",gutterBottom:!0,children:["Current Score: ",S().toFixed(1)," / 105.5"]}),e.jsx(K,{variant:"determinate",value:S()/105.5*100,sx:{height:6,borderRadius:3}})]})]}),e.jsxs(o,{sx:{p:2,borderBottom:1,borderColor:"divider"},children:[e.jsxs(f,{container:!0,spacing:1,children:[e.jsx(f,{size:{xs:6},children:e.jsx(ne,{variant:"outlined",size:"small",startIcon:e.jsx(Lt,{}),onClick:h,disabled:D,fullWidth:!0,children:"Calculate"})}),e.jsx(f,{size:{xs:6},children:e.jsx(ne,{variant:"outlined",size:"small",startIcon:e.jsx(rt,{}),onClick:u,fullWidth:!0,children:"Reset"})})]}),e.jsx(nt,{control:e.jsx(ot,{checked:D,onChange:r=>W(r.target.checked),size:"small"}),label:"Auto-calculate",sx:{mt:1}})]}),e.jsxs(o,{sx:{flexGrow:1,overflow:"auto"},children:[e.jsxs(Y,{expanded:k==="fire-department",onChange:y("fire-department"),children:[e.jsx(J,{expandIcon:e.jsx(Z,{}),children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1,width:"100%"},children:[e.jsx(be,{sx:{color:"#ff5722"}}),e.jsxs(o,{sx:{flexGrow:1},children:[e.jsx(t,{variant:"subtitle1",children:"Fire Department"}),e.jsxs(t,{variant:"caption",color:"text.secondary",children:[Object.values(d.fireDepartment).reduce((r,n)=>r+n,0).toFixed(1)," / 50 points"]})]}),e.jsx(T,{label:"50 pts",size:"small",sx:{bgcolor:"#ff5722",color:"white"}})]})}),e.jsx(ee,{children:e.jsxs(o,{sx:{space:2},children:[e.jsxs(o,{sx:{mb:3},children:[e.jsx(t,{variant:"body2",gutterBottom:!0,children:"Staffing & Personnel Deployment (12.5 pts)"}),e.jsx(C,{value:d.fireDepartment.staffing,onChange:(r,n)=>g("staffing",n),min:0,max:12.5,step:.1,valueLabelDisplay:"auto",sx:{color:"#ff5722"}}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Personnel availability, response times, staffing levels"})]}),e.jsxs(o,{sx:{mb:3},children:[e.jsx(t,{variant:"body2",gutterBottom:!0,children:"Equipment & Apparatus (12.5 pts)"}),e.jsx(C,{value:d.fireDepartment.equipment,onChange:(r,n)=>g("equipment",n),min:0,max:12.5,step:.1,valueLabelDisplay:"auto",sx:{color:"#ff5722"}}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"NFPA 1901 compliance, maintenance, testing"})]}),e.jsxs(o,{sx:{mb:3},children:[e.jsx(t,{variant:"body2",gutterBottom:!0,children:"Training Programs (12.5 pts)"}),e.jsx(C,{value:d.fireDepartment.training,onChange:(r,n)=>g("training",n),min:0,max:12.5,step:.1,valueLabelDisplay:"auto",sx:{color:"#ff5722"}}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"20+ hours/month structure fire training = 2.25 pts"})]}),e.jsxs(o,{sx:{mb:3},children:[e.jsx(t,{variant:"body2",gutterBottom:!0,children:"Station Distribution & Coverage (12.5 pts)"}),e.jsx(C,{value:d.fireDepartment.distribution,onChange:(r,n)=>g("distribution",n),min:0,max:12.5,step:.1,valueLabelDisplay:"auto",sx:{color:"#ff5722"}}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Station locations, response coverage, mutual aid"})]})]})})]}),e.jsxs(Y,{expanded:k==="water-supply",onChange:y("water-supply"),children:[e.jsx(J,{expandIcon:e.jsx(Z,{}),children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1,width:"100%"},children:[e.jsx(ve,{sx:{color:"#2196f3"}}),e.jsxs(o,{sx:{flexGrow:1},children:[e.jsx(t,{variant:"subtitle1",children:"Water Supply"}),e.jsxs(t,{variant:"caption",color:"text.secondary",children:[Object.values(d.waterSupply).reduce((r,n)=>r+n,0).toFixed(1)," / 40 points"]})]}),e.jsx(T,{label:"40 pts",size:"small",sx:{bgcolor:"#2196f3",color:"white"}})]})}),e.jsx(ee,{children:e.jsxs(o,{sx:{space:2},children:[e.jsxs(o,{sx:{mb:3},children:[e.jsx(t,{variant:"body2",gutterBottom:!0,children:"Water Capacity & Flow (20 pts)"}),e.jsx(C,{value:d.waterSupply.capacity,onChange:(r,n)=>F("capacity",n),min:0,max:20,step:.1,valueLabelDisplay:"auto",sx:{color:"#2196f3"}}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Minimum 250 GPM for 2 hours (Class 8B: 200 GPM for 20 min)"})]}),e.jsxs(o,{sx:{mb:3},children:[e.jsx(t,{variant:"body2",gutterBottom:!0,children:"Hydrant Distribution (15 pts)"}),e.jsx(C,{value:d.waterSupply.distribution,onChange:(r,n)=>F("distribution",n),min:0,max:15,step:.1,valueLabelDisplay:"auto",sx:{color:"#2196f3"}}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Hydrant spacing max 1,000 feet from incidents"})]}),e.jsxs(o,{sx:{mb:3},children:[e.jsx(t,{variant:"body2",gutterBottom:!0,children:"Alternative Water Supply (5 pts)"}),e.jsx(C,{value:d.waterSupply.alternative,onChange:(r,n)=>F("alternative",n),min:0,max:5,step:.1,valueLabelDisplay:"auto",sx:{color:"#2196f3"}}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Dry hydrants, tanker shuttles, rural supplies"})]})]})})]}),e.jsxs(Y,{expanded:k==="communications",onChange:y("communications"),children:[e.jsx(J,{expandIcon:e.jsx(Z,{}),children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1,width:"100%"},children:[e.jsx(Se,{sx:{color:"#9c27b0"}}),e.jsxs(o,{sx:{flexGrow:1},children:[e.jsx(t,{variant:"subtitle1",children:"Communications"}),e.jsxs(t,{variant:"caption",color:"text.secondary",children:[Object.values(d.communications).reduce((r,n)=>r+n,0).toFixed(1)," / 10 points"]})]}),e.jsx(T,{label:"10 pts",size:"small",sx:{bgcolor:"#9c27b0",color:"white"}})]})}),e.jsx(ee,{children:e.jsxs(o,{sx:{space:2},children:[e.jsxs(o,{sx:{mb:3},children:[e.jsx(t,{variant:"body2",gutterBottom:!0,children:"911 Dispatch Center (7 pts)"}),e.jsx(C,{value:d.communications.dispatch,onChange:(r,n)=>v("dispatch",n),min:0,max:7,step:.1,valueLabelDisplay:"auto",sx:{color:"#9c27b0"}}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Call processing, dispatch times, capabilities"})]}),e.jsxs(o,{sx:{mb:3},children:[e.jsx(t,{variant:"body2",gutterBottom:!0,children:"Alerting Systems (3 pts)"}),e.jsx(C,{value:d.communications.alerting,onChange:(r,n)=>v("alerting",n),min:0,max:3,step:.1,valueLabelDisplay:"auto",sx:{color:"#9c27b0"}}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Radio systems, pagers, notification equipment"})]})]})})]}),e.jsxs(Y,{expanded:k==="community-risk",onChange:y("community-risk"),children:[e.jsx(J,{expandIcon:e.jsx(Z,{}),children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1,width:"100%"},children:[e.jsx(Ce,{sx:{color:"#4caf50"}}),e.jsxs(o,{sx:{flexGrow:1},children:[e.jsx(t,{variant:"subtitle1",children:"Community Risk Reduction"}),e.jsxs(t,{variant:"caption",color:"text.secondary",children:[Object.values(d.communityRiskReduction).reduce((r,n)=>r+n,0).toFixed(1)," / 5.5 points"]})]}),e.jsx(T,{label:"BONUS",size:"small",sx:{bgcolor:"#4caf50",color:"white"}})]})}),e.jsx(ee,{children:e.jsxs(o,{sx:{space:2},children:[e.jsxs(o,{sx:{mb:3},children:[e.jsx(t,{variant:"body2",gutterBottom:!0,children:"Fire Prevention (2.5 pts)"}),e.jsx(C,{value:d.communityRiskReduction.prevention,onChange:(r,n)=>R("prevention",n),min:0,max:2.5,step:.1,valueLabelDisplay:"auto",sx:{color:"#4caf50"}}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Code enforcement, inspections, prevention programs"})]}),e.jsxs(o,{sx:{mb:3},children:[e.jsx(t,{variant:"body2",gutterBottom:!0,children:"Public Education (2 pts)"}),e.jsx(C,{value:d.communityRiskReduction.education,onChange:(r,n)=>R("education",n),min:0,max:2,step:.1,valueLabelDisplay:"auto",sx:{color:"#4caf50"}}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Community outreach, education programs"})]}),e.jsxs(o,{sx:{mb:3},children:[e.jsx(t,{variant:"body2",gutterBottom:!0,children:"Fire Investigation (1 pt)"}),e.jsx(C,{value:d.communityRiskReduction.investigation,onChange:(r,n)=>R("investigation",n),min:0,max:1,step:.1,valueLabelDisplay:"auto",sx:{color:"#4caf50"}}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Fire investigation capabilities and training"})]})]})})]})]})]})},zt=({assessment:i,currentScore:s,classification:l,sidebarOpen:p,isMobile:d})=>{var n,x,I,B,z,P,A,ce,oe,le,H,de,Ie,ke,Fe,Re,De,Pe,we,Oe,Ee,Te,Me,Ae,Le,Be,We,ze,$e,Ge,qe,Ne,He,_e,Ue,Ve,Xe;const b=()=>{if(!i)return 0;const{staffing:a,equipment:c,training:L,distribution:G}=i.fireDepartment,q=Math.min(a,12.5),_=Math.min(c,12.5),fe=Math.min(L,12.5),pe=Math.min(G,12.5);return q+_+fe+pe},k=()=>{if(!i)return 0;const{capacity:a,distribution:c,alternative:L}=i.waterSupply,G=Math.min(a,20),q=Math.min(c,15),_=Math.min(L,5);return G+q+_},j=()=>{if(!i)return 0;const{dispatch:a,alerting:c}=i.communications,L=Math.min(a,7),G=Math.min(c,3);return L+G},D=()=>{if(!i)return 0;const{prevention:a,education:c,investigation:L}=i.communityRiskReduction,G=Math.min(a,2.5),q=Math.min(c,2),_=Math.min(L,1);return G+q+_},W=()=>{const a=b(),c=k(),L=j(),G=D();let q=a+c+L;const _=a/50,fe=c/40,pe=Math.abs(_-fe);if(pe>.1){const et=pe*10;q=Math.max(0,q-et)}return q+G},h=a=>{const c=a/105.5*100;return c>=90?1:c>=80?2:c>=70?3:c>=60?4:c>=50?5:c>=40?6:c>=30?7:c>=20?8:c>=10?9:10},m=(a,c)=>{const L=a/c*100;return L>=90?{level:"EXCELLENT",color:"#1b5e20",bg:"#e8f5e8",icon:e.jsx(Q,{}),description:"Top 10% of departments"}:L>=75?{level:"GOOD",color:"#2e7d32",bg:"#f1f8e9",icon:e.jsx(Q,{}),description:"Above average performance"}:L>=60?{level:"NEEDS IMPROVEMENT",color:"#ff8f00",bg:"#fff8e1",icon:e.jsx(ge,{}),description:"Below average - opportunity exists"}:{level:"CRITICAL",color:"#d32f2f",bg:"#ffebee",icon:e.jsx(Ke,{}),description:"Major deficiency affecting rating"}},y=a=>{switch(a){case 1:return{color:"#1b5e20",bg:"#e8f5e8",desc:"Superior Protection",icon:e.jsx(Q,{}),benchmark:"Elite - Top 1% of departments"};case 2:case 3:return{color:"#2e7d32",bg:"#f1f8e9",desc:"Excellent Protection",icon:e.jsx(Q,{}),benchmark:"Top 25% of departments"};case 4:case 5:return{color:"#558b2f",bg:"#f9fbe7",desc:"Good Protection",icon:e.jsx(Q,{}),benchmark:"Above average for community size"};case 6:case 7:return{color:"#ff8f00",bg:"#fff8e1",desc:"Fair Protection",icon:e.jsx(ge,{}),benchmark:"Below average - improvement needed"};case 8:case 9:return{color:"#f57c00",bg:"#fff3e0",desc:"Poor Protection",icon:e.jsx(ge,{}),benchmark:"Bottom 25% - significant gaps"};case 10:default:return{color:"#d32f2f",bg:"#ffebee",desc:"Inadequate Protection",icon:e.jsx(Ke,{}),benchmark:"Critical deficiencies present"}}},g=b(),F=k(),v=j(),R=D(),u=W(),S=h(u),r=y(S);return e.jsxs(o,{sx:{p:3,height:"100%",overflow:"auto"},children:[e.jsxs(o,{sx:{mb:4},children:[e.jsxs(t,{variant:"h4",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(Je,{sx:{fontSize:40,color:"primary.main"}}),"ISO Fire Rating Assessment"]}),e.jsx(t,{variant:"subtitle1",color:"text.secondary",children:"Fire Suppression Rating Schedule (FSRS) Analysis - 105.5 Point System"})]}),e.jsx(N,{elevation:3,sx:{p:3,mb:4,background:`linear-gradient(135deg, ${r.bg} 0%, #ffffff 100%)`,border:`2px solid ${r.color}`},children:e.jsxs(f,{container:!0,spacing:3,alignItems:"center",children:[e.jsx(f,{size:{xs:12,md:4},children:e.jsxs(o,{sx:{textAlign:"center"},children:[e.jsx(t,{variant:"h2",sx:{color:r.color,fontWeight:"bold",mb:1},children:S}),e.jsx(T,{icon:r.icon,label:`Class ${S}`,sx:{bgcolor:r.color,color:"white",fontSize:"1.1rem",px:2,py:1}})]})}),e.jsxs(f,{size:{xs:12,md:8},children:[e.jsx(t,{variant:"h5",sx:{color:r.color,mb:1},children:r.desc}),e.jsxs(t,{variant:"body1",sx:{color:"text.secondary",mb:2,fontStyle:"italic"},children:["📊 ",r.benchmark]}),e.jsxs(t,{variant:"h6",gutterBottom:!0,children:["Total Score: ",u.toFixed(1)," / 105.5 points"]}),e.jsx(K,{variant:"determinate",value:u/105.5*100,sx:{height:10,borderRadius:5,bgcolor:"rgba(0,0,0,0.1)","& .MuiLinearProgress-bar":{bgcolor:r.color}}}),e.jsxs(t,{variant:"body2",sx:{mt:1,color:"text.secondary"},children:[(u/105.5*100).toFixed(1),"% of maximum possible score"]}),S>1&&e.jsxs(o,{sx:{mt:2,p:2,bgcolor:"rgba(0,0,0,0.05)",borderRadius:1},children:[e.jsxs(t,{variant:"body2",sx:{fontWeight:"bold",color:"primary.main"},children:["🎯 Path to Class ",S-1,":"]}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:["Need ",(Math.ceil((S-1)*10.55)-u).toFixed(1)," more points",S===5&&" (90+ points for Class 4 - significant insurance savings)",S===2&&" (95+ points for Class 1 - elite rating)"]})]})]})]})}),e.jsxs(f,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(f,{size:{xs:12,md:6},children:e.jsx(te,{elevation:2,children:e.jsxs(ie,{children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(be,{sx:{color:"#ff5722",mr:1}}),e.jsx(t,{variant:"h6",children:"Fire Department Operations"})]}),(()=>{const a=m(g,50);return e.jsx(T,{icon:a.icon,label:a.level,size:"small",sx:{bgcolor:a.color,color:"white",fontWeight:"bold"}})})()]}),e.jsxs(t,{variant:"h4",sx:{color:"#ff5722",mb:1},children:[g.toFixed(1)," / 50"]}),e.jsxs(t,{variant:"body2",sx:{color:"text.secondary",mb:2},children:[(g/50*100).toFixed(0),"% • ",m(g,50).description]}),e.jsx(K,{variant:"determinate",value:g/50*100,sx:{mb:2,"& .MuiLinearProgress-bar":{bgcolor:"#ff5722"}}}),e.jsxs(re,{dense:!0,children:[e.jsxs(w,{children:[e.jsx(O,{children:(()=>{var c;const a=m(((c=i==null?void 0:i.fireDepartment)==null?void 0:c.staffing)||0,12.5);return e.jsx(o,{sx:{color:a.color},children:a.icon})})()}),e.jsx(E,{primary:`Staffing: ${((x=(n=i==null?void 0:i.fireDepartment)==null?void 0:n.staffing)==null?void 0:x.toFixed(1))||"0.0"} / 12.5`,secondary:e.jsxs(o,{children:[e.jsx(t,{variant:"caption",color:"text.secondary",children:e.jsx("strong",{children:"ISO Requirements:"})}),e.jsxs(t,{variant:"caption",sx:{display:"block",mt:.5},children:["• ",e.jsx("strong",{children:"Engine Company:"})," Minimum 3 firefighters + 1 officer (4 total)"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Ladder Company:"})," Minimum 3 firefighters + 1 officer (4 total)"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"On-Duty Staffing:"})," 24/7 coverage with sufficient personnel"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Response Goal:"})," 15 firefighters within 8 minutes for structure fires"]}),((I=i==null?void 0:i.fireDepartment)==null?void 0:I.staffing)&&i.fireDepartment.staffing<9.5&&e.jsxs(t,{variant:"caption",sx:{color:"#ff8f00",display:"block",mt:1,fontWeight:"bold"},children:["💡 Need: +",Math.ceil((9.5-i.fireDepartment.staffing)/2)," firefighters per shift"]})]})})]}),e.jsxs(w,{children:[e.jsx(O,{children:(()=>{var c;const a=m(((c=i==null?void 0:i.fireDepartment)==null?void 0:c.equipment)||0,12.5);return e.jsx(o,{sx:{color:a.color},children:a.icon})})()}),e.jsx(E,{primary:`Equipment: ${((z=(B=i==null?void 0:i.fireDepartment)==null?void 0:B.equipment)==null?void 0:z.toFixed(1))||"0.0"} / 12.5`,secondary:e.jsxs(o,{children:[e.jsx(t,{variant:"caption",color:"text.secondary",children:e.jsx("strong",{children:"ISO Equipment Requirements:"})}),e.jsxs(t,{variant:"caption",sx:{display:"block",mt:.5},children:["• ",e.jsx("strong",{children:"Engine Companies:"})," 1,000+ GPM pump, 300+ gallons water tank"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Ladder Companies:"})," 75-100 ft aerial ladder or platform"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Ground Ladders:"})," 115 ft total (various lengths)"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"SCBA:"})," 10 sets minimum per engine/ladder company"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Hose:"}),' 3,000 ft of 2½" hose per engine company']}),(P=i==null?void 0:i.fireDepartment)!=null&&P.equipment&&i.fireDepartment.equipment>=10?e.jsx(t,{variant:"caption",sx:{color:"#2e7d32",display:"block",mt:1,fontWeight:"bold"},children:"✅ Equipment meets community requirements"}):e.jsx(t,{variant:"caption",sx:{color:"#ff8f00",display:"block",mt:1,fontWeight:"bold"},children:"⚠️ Review apparatus compliance with NFPA 1901 standards"})]})})]}),e.jsxs(w,{children:[e.jsx(O,{children:(()=>{var c;const a=m(((c=i==null?void 0:i.fireDepartment)==null?void 0:c.training)||0,12.5);return e.jsx(o,{sx:{color:a.color},children:a.icon})})()}),e.jsx(E,{primary:`Training: ${((ce=(A=i==null?void 0:i.fireDepartment)==null?void 0:A.training)==null?void 0:ce.toFixed(1))||"0.0"} / 12.5`,secondary:e.jsxs(o,{children:[e.jsx(t,{variant:"caption",color:"text.secondary",children:e.jsx("strong",{children:"ISO Training Requirements:"})}),e.jsxs(t,{variant:"caption",sx:{display:"block",mt:.5},children:["• ",e.jsx("strong",{children:"Structure Fire:"})," 20+ hours per firefighter per month"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Basic Training:"})," Firefighter I & II certification required"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Officer Training:"})," Fire Officer I minimum for company officers"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Specialized Training:"})," Hazmat, rescue, EMS as applicable"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Documentation:"})," Detailed training records maintained"]}),(oe=i==null?void 0:i.fireDepartment)!=null&&oe.training&&i.fireDepartment.training<9.5?e.jsxs(t,{variant:"caption",sx:{color:"#ff8f00",display:"block",mt:1,fontWeight:"bold"},children:["📚 Need: +",Math.ceil((10-i.fireDepartment.training)*2)," additional training hours/month"]}):e.jsx(t,{variant:"caption",sx:{color:"#2e7d32",display:"block",mt:1,fontWeight:"bold"},children:"✅ Training program meets ISO standards"})]})})]}),e.jsxs(w,{children:[e.jsx(O,{children:(()=>{var c;const a=m(((c=i==null?void 0:i.fireDepartment)==null?void 0:c.distribution)||0,12.5);return e.jsx(o,{sx:{color:a.color},children:a.icon})})()}),e.jsx(E,{primary:`Distribution: ${((H=(le=i==null?void 0:i.fireDepartment)==null?void 0:le.distribution)==null?void 0:H.toFixed(1))||"0.0"} / 12.5`,secondary:e.jsxs(o,{children:[e.jsx(t,{variant:"caption",color:"text.secondary",children:e.jsx("strong",{children:"ISO Distribution Requirements:"})}),e.jsxs(t,{variant:"caption",sx:{display:"block",mt:.5},children:["• ",e.jsx("strong",{children:"Engine Coverage:"})," ≤1.5 mile road distance for engines"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Ladder Coverage:"})," ≤2.5 mile road distance for aerials"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Response Time:"})," ≤5 minutes (240 seconds) travel time"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"First Due Area:"})," ≤5 square miles per engine company"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Station Location:"})," Strategically placed for optimal coverage"]}),(de=i==null?void 0:i.fireDepartment)!=null&&de.distribution&&i.fireDepartment.distribution>=10?e.jsx(t,{variant:"caption",sx:{color:"#2e7d32",display:"block",mt:1,fontWeight:"bold"},children:"✅ Station distribution meets ISO standards"}):e.jsx(t,{variant:"caption",sx:{color:"#ff8f00",display:"block",mt:1,fontWeight:"bold"},children:"📍 Consider additional station or relocate existing station"})]})})]})]})]})})}),e.jsx(f,{size:{xs:12,md:6},children:e.jsx(te,{elevation:2,children:e.jsxs(ie,{children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ve,{sx:{color:"#2196f3",mr:1}}),e.jsx(t,{variant:"h6",children:"Water Supply"})]}),(()=>{const a=m(F,40);return e.jsx(T,{icon:a.icon,label:a.level,size:"small",sx:{bgcolor:a.color,color:"white",fontWeight:"bold"}})})()]}),e.jsxs(t,{variant:"h4",sx:{color:"#2196f3",mb:1},children:[F.toFixed(1)," / 40"]}),e.jsxs(t,{variant:"body2",sx:{color:"text.secondary",mb:2},children:[(F/40*100).toFixed(0),"% • ",m(F,40).description]}),e.jsx(K,{variant:"determinate",value:F/40*100,sx:{mb:2,"& .MuiLinearProgress-bar":{bgcolor:"#2196f3"}}}),e.jsxs(re,{dense:!0,children:[e.jsxs(w,{children:[e.jsx(O,{children:(()=>{var c;const a=m(((c=i==null?void 0:i.waterSupply)==null?void 0:c.capacity)||0,20);return e.jsx(o,{sx:{color:a.color},children:a.icon})})()}),e.jsx(E,{primary:`Capacity: ${((ke=(Ie=i==null?void 0:i.waterSupply)==null?void 0:Ie.capacity)==null?void 0:ke.toFixed(1))||"0.0"} / 20`,secondary:e.jsxs(o,{children:[e.jsx(t,{variant:"caption",color:"text.secondary",children:e.jsx("strong",{children:"ISO Water Flow Requirements:"})}),e.jsxs(t,{variant:"caption",sx:{display:"block",mt:.5},children:["• ",e.jsx("strong",{children:"Minimum Flow:"})," 250 GPM for 2 hours (Class 8B areas)"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Residential:"})," 500-750 GPM for typical single-family homes"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Commercial:"})," 1,500-3,500+ GPM for large buildings"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Pressure:"})," 20 PSI residual minimum during flow test"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Duration:"})," Maintain flow for minimum 2 hours"]}),(Fe=i==null?void 0:i.waterSupply)!=null&&Fe.capacity&&i.waterSupply.capacity>=15?e.jsx(t,{variant:"caption",sx:{color:"#2e7d32",display:"block",mt:1,fontWeight:"bold"},children:"✅ Water system meets ISO flow requirements"}):e.jsx(t,{variant:"caption",sx:{color:"#ff8f00",display:"block",mt:1,fontWeight:"bold"},children:"💧 Need: Water main upgrades or booster pump systems"})]})})]}),e.jsxs(w,{children:[e.jsx(O,{children:(()=>{var c;const a=m(((c=i==null?void 0:i.waterSupply)==null?void 0:c.distribution)||0,15);return e.jsx(o,{sx:{color:a.color},children:a.icon})})()}),e.jsx(E,{primary:`Distribution: ${((De=(Re=i==null?void 0:i.waterSupply)==null?void 0:Re.distribution)==null?void 0:De.toFixed(1))||"0.0"} / 15`,secondary:e.jsxs(o,{children:[e.jsx(t,{variant:"caption",color:"text.secondary",children:e.jsx("strong",{children:"ISO Hydrant Distribution Standards:"})}),e.jsxs(t,{variant:"caption",sx:{display:"block",mt:.5},children:["• ",e.jsx("strong",{children:"Spacing:"})," ≤1,000 ft from any point to nearest hydrant"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Commercial Areas:"})," ≤500 ft spacing between hydrants"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Residential Areas:"})," ≤800 ft spacing between hydrants"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Arterial Streets:"})," ≤600 ft maximum spacing"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Dead End Streets:"})," ≤500 ft from end of street"]}),(Pe=i==null?void 0:i.waterSupply)!=null&&Pe.distribution&&i.waterSupply.distribution>=12?e.jsx(t,{variant:"caption",sx:{color:"#2e7d32",display:"block",mt:1,fontWeight:"bold"},children:"✅ Hydrant distribution meets ISO standards"}):e.jsxs(t,{variant:"caption",sx:{color:"#ff8f00",display:"block",mt:1,fontWeight:"bold"},children:["🔧 Need: ",Math.ceil((12-(((we=i==null?void 0:i.waterSupply)==null?void 0:we.distribution)||0))*2)," additional hydrants"]})]})})]}),e.jsxs(w,{children:[e.jsx(O,{children:(()=>{var c;const a=m(((c=i==null?void 0:i.waterSupply)==null?void 0:c.alternative)||0,5);return e.jsx(o,{sx:{color:a.color},children:a.icon})})()}),e.jsx(E,{primary:`Alternative: ${((Ee=(Oe=i==null?void 0:i.waterSupply)==null?void 0:Oe.alternative)==null?void 0:Ee.toFixed(1))||"0.0"} / 5`,secondary:e.jsxs(o,{children:[e.jsx(t,{variant:"caption",color:"text.secondary",children:e.jsx("strong",{children:"ISO Alternative Water Supply Options:"})}),e.jsxs(t,{variant:"caption",sx:{display:"block",mt:.5},children:["• ",e.jsx("strong",{children:"Dry Hydrants:"}),' 6" minimum diameter, 500+ GPM capacity']}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Tanker Shuttles:"})," 1,000+ gallon capacity per tanker"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Static Sources:"})," Ponds, lakes with ≥30,000 gallons"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Mobile Supply:"})," Portable tanks, fold-a-tanks for operations"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Fill Sites:"})," Designated locations for tanker refill"]}),(Te=i==null?void 0:i.waterSupply)!=null&&Te.alternative&&i.waterSupply.alternative>=3?e.jsx(t,{variant:"caption",sx:{color:"#2e7d32",display:"block",mt:1,fontWeight:"bold"},children:"✅ Alternative water supply systems adequate"}):e.jsx(t,{variant:"caption",sx:{color:"#ff8f00",display:"block",mt:1,fontWeight:"bold"},children:"🚛 Need: Additional tankers or dry hydrant installation"})]})})]})]})]})})}),e.jsx(f,{size:{xs:12,md:6},children:e.jsx(te,{elevation:2,children:e.jsxs(ie,{children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(Se,{sx:{color:"#9c27b0",mr:1}}),e.jsx(t,{variant:"h6",children:"Emergency Communications"})]}),(()=>{const a=m(v,10);return e.jsx(T,{icon:a.icon,label:a.level,size:"small",sx:{bgcolor:a.color,color:"white",fontWeight:"bold"}})})()]}),e.jsxs(t,{variant:"h4",sx:{color:"#9c27b0",mb:1},children:[v.toFixed(1)," / 10"]}),e.jsxs(t,{variant:"body2",sx:{color:"text.secondary",mb:2},children:[(v/10*100).toFixed(0),"% • ",m(v,10).description]}),e.jsx(K,{variant:"determinate",value:v/10*100,sx:{mb:2,"& .MuiLinearProgress-bar":{bgcolor:"#9c27b0"}}}),e.jsxs(re,{dense:!0,children:[e.jsxs(w,{children:[e.jsx(O,{children:(()=>{var c;const a=m(((c=i==null?void 0:i.communications)==null?void 0:c.dispatch)||0,7);return e.jsx(o,{sx:{color:a.color},children:a.icon})})()}),e.jsx(E,{primary:`Dispatch: ${((Ae=(Me=i==null?void 0:i.communications)==null?void 0:Me.dispatch)==null?void 0:Ae.toFixed(1))||"0.0"} / 7`,secondary:e.jsxs(o,{children:[e.jsx(t,{variant:"caption",color:"text.secondary",children:e.jsx("strong",{children:"ISO 911 Dispatch Requirements:"})}),e.jsxs(t,{variant:"caption",sx:{display:"block",mt:.5},children:["• ",e.jsx("strong",{children:"24/7 Operations:"})," Full-time dispatchers on duty"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Call Processing:"})," Emergency calls answered within 15 seconds"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Dispatch Time:"})," Units dispatched within 60 seconds"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Equipment:"})," CAD system, mapping, multiple phone lines"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Training:"})," EMD certification, continuing education"]}),(Le=i==null?void 0:i.communications)!=null&&Le.dispatch&&i.communications.dispatch>=6?e.jsx(t,{variant:"caption",sx:{color:"#2e7d32",display:"block",mt:1,fontWeight:"bold"},children:"✅ Dispatch center meets ISO standards"}):e.jsx(t,{variant:"caption",sx:{color:"#ff8f00",display:"block",mt:1,fontWeight:"bold"},children:"📞 Need: Enhanced dispatch training and equipment upgrades"})]})})]}),e.jsxs(w,{children:[e.jsx(O,{children:(()=>{var c;const a=m(((c=i==null?void 0:i.communications)==null?void 0:c.alerting)||0,3);return e.jsx(o,{sx:{color:a.color},children:a.icon})})()}),e.jsx(E,{primary:`Alerting: ${((We=(Be=i==null?void 0:i.communications)==null?void 0:Be.alerting)==null?void 0:We.toFixed(1))||"0.0"} / 3`,secondary:e.jsxs(o,{children:[e.jsx(t,{variant:"caption",color:"text.secondary",children:e.jsx("strong",{children:"ISO Alerting System Requirements:"})}),e.jsxs(t,{variant:"caption",sx:{display:"block",mt:.5},children:["• ",e.jsx("strong",{children:"Radio System:"})," VHF/UHF digital trunked preferred"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Coverage:"})," 95%+ mobile and portable coverage area"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Backup Power:"})," 24-hour minimum battery backup"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Station Alerting:"})," Automated station notification systems"]}),(ze=i==null?void 0:i.communications)!=null&&ze.alerting&&i.communications.alerting>=2.5?e.jsx(t,{variant:"caption",sx:{color:"#2e7d32",display:"block",mt:1,fontWeight:"bold"},children:"✅ Communication systems meet ISO standards"}):e.jsx(t,{variant:"caption",sx:{color:"#ff8f00",display:"block",mt:1,fontWeight:"bold"},children:"📡 Need: Radio system upgrades or coverage improvements"})]})})]})]})]})})}),e.jsx(f,{size:{xs:12,md:6},children:e.jsx(te,{elevation:2,children:e.jsxs(ie,{children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(Ce,{sx:{color:"#4caf50",mr:1}}),e.jsx(t,{variant:"h6",children:"Community Risk Reduction"}),e.jsx(T,{label:"BONUS",size:"small",sx:{ml:1,bgcolor:"#4caf50",color:"white"}})]}),(()=>{const a=m(R,5.5);return e.jsx(T,{icon:a.icon,label:a.level,size:"small",sx:{bgcolor:a.color,color:"white",fontWeight:"bold"}})})()]}),e.jsxs(t,{variant:"h4",sx:{color:"#4caf50",mb:1},children:[R.toFixed(1)," / 5.5"]}),e.jsxs(t,{variant:"body2",sx:{color:"text.secondary",mb:2},children:[(R/5.5*100).toFixed(0),"% • Bonus points toward total score"]}),e.jsx(K,{variant:"determinate",value:R/5.5*100,sx:{mb:2,"& .MuiLinearProgress-bar":{bgcolor:"#4caf50"}}}),e.jsxs(re,{dense:!0,children:[e.jsxs(w,{children:[e.jsx(O,{children:(()=>{var c;const a=m(((c=i==null?void 0:i.communityRiskReduction)==null?void 0:c.prevention)||0,2.5);return e.jsx(o,{sx:{color:a.color},children:a.icon})})()}),e.jsx(E,{primary:`Prevention: ${((Ge=($e=i==null?void 0:i.communityRiskReduction)==null?void 0:$e.prevention)==null?void 0:Ge.toFixed(1))||"0.0"} / 2.5`,secondary:e.jsxs(o,{children:[e.jsx(t,{variant:"caption",color:"text.secondary",children:e.jsx("strong",{children:"ISO Fire Prevention Requirements:"})}),e.jsxs(t,{variant:"caption",sx:{display:"block",mt:.5},children:["• ",e.jsx("strong",{children:"Fire Inspector:"})," Certified fire inspector on staff"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Code Enforcement:"})," Adopt current fire codes (IFC/NFPA)"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Plan Review:"})," Review building plans for fire safety"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Inspections:"})," Annual inspections of commercial buildings"]}),(qe=i==null?void 0:i.communityRiskReduction)!=null&&qe.prevention&&i.communityRiskReduction.prevention>=2?e.jsx(t,{variant:"caption",sx:{color:"#2e7d32",display:"block",mt:1,fontWeight:"bold"},children:"✅ Fire prevention program meets ISO standards"}):e.jsx(t,{variant:"caption",sx:{color:"#ff8f00",display:"block",mt:1,fontWeight:"bold"},children:"🔍 Need: Certified fire inspector and active inspection program"})]})})]}),e.jsxs(w,{children:[e.jsx(O,{children:(()=>{var c;const a=m(((c=i==null?void 0:i.communityRiskReduction)==null?void 0:c.education)||0,2);return e.jsx(o,{sx:{color:a.color},children:a.icon})})()}),e.jsx(E,{primary:`Education: ${((He=(Ne=i==null?void 0:i.communityRiskReduction)==null?void 0:Ne.education)==null?void 0:He.toFixed(1))||"0.0"} / 2`,secondary:e.jsxs(o,{children:[e.jsx(t,{variant:"caption",color:"text.secondary",children:e.jsx("strong",{children:"ISO Public Education Requirements:"})}),e.jsxs(t,{variant:"caption",sx:{display:"block",mt:.5},children:["• ",e.jsx("strong",{children:"School Programs:"})," Fire safety education in schools K-12"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Public Outreach:"})," Community fire safety events/programs"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"High-Risk Groups:"})," Senior citizens, disabled residents"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Documentation:"})," Maintain records of education activities"]}),(_e=i==null?void 0:i.communityRiskReduction)!=null&&_e.education&&i.communityRiskReduction.education>=1.5?e.jsx(t,{variant:"caption",sx:{color:"#2e7d32",display:"block",mt:1,fontWeight:"bold"},children:"✅ Public education program meets ISO standards"}):e.jsx(t,{variant:"caption",sx:{color:"#ff8f00",display:"block",mt:1,fontWeight:"bold"},children:"🏫 Need: Expand school programs and community outreach"})]})})]}),e.jsxs(w,{children:[e.jsx(O,{children:(()=>{var c;const a=m(((c=i==null?void 0:i.communityRiskReduction)==null?void 0:c.investigation)||0,1);return e.jsx(o,{sx:{color:a.color},children:a.icon})})()}),e.jsx(E,{primary:`Investigation: ${((Ve=(Ue=i==null?void 0:i.communityRiskReduction)==null?void 0:Ue.investigation)==null?void 0:Ve.toFixed(1))||"0.0"} / 1`,secondary:e.jsxs(o,{children:[e.jsx(t,{variant:"caption",color:"text.secondary",children:e.jsx("strong",{children:"ISO Fire Investigation Requirements:"})}),e.jsxs(t,{variant:"caption",sx:{display:"block",mt:.5},children:["• ",e.jsx("strong",{children:"Trained Investigator:"})," Fire investigator certification"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Origin & Cause:"})," Determine fire cause and origin"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Documentation:"})," Detailed investigation reports"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Evidence Collection:"})," Proper evidence handling procedures"]}),(Xe=i==null?void 0:i.communityRiskReduction)!=null&&Xe.investigation&&i.communityRiskReduction.investigation>=.8?e.jsx(t,{variant:"caption",sx:{color:"#2e7d32",display:"block",mt:1,fontWeight:"bold"},children:"✅ Fire investigation program meets ISO standards"}):e.jsx(t,{variant:"caption",sx:{color:"#ff8f00",display:"block",mt:1,fontWeight:"bold"},children:"🔍 Need: Train certified fire investigator"})]})})]})]})]})})})]}),!i&&e.jsxs(N,{elevation:1,sx:{p:3,textAlign:"center",bgcolor:"#f5f5f5"},children:[e.jsx(t,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No Assessment Data"}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Use the sidebar to input your fire department's capabilities and generate an ISO score assessment."})]})]})},$t=({assessment:i,currentScore:s,classification:l,communityProfile:p})=>{const[d,b]=M.useState([]),[k,j]=M.useState(!1),[D,W]=M.useState(!0),[h,m]=M.useState({firefighterAnnualCost:75e3,apparatusCost:8e5,trainingProgramCost:8e3,hydrantInstallationCost:12e3,waterSystemUpgradeCost:15e5,constructionMultiplier:1}),y=(r,n)=>{m(x=>({...x,[r]:n}))},g=()=>{if(!i)return[];const r=[];return i.fireDepartment.staffing<10&&r.push({category:"Fire Department",subcategory:"Staffing",title:"Increase Minimum Staffing Levels",description:"Add firefighters to meet NFPA 1720 minimum staffing requirements for initial response",pointsGain:10-i.fireDepartment.staffing,estimatedCost:(10-i.fireDepartment.staffing)*h.firefighterAnnualCost,implementationTime:"6-12 months",priority:"HIGH",difficulty:"COMPLEX",requirements:["Budget approval from city council","Recruitment and hiring process","Training and certification programs","Additional equipment and PPE"],benefits:["Faster initial response times","Improved firefighter safety","Better emergency scene management","Enhanced public confidence"],fundingSources:["FEMA Assistance to Firefighters Grant (AFG)","FEMA Staffing for Adequate Fire and Emergency Response (SAFER)","State fire department grants","Municipal bond financing"]}),i.fireDepartment.training<10&&r.push({category:"Fire Department",subcategory:"Training",title:"Implement Structured Training Program",description:"Establish documented training program with minimum 20 hours monthly per firefighter",pointsGain:10-i.fireDepartment.training,estimatedCost:h.trainingProgramCost,implementationTime:"3-6 months",priority:"HIGH",difficulty:"MODERATE",requirements:["Training officer designation","Training facility or agreements","Record keeping system","Curriculum development"],benefits:["Improved firefighter competency","Better emergency outcomes","Reduced liability exposure","ISO credit improvement"],fundingSources:["FEMA AFG Training grants","State fire training academies","Regional training consortiums","Municipal training budgets"]}),i.fireDepartment.equipment<10&&r.push({category:"Fire Department",subcategory:"Equipment",title:"Upgrade Apparatus and Equipment",description:"Purchase NFPA 1901 compliant apparatus and maintain proper equipment inventory",pointsGain:10-i.fireDepartment.equipment,estimatedCost:h.apparatusCost,implementationTime:"12-24 months",priority:"HIGH",difficulty:"COMPLEX",requirements:["Capital improvement planning","Specifications development","Procurement process","Training on new equipment"],benefits:["Improved fire suppression capability","Enhanced equipment reliability","Better firefighter safety","Community protection upgrade"],fundingSources:["FEMA AFG Equipment grants","Municipal bonds","State equipment grants","Regional equipment sharing"]}),i.waterSupply.capacity<15&&r.push({category:"Water Supply",subcategory:"Capacity",title:"Improve Water System Capacity",description:"Upgrade water mains and pumping capacity to meet fire flow requirements",pointsGain:15-i.waterSupply.capacity,estimatedCost:h.waterSystemUpgradeCost*h.constructionMultiplier,implementationTime:"18-36 months",priority:"HIGH",difficulty:"COMPLEX",requirements:["Water system engineering study","Municipal utility coordination","Construction permits","Public works coordination"],benefits:["Increased fire suppression capability","Better residential water pressure","Enhanced commercial protection","Significant ISO improvement"],fundingSources:["EPA Drinking Water State Revolving Fund","USDA Rural Development grants","Municipal utility bonds","State infrastructure grants"]}),i.waterSupply.distribution<12&&r.push({category:"Water Supply",subcategory:"Distribution",title:"Install Additional Fire Hydrants",description:"Add hydrants to reduce spacing and improve coverage areas",pointsGain:12-i.waterSupply.distribution,estimatedCost:(12-i.waterSupply.distribution)*h.hydrantInstallationCost*h.constructionMultiplier,implementationTime:"6-12 months",priority:"MEDIUM",difficulty:"MODERATE",requirements:["Hydrant spacing analysis","Water main connections","Installation permits","Ongoing maintenance program"],benefits:["Reduced hose lay distances","Faster fire attack setup","Better neighborhood protection","Lower insurance rates for residents"],fundingSources:["Municipal capital improvements","Water utility funds","Community development grants","Special assessment districts"]}),i.communications.dispatch<6&&r.push({category:"Communications",subcategory:"Dispatch",title:"Improve Dispatch Operations",description:"Upgrade dispatch protocols, training, and equipment for faster call processing",pointsGain:6-i.communications.dispatch,estimatedCost:15e4*h.constructionMultiplier,implementationTime:"6-12 months",priority:"MEDIUM",difficulty:"MODERATE",requirements:["Dispatch training enhancement","Protocol documentation","Equipment upgrades","Quality assurance program"],benefits:["Faster emergency response","Better call processing times","Improved coordination","Enhanced public safety"],fundingSources:["FEMA Emergency Communications grants","State 911 improvement funds","Regional communications consortiums","Municipal emergency services budget"]}),i.communityRiskReduction.prevention<2&&r.push({category:"Community Risk Reduction",subcategory:"Prevention",title:"Establish Fire Prevention Program",description:"Implement code enforcement and fire prevention inspection program",pointsGain:2-i.communityRiskReduction.prevention,estimatedCost:85e3*h.constructionMultiplier,implementationTime:"6-12 months",priority:"LOW",difficulty:"MODERATE",requirements:["Fire prevention officer training","Code adoption and enforcement","Inspection scheduling system","Public education materials"],benefits:["Reduced fire incidents","Better building code compliance","Enhanced community safety","Bonus ISO points"],fundingSources:["FEMA Fire Prevention grants","Municipal code enforcement budget","State fire prevention programs","Community foundation grants"]}),r.sort((n,x)=>{const I={HIGH:3,MEDIUM:2,LOW:1},B=I[n.priority],z=I[x.priority];if(B!==z)return z-B;const P=n.pointsGain/n.estimatedCost;return x.pointsGain/x.estimatedCost-P})},F=r=>{const x=r*.07,I=p.population*.4*p.avgHomePremium*x,B=p.commercialPremiums*x;return I+B},v=r=>{switch(r){case"HIGH":return"#d32f2f";case"MEDIUM":return"#ff8f00";case"LOW":return"#2e7d32";default:return"#757575"}},R=r=>{switch(r){case"Fire Department":return e.jsx(be,{});case"Water Supply":return e.jsx(ve,{});case"Communications":return e.jsx(Se,{});case"Community Risk Reduction":return e.jsx(Ce,{});default:return e.jsx(ye,{})}},u=r=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(r),S=g();return i?e.jsxs(o,{sx:{p:3},children:[e.jsxs(o,{sx:{mb:3},children:[e.jsx(t,{variant:"h4",gutterBottom:!0,children:"ISO Improvement Planner"}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Strategic recommendations to improve your ISO classification with cost-benefit analysis"})]}),e.jsx(N,{sx:{p:3,mb:3},children:e.jsxs(f,{container:!0,spacing:3,children:[e.jsx(f,{size:{xs:12,md:4},children:e.jsxs(o,{sx:{textAlign:"center"},children:[e.jsx(t,{variant:"h6",color:"text.secondary",children:"Current Score"}),e.jsx(t,{variant:"h3",color:"primary",children:s.toFixed(1)}),e.jsx(t,{variant:"body2",children:"out of 105.5 points"})]})}),e.jsx(f,{size:{xs:12,md:4},children:e.jsxs(o,{sx:{textAlign:"center"},children:[e.jsx(t,{variant:"h6",color:"text.secondary",children:"Current Classification"}),e.jsxs(t,{variant:"h3",color:"primary",children:["Class ",l]}),e.jsx(t,{variant:"body2",children:"ISO rating"})]})}),e.jsx(f,{size:{xs:12,md:4},children:e.jsxs(o,{sx:{textAlign:"center"},children:[e.jsx(t,{variant:"h6",color:"text.secondary",children:"Improvement Opportunities"}),e.jsx(t,{variant:"h3",color:"secondary",children:S.length}),e.jsx(t,{variant:"body2",children:"recommendations available"})]})})]})}),e.jsxs(Y,{sx:{mb:3},expanded:D,onChange:()=>W(!D),children:[e.jsx(J,{expandIcon:e.jsx(Z,{}),children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(Pt,{color:"primary"}),e.jsxs(o,{children:[e.jsx(t,{variant:"h6",children:"Customize Cost Parameters"}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Adjust costs based on your regional market conditions and department specifications"})]})]})}),e.jsxs(ee,{children:[e.jsxs(f,{container:!0,spacing:4,children:[e.jsxs(f,{size:{xs:12,md:6},children:[e.jsxs(U,{fullWidth:!0,sx:{mb:3},children:[e.jsxs(V,{children:["Firefighter Annual Cost (salary + benefits): ",u(h.firefighterAnnualCost)]}),e.jsx(C,{value:h.firefighterAnnualCost,onChange:(r,n)=>y("firefighterAnnualCost",n),min:4e4,max:12e4,step:5e3,valueLabelDisplay:"auto",valueLabelFormat:u,marks:[{value:4e4,label:"$40k"},{value:75e3,label:"$75k"},{value:12e4,label:"$120k"}]}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Rural departments: $40-60k | Suburban: $60-85k | Urban/High COL: $85-120k"})]}),e.jsxs(U,{fullWidth:!0,sx:{mb:3},children:[e.jsxs(V,{children:["Fire Apparatus Cost (per unit): ",u(h.apparatusCost)]}),e.jsx(C,{value:h.apparatusCost,onChange:(r,n)=>y("apparatusCost",n),min:2e5,max:3e6,step:5e4,valueLabelDisplay:"auto",valueLabelFormat:u,marks:[{value:2e5,label:"$200k"},{value:8e5,label:"$800k"},{value:15e5,label:"$1.5M"},{value:27e5,label:"$2.7M"},{value:3e6,label:"$3M"}]}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Engine: $200-600k | Pumper: $400-800k | Ladder: $750k-2.7M | Specialty: $1M-3M (cost per apparatus - departments typically need multiple units)"})]}),e.jsxs(U,{fullWidth:!0,sx:{mb:3},children:[e.jsxs(V,{children:["Training Program Implementation: ",u(h.trainingProgramCost)]}),e.jsx(C,{value:h.trainingProgramCost,onChange:(r,n)=>y("trainingProgramCost",n),min:2e3,max:2e4,step:1e3,valueLabelDisplay:"auto",valueLabelFormat:u,marks:[{value:2e3,label:"$2k"},{value:8e3,label:"$8k"},{value:2e4,label:"$20k"}]}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Basic program: $2-5k | Comprehensive: $8-15k | Advanced multi-discipline: $15-20k"})]})]}),e.jsxs(f,{size:{xs:12,md:6},children:[e.jsxs(U,{fullWidth:!0,sx:{mb:3},children:[e.jsxs(V,{children:["Hydrant Installation Cost: ",u(h.hydrantInstallationCost)]}),e.jsx(C,{value:h.hydrantInstallationCost,onChange:(r,n)=>y("hydrantInstallationCost",n),min:6e3,max:25e3,step:1e3,valueLabelDisplay:"auto",valueLabelFormat:u,marks:[{value:6e3,label:"$6k"},{value:12e3,label:"$12k"},{value:25e3,label:"$25k"}]}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Easy access: $6-10k | Standard: $10-15k | Difficult terrain/deep lines: $15-25k"})]}),e.jsxs(U,{fullWidth:!0,sx:{mb:3},children:[e.jsxs(V,{children:["Water System Upgrade: ",u(h.waterSystemUpgradeCost)]}),e.jsx(C,{value:h.waterSystemUpgradeCost,onChange:(r,n)=>y("waterSystemUpgradeCost",n),min:8e5,max:5e6,step:1e5,valueLabelDisplay:"auto",valueLabelFormat:r=>`$${(r/1e6).toFixed(1)}M`,marks:[{value:8e5,label:"$0.8M"},{value:15e5,label:"$1.5M"},{value:5e6,label:"$5M"}]}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Minor upgrades: $0.8-1.2M | Major infrastructure: $1.5-3M | Complete overhaul: $3-5M"})]}),e.jsxs(U,{fullWidth:!0,sx:{mb:3},children:[e.jsxs(V,{children:["Regional Cost Multiplier: ",h.constructionMultiplier.toFixed(1),"x"]}),e.jsx(C,{value:h.constructionMultiplier,onChange:(r,n)=>y("constructionMultiplier",n),min:.7,max:1.8,step:.1,valueLabelDisplay:"auto",marks:[{value:.7,label:"0.7x"},{value:1,label:"1.0x"},{value:1.5,label:"1.5x"},{value:1.8,label:"1.8x"}]}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Rural/Low COL: 0.7-0.9x | National average: 1.0x | High COL areas: 1.2-1.8x"})]})]})]}),e.jsx(me,{severity:"info",sx:{mt:2},children:e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Regional Examples:"})," Rural Alabama (0.7x), National Average (1.0x), San Francisco Bay Area (1.6x), Manhattan (1.8x). Adjust based on local contractor quotes and labor market conditions."]})})]})]}),e.jsxs(t,{variant:"h5",gutterBottom:!0,sx:{mt:4,mb:2},children:["Improvement Recommendations",e.jsx(t,{variant:"body2",color:"text.secondary",component:"span",sx:{ml:2},children:"(Updated with your cost parameters)"})]}),S.map((r,n)=>e.jsxs(Y,{sx:{mb:2},children:[e.jsx(J,{expandIcon:e.jsx(Z,{}),children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",width:"100%"},children:[e.jsx(o,{sx:{mr:2},children:R(r.category)}),e.jsxs(o,{sx:{flexGrow:1},children:[e.jsx(t,{variant:"h6",children:r.title}),e.jsxs(o,{sx:{display:"flex",gap:1,mt:1},children:[e.jsx(T,{label:r.priority,size:"small",sx:{backgroundColor:v(r.priority),color:"white"}}),e.jsx(T,{label:`+${r.pointsGain} points`,size:"small",color:"primary"}),e.jsx(T,{label:u(r.estimatedCost),size:"small",variant:"outlined"})]})]})]})}),e.jsx(ee,{children:e.jsxs(f,{container:!0,spacing:3,children:[e.jsxs(f,{size:{xs:12,md:8},children:[e.jsx(t,{variant:"body1",paragraph:!0,children:r.description}),e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Requirements"}),e.jsx(re,{dense:!0,children:r.requirements.map((x,I)=>e.jsxs(w,{children:[e.jsx(O,{children:e.jsx(Q,{fontSize:"small"})}),e.jsx(E,{primary:x})]},I))}),e.jsx(t,{variant:"h6",gutterBottom:!0,sx:{mt:2},children:"Benefits"}),e.jsx(re,{dense:!0,children:r.benefits.map((x,I)=>e.jsxs(w,{children:[e.jsx(O,{children:e.jsx(ye,{fontSize:"small",color:"primary"})}),e.jsx(E,{primary:x})]},I))})]}),e.jsx(f,{size:{xs:12,md:4},children:e.jsx(te,{variant:"outlined",children:e.jsxs(ie,{children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Project Details"}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(At,{sx:{mr:1}}),e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Cost:"})," ",u(r.estimatedCost)]})]}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(at,{sx:{mr:1}}),e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Timeline:"})," ",r.implementationTime]})]}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(Bt,{sx:{mr:1}}),e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Difficulty:"})," ",r.difficulty]})]}),e.jsx(t,{variant:"subtitle2",gutterBottom:!0,children:"Funding Sources"}),r.fundingSources.map((x,I)=>e.jsx(T,{label:x,size:"small",variant:"outlined",sx:{mr:.5,mb:.5}},I))]})})})]})})]},n)),e.jsx(o,{sx:{mt:4,textAlign:"center"},children:e.jsxs(ne,{variant:"contained",color:"secondary",size:"large",startIcon:e.jsx(st,{}),onClick:()=>j(!k),children:[k?"Hide":"Show"," Cost-Benefit Analysis"]})}),k&&e.jsxs(N,{sx:{p:3,mt:3},children:[e.jsx(t,{variant:"h5",gutterBottom:!0,children:"Community Insurance Savings Analysis"}),e.jsx(me,{severity:"info",sx:{mb:3},children:e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Cost-Benefit Analysis Disclaimer:"})," ISO classification improvements typically reduce property insurance premiums by 3-10% per class improvement (industry-validated). Cost estimates are based on national averages and should be refined with local contractor quotes. Actual savings vary by insurance company - some insurers don't use ISO ratings."]})}),e.jsxs(f,{container:!0,spacing:3,children:[e.jsxs(f,{size:{xs:12,md:6},children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Implementation Costs"}),e.jsx(ct,{children:e.jsxs(lt,{size:"small",children:[e.jsx(dt,{children:e.jsxs(je,{children:[e.jsx(X,{children:"Category"}),e.jsx(X,{align:"right",children:"Estimated Cost"})]})}),e.jsxs(pt,{children:[S.slice(0,5).map((r,n)=>e.jsxs(je,{children:[e.jsx(X,{children:r.title}),e.jsx(X,{align:"right",children:u(r.estimatedCost)})]},n)),e.jsxs(je,{children:[e.jsx(X,{children:e.jsx("strong",{children:"Total Estimated Cost"})}),e.jsx(X,{align:"right",children:e.jsx("strong",{children:u(S.reduce((r,n)=>r+n.estimatedCost,0))})})]})]})]})})]}),e.jsxs(f,{size:{xs:12,md:6},children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Projected Benefits"}),e.jsxs(o,{sx:{mb:2},children:[e.jsxs(t,{variant:"body2",color:"text.secondary",children:["Current Classification: Class ",l]}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:["Projected Classification: Class ",Math.max(1,l-2)]}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:["Classification Improvement: ",Math.min(2,l-1)," classes"]})]}),e.jsx(te,{variant:"outlined",children:e.jsxs(ie,{children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(xt,{sx:{mr:1,color:"primary.main"}}),e.jsx(t,{variant:"h6",children:"Annual Community Savings"})]}),e.jsx(t,{variant:"h4",color:"primary",gutterBottom:!0,children:u(F(Math.min(2,l-1)))}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:["Based on ",p.population.toLocaleString()," residents and average premiums"]}),e.jsx(ut,{sx:{my:2}}),e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Payback Period:"})," ",(S.reduce((r,n)=>r+n.estimatedCost,0)/F(Math.min(2,l-1))).toFixed(1)," years"]})]})})]})]})]})]}):e.jsx(o,{sx:{p:3,textAlign:"center"},children:e.jsx(t,{variant:"h6",color:"text.secondary",children:"Complete your ISO assessment to see improvement recommendations"})})};let Gt=class{constructor(s,l){ae(this,"pdf");ae(this,"config");ae(this,"data");ae(this,"yPosition",20);this.pdf=new ht("portrait","mm","a4"),this.config=s,this.data=l,console.log("📋 PDF DEBUG: autoTable import:",typeof ue),typeof ue=="function"?(this.pdf.autoTable=ue.bind(null,this.pdf),console.log("📋 PDF DEBUG: ✅ autoTable attached successfully")):console.error("📋 PDF DEBUG: ❌ autoTable is not a function:",ue)}generateReport(){return new Promise((s,l)=>{try{console.log("🚀 GENERATING ISO CREDIT CALCULATOR REPORT"),this.addHeader(),this.addExecutiveSummary(),this.addISOScoreBreakdown(),this.addComplianceAnalysis(),this.addRecommendations();const p=new Blob([this.pdf.output("blob")],{type:"application/pdf"});console.log("✅ ISO PDF REPORT GENERATED SUCCESSFULLY"),s(p)}catch(p){console.error("❌ ISO PDF GENERATION ERROR:",p),l(p)}})}addHeader(){try{if(this.config.logoDataUrl)try{this.pdf.addImage(this.config.logoDataUrl,"PNG",15,15,25,25)}catch(s){console.warn("Could not add department logo:",s)}this.pdf.setFontSize(20),this.pdf.setFont("helvetica","bold"),this.pdf.text("ISO Fire Suppression Rating Report",50,25),this.pdf.setFontSize(14),this.pdf.setFont("helvetica","normal"),this.pdf.text(this.config.departmentName,50,32),this.pdf.text(`Fire Chief: ${this.config.chiefName}`,50,38),this.pdf.text(`Report Date: ${this.config.reportDate}`,50,44),this.pdf.setLineWidth(.5),this.pdf.line(15,50,195,50),this.yPosition=60}catch(s){console.error("Error adding header:",s),this.yPosition=60}}addExecutiveSummary(){try{this.pdf.setFontSize(16),this.pdf.setFont("helvetica","bold"),this.pdf.text("Executive Summary",15,this.yPosition),this.yPosition+=10,this.pdf.setFontSize(12),this.pdf.setFont("helvetica","normal"),[`Current ISO Classification: Class ${this.data.classification}`,`Total Score: ${this.data.currentScore.toFixed(1)} out of 105.5 points`,`Overall Performance: ${this.getPerformanceLevel()}`,"","This report provides a comprehensive analysis of your fire department's","ISO Fire Suppression Rating Schedule (FSRS) compliance and identifies","specific opportunities for classification improvement."].forEach(l=>{this.pdf.text(l,15,this.yPosition),this.yPosition+=6}),this.yPosition+=10}catch(s){console.error("Error adding executive summary:",s),this.yPosition+=50}}addISOScoreBreakdown(){try{this.pdf.setFontSize(16),this.pdf.setFont("helvetica","bold"),this.pdf.text("ISO Score Breakdown",15,this.yPosition),this.yPosition+=10;const s=[["Fire Department Operations","50.0",this.getTotalFireDeptScore().toFixed(1),this.getComplianceStatus(this.getTotalFireDeptScore(),50)],["Water Supply","40.0",this.getTotalWaterSupplyScore().toFixed(1),this.getComplianceStatus(this.getTotalWaterSupplyScore(),40)],["Emergency Communications","10.0",this.getTotalCommunicationsScore().toFixed(1),this.getComplianceStatus(this.getTotalCommunicationsScore(),10)],["Community Risk Reduction","5.5",this.getTotalCRRScore().toFixed(1),this.getComplianceStatus(this.getTotalCRRScore(),5.5)],["","","",""],["TOTAL SCORE","105.5",this.data.currentScore.toFixed(1),`Class ${this.data.classification}`]];this.pdf.autoTable?(this.pdf.autoTable({startY:this.yPosition,head:[["Category","Max Points","Current Score","Status"]],body:s,styles:{fontSize:10,cellPadding:3},headStyles:{fillColor:[41,128,185],textColor:255,fontStyle:"bold"},columnStyles:{0:{cellWidth:80},1:{cellWidth:30,halign:"center"},2:{cellWidth:30,halign:"center"},3:{cellWidth:40,halign:"center"}},didParseCell:l=>{l.row.index===s.length-1&&(l.cell.styles.fillColor=[241,196,15],l.cell.styles.fontStyle="bold")}}),this.yPosition=this.pdf.lastAutoTable.finalY+15):(console.warn("AutoTable not available, using text fallback"),this.addTextFallbackTable("ISO Score Breakdown",s))}catch(s){console.error("Could not create ISO score breakdown table:",s),this.addTextFallbackTable("ISO Score Breakdown",[])}}addComplianceAnalysis(){try{this.pdf.setFontSize(16),this.pdf.setFont("helvetica","bold"),this.pdf.text("Compliance Analysis",15,this.yPosition),this.yPosition+=10,this.pdf.setFontSize(12),this.pdf.setFont("helvetica","normal"),this.generateComplianceAnalysis().forEach(l=>{this.pdf.text(l,15,this.yPosition),this.yPosition+=6}),this.yPosition+=10}catch(s){console.error("Error adding compliance analysis:",s),this.yPosition+=30}}addRecommendations(){try{this.pdf.setFontSize(16),this.pdf.setFont("helvetica","bold"),this.pdf.text("Improvement Recommendations",15,this.yPosition),this.yPosition+=10,this.pdf.setFontSize(12),this.pdf.setFont("helvetica","normal"),this.generateRecommendations().forEach(l=>{this.pdf.text(`• ${l}`,20,this.yPosition),this.yPosition+=6})}catch(s){console.error("Error adding recommendations:",s),this.yPosition+=30}}addTextFallbackTable(s,l){this.pdf.setFontSize(12),this.pdf.setFont("helvetica","bold"),this.pdf.text(s,15,this.yPosition),this.yPosition+=10,this.pdf.setFont("helvetica","normal"),this.pdf.text("(Professional table format not available - data summary)",15,this.yPosition),this.yPosition+=10,l.forEach(p=>{p.length>0&&(this.pdf.text(p.join(" | "),20,this.yPosition),this.yPosition+=5)}),this.yPosition+=10}getTotalFireDeptScore(){return this.data.assessment.fireDepartment.staffing+this.data.assessment.fireDepartment.equipment+this.data.assessment.fireDepartment.training+this.data.assessment.fireDepartment.distribution}getTotalWaterSupplyScore(){return this.data.assessment.waterSupply.capacity+this.data.assessment.waterSupply.distribution+this.data.assessment.waterSupply.alternative}getTotalCommunicationsScore(){return this.data.assessment.communications.dispatch+this.data.assessment.communications.alerting}getTotalCRRScore(){return this.data.assessment.communityRiskReduction.prevention+this.data.assessment.communityRiskReduction.education+this.data.assessment.communityRiskReduction.investigation}getPerformanceLevel(){const s=this.data.currentScore/105.5*100;return s>=90?"Excellent (Class 1-2)":s>=70?"Good (Class 3-4)":s>=50?"Fair (Class 5-6)":"Needs Improvement (Class 7-10)"}getComplianceStatus(s,l){const p=s/l*100;return p>=90?"Excellent":p>=70?"Good":p>=50?"Fair":"Poor"}generateComplianceAnalysis(){const s=[];s.push(`Your department achieved ${this.data.currentScore.toFixed(1)} out of 105.5 possible points,`),s.push(`resulting in a Class ${this.data.classification} ISO rating.`),s.push("");const l=this.getTotalFireDeptScore();s.push(`Fire Department Operations: ${l.toFixed(1)}/50.0 points (${(l/50*100).toFixed(1)}%)`);const p=this.getTotalWaterSupplyScore();s.push(`Water Supply: ${p.toFixed(1)}/40.0 points (${(p/40*100).toFixed(1)}%)`);const d=this.getTotalCommunicationsScore();return s.push(`Communications: ${d.toFixed(1)}/10.0 points (${(d/10*100).toFixed(1)}%)`),s}generateRecommendations(){const s=[],l=this.getTotalFireDeptScore(),p=this.getTotalWaterSupplyScore();return l<40&&s.push("Focus on fire department operations - consider staffing and equipment upgrades"),p<30&&s.push("Water supply improvements could significantly impact your ISO rating"),this.data.classification>=6&&s.push("Consider comprehensive assessment with ISO improvement consultant"),s.push("Regular training and equipment maintenance support continued compliance"),s}};const qt=({open:i,onClose:s,assessment:l,score:p,classification:d})=>{const[b,k]=M.useState(!1),[j,D]=M.useState("Fire Department"),[W,h]=M.useState("Fire Chief"),m=async()=>{console.log("🏆 Generating ISO Credit Report:",{assessment:l,score:p,classification:d}),k(!0);try{const y={template:"iso_assessment_report",departmentName:j,chiefName:W,reportDate:new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})},g={currentScore:p,classification:d,assessment:l,communityProfile:{population:25e3,avgHomePremium:1200,commercialPremiums:125e3}},v=await new Gt(y,g).generateReport(),R=URL.createObjectURL(v),u=document.createElement("a");u.href=R,u.download=`ISO_Assessment_Report_${j.replace(/\s+/g,"_")}_${new Date().toISOString().split("T")[0]}.pdf`,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(R),console.log("✅ ISO PDF Report generated successfully")}catch(y){console.error("❌ ISO PDF generation failed:",y),alert("Failed to generate PDF report. Please try again.")}finally{k(!1)}};return e.jsxs(mt,{open:i,onClose:s,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{minHeight:"60vh"}},children:[e.jsx(ft,{children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(t,{variant:"h6",children:"ISO Credit Report Generator"}),e.jsx(ne,{onClick:s,size:"small",sx:{minWidth:"auto",p:1},children:e.jsx(gt,{})})]})}),e.jsxs(jt,{children:[e.jsx(me,{severity:"success",sx:{mb:3},children:"Generate professional PDF reports for ISO assessments with customizable department information."}),e.jsxs(N,{elevation:1,sx:{p:3,mb:3},children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Department Information"}),e.jsxs(f,{container:!0,spacing:2,children:[e.jsx(f,{size:{xs:12,md:6},children:e.jsx(Qe,{fullWidth:!0,label:"Department Name",value:j,onChange:y=>D(y.target.value),variant:"outlined",placeholder:"Houston Fire Department"})}),e.jsx(f,{size:{xs:12,md:6},children:e.jsx(Qe,{fullWidth:!0,label:"Fire Chief Name",value:W,onChange:y=>h(y.target.value),variant:"outlined",placeholder:"Fire Chief John Smith"})})]})]}),e.jsxs(N,{elevation:1,sx:{p:3,mb:3},children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Report Features:"}),e.jsx(t,{component:"div",variant:"body1",children:e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"ISO Classification Analysis"})," - Current score breakdown and classification"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Category Performance"})," - Fire Department, Water Supply, Communications, CRR"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Compliance Analysis"})," - Detailed performance assessment"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Improvement Recommendations"})," - Specific areas for ISO score enhancement"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Professional Tables"})," - Structured data presentation"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Department Branding"})," - Custom department information"]})]})})]}),l&&e.jsxs(N,{elevation:1,sx:{p:3},children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Current Assessment Summary:"}),e.jsxs(t,{variant:"body1",children:[e.jsx("strong",{children:"ISO Classification:"})," Class ",d,e.jsx("br",{}),e.jsx("strong",{children:"Total Score:"})," ",p.toFixed(1)," / 105.5 points",e.jsx("br",{}),e.jsx("strong",{children:"Score Percentage:"})," ",(p/105.5*100).toFixed(1),"%"]})]})]}),e.jsxs(yt,{sx:{p:3},children:[e.jsx(ne,{onClick:s,variant:"outlined",children:"Close"}),e.jsx(ne,{onClick:m,variant:"contained",startIcon:b?e.jsx(bt,{size:20,color:"inherit"}):e.jsx(Ze,{}),disabled:!l||b,children:b?"Generating...":"Generate PDF Report"})]})]})},he=320,Yt=({initialAssessment:i,onAssessmentComplete:s,mode:l="assessment"})=>{const p=vt(),d=Et(p.breakpoints.down("md")),[b,k]=$.useState(!d),[j,D]=$.useState(!1),[W,h]=$.useState(!1),[m,y]=$.useState(0),[g,F]=$.useState(null),[v,R]=$.useState(0),[u,S]=$.useState(10),[r,n]=$.useState(!1),[x,I]=$.useState(null),[B]=$.useState({population:25e3,avgHomePremium:1200,commercialPremiums:5e5});M.useEffect(()=>{document.title="FireEMS ISO Credit Calculator"},[]),M.useEffect(()=>{i&&(F(i),console.log("Loading initial ISO assessment:",i))},[i]),M.useEffect(()=>{g&&s&&s(g)},[g,s]);const z=()=>{k(!b)},P=()=>{D(!j),j?document.fullscreenElement&&document.exitFullscreen&&document.exitFullscreen():document.documentElement.requestFullscreen&&document.documentElement.requestFullscreen()},A=()=>{const H={assessment:g,score:v,classification:u,timestamp:new Date};localStorage.setItem("iso_credit_calculator_autosave",JSON.stringify(H)),console.log("ISO assessment data saved")},ce=()=>{console.log("🏆 ISO EXPORT BUTTON CLICKED - Starting export process");const H=g!==null;if(console.log("🏆 ISO EXPORT DATA CHECK:",{hasAssessment:H,currentScore:v,classification:u}),!H){console.log("🏆 NO ISO DATA - Showing alert"),alert("No ISO assessment data to export. Please complete the assessment first.");return}console.log("🏆 OPENING ISO REPORT GENERATOR - Setting state"),h(!0),console.log("📊 Opening professional ISO credit report generator:",{score:v,classification:u,hasAssessment:!!g,showReportGenerator:!0})},oe=()=>{I(null)},le=(H,de)=>{y(de)};return e.jsx(Rt,{children:e.jsxs(o,{sx:{display:"flex",height:"100vh",overflow:"hidden",bgcolor:"background.default",position:j?"fixed":"relative",top:j?0:"auto",left:j?0:"auto",right:j?0:"auto",bottom:j?0:"auto",zIndex:j?1300:"auto"},role:"main","aria-label":"ISO Credit Calculator Tool",children:[!j&&e.jsx(Dt,{position:"fixed",sx:{zIndex:p.zIndex.drawer+1,bgcolor:"primary.main"},children:e.jsxs(St,{children:[e.jsx(xe,{color:"inherit","aria-label":"toggle sidebar",onClick:z,edge:"start",sx:{mr:2},children:e.jsx(wt,{})}),e.jsx(Je,{sx:{mr:1}}),e.jsxs(t,{variant:"h6",noWrap:!0,component:"div",sx:{flexGrow:1},children:["ISO Credit Calculator",l==="planning"&&" - Planning Mode",l==="presentation"&&" - Presentation Mode"]}),e.jsxs(o,{sx:{display:"flex",gap:1},children:[e.jsx(xe,{color:"inherit",onClick:A,title:"Save Assessment",children:e.jsx(Ct,{})}),e.jsx(xe,{color:"inherit",onClick:ce,title:"Generate Professional ISO Report",disabled:!g,children:e.jsx(Ze,{})}),e.jsx(xe,{color:"inherit",onClick:P,title:"Toggle Fullscreen",children:j?e.jsx(Tt,{}):e.jsx(Mt,{})})]})]})}),e.jsx(Ot,{variant:d?"temporary":"persistent",anchor:"left",open:b,onClose:z,sx:{width:he,flexShrink:0,"& .MuiDrawer-paper":{width:he,boxSizing:"border-box",marginTop:j?0:"56px",height:j?"100vh":"calc(100vh - 56px)",borderRight:`1px solid ${p.palette.divider}`}},ModalProps:{keepMounted:!0,disablePortal:!1,hideBackdrop:!d,disableAutoFocus:!0,disableEnforceFocus:!0,disableRestoreFocus:!0},PaperProps:{"aria-hidden":!1,role:"complementary","aria-label":"ISO Credit Calculator Tools"},children:e.jsx(Wt,{mode:l,onAssessmentChange:F,onScoreChange:R,onClassificationChange:S})}),e.jsxs(o,{component:"main",sx:{flexGrow:1,position:"relative",marginLeft:!d&&b?`${he}px`:0,width:!d&&b?`calc(100% - ${he}px)`:"100%",marginTop:j?0:"56px",height:j?"100vh":"calc(100vh - 56px)",transition:p.transitions.create(["margin","width"],{easing:p.transitions.easing.sharp,duration:p.transitions.duration.leavingScreen}),display:"flex",flexDirection:"column"},children:[e.jsx(N,{elevation:1,sx:{borderRadius:0,borderBottom:`1px solid ${p.palette.divider}`},children:e.jsxs(It,{value:m,onChange:le,"aria-label":"ISO Credit Calculator Tabs",sx:{px:2},children:[e.jsx(Ye,{icon:e.jsx(kt,{}),label:"Score Calculator",id:"iso-tab-0","aria-controls":"iso-tabpanel-0"}),e.jsx(Ye,{icon:e.jsx(ye,{}),label:"Improvement Planner",id:"iso-tab-1","aria-controls":"iso-tabpanel-1",disabled:!g})]})}),e.jsxs(o,{sx:{flexGrow:1,overflow:"auto",position:"relative"},children:[m===0&&e.jsx(N,{elevation:0,sx:{height:"100%",width:"100%",borderRadius:0,overflow:"auto",position:"relative",minHeight:"500px",display:"flex",flexDirection:"column"},role:"tabpanel",id:"iso-tabpanel-0","aria-labelledby":"iso-tab-0",children:e.jsx(zt,{assessment:g,currentScore:v,classification:u,sidebarOpen:b,isMobile:d})}),m===1&&e.jsx(o,{sx:{height:"100%",overflow:"auto"},role:"tabpanel",id:"iso-tabpanel-1","aria-labelledby":"iso-tab-1",children:e.jsx($t,{assessment:g,currentScore:v,classification:u,communityProfile:B})})]}),r&&e.jsx(o,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,bgcolor:"rgba(255, 255, 255, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsx(t,{variant:"h6",children:"Calculating ISO Score..."})})]}),e.jsx(Ft,{open:!!x,autoHideDuration:6e3,onClose:oe,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(me,{onClose:oe,severity:"error",sx:{width:"100%"},children:x})}),e.jsx(qt,{open:W,onClose:()=>h(!1),assessment:g,score:v,classification:u})]})})};export{Yt as default};
