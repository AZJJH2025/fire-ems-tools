import{a as ke,g as Oe,r as y,u as Fe,I as ot,j as h,c as he,s as j,d as z,b as ze,m as L,h as ae,e as rt,J as at,K as st}from"./index-C8osa1Dw.js";import{d as it,h as te,b as nt,g as Me,l as lt,a as pt,u as B,k as Ee,c as D}from"./Map-C6pPy_qr.js";import{b as ct,_ as dt,O as mt,R as De,S as ut}from"./jspdf.es.min-hhXuguLo.js";function ht(t){return Oe("MuiTooltip",t)}const l=ke("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]);function ft(t){return Math.round(t*1e5)/1e5}const gt=t=>{const{classes:e,disableInteractive:r,arrow:i,touch:c,placement:s}=t,d={popper:["popper",!r&&"popperInteractive",i&&"popperArrow"],tooltip:["tooltip",i&&"tooltipArrow",c&&"touch",`tooltipPlacement${z(s.split("-")[0])}`],arrow:["arrow"]};return ze(d,ht,e)},wt=j(De,{name:"MuiTooltip",slot:"Popper",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.popper,!r.disableInteractive&&e.popperInteractive,r.arrow&&e.popperArrow,!r.open&&e.popperClose]}})(L(({theme:t})=>({zIndex:(t.vars||t).zIndex.tooltip,pointerEvents:"none",variants:[{props:({ownerState:e})=>!e.disableInteractive,style:{pointerEvents:"auto"}},{props:({open:e})=>!e,style:{pointerEvents:"none"}},{props:({ownerState:e})=>e.arrow,style:{[`&[data-popper-placement*="bottom"] .${l.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${l.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${l.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}},[`&[data-popper-placement*="left"] .${l.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="right"] .${l.arrow}`]:{left:0,marginLeft:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="right"] .${l.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="left"] .${l.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="left"] .${l.arrow}`]:{left:0,marginLeft:"-0.71em"}}}]}))),yt=j("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.tooltip,r.touch&&e.touch,r.arrow&&e.tooltipArrow,e[`tooltipPlacement${z(r.placement.split("-")[0])}`]]}})(L(({theme:t})=>({backgroundColor:t.vars?t.vars.palette.Tooltip.bg:ae(t.palette.grey[700],.92),borderRadius:(t.vars||t).shape.borderRadius,color:(t.vars||t).palette.common.white,fontFamily:t.typography.fontFamily,padding:"4px 8px",fontSize:t.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:t.typography.fontWeightMedium,[`.${l.popper}[data-popper-placement*="left"] &`]:{transformOrigin:"right center"},[`.${l.popper}[data-popper-placement*="right"] &`]:{transformOrigin:"left center"},[`.${l.popper}[data-popper-placement*="top"] &`]:{transformOrigin:"center bottom",marginBottom:"14px"},[`.${l.popper}[data-popper-placement*="bottom"] &`]:{transformOrigin:"center top",marginTop:"14px"},variants:[{props:({ownerState:e})=>e.arrow,style:{position:"relative",margin:0}},{props:({ownerState:e})=>e.touch,style:{padding:"8px 16px",fontSize:t.typography.pxToRem(14),lineHeight:`${ft(16/14)}em`,fontWeight:t.typography.fontWeightRegular}},{props:({ownerState:e})=>!e.isRtl,style:{[`.${l.popper}[data-popper-placement*="left"] &`]:{marginRight:"14px"},[`.${l.popper}[data-popper-placement*="right"] &`]:{marginLeft:"14px"}}},{props:({ownerState:e})=>!e.isRtl&&e.touch,style:{[`.${l.popper}[data-popper-placement*="left"] &`]:{marginRight:"24px"},[`.${l.popper}[data-popper-placement*="right"] &`]:{marginLeft:"24px"}}},{props:({ownerState:e})=>!!e.isRtl,style:{[`.${l.popper}[data-popper-placement*="left"] &`]:{marginLeft:"14px"},[`.${l.popper}[data-popper-placement*="right"] &`]:{marginRight:"14px"}}},{props:({ownerState:e})=>!!e.isRtl&&e.touch,style:{[`.${l.popper}[data-popper-placement*="left"] &`]:{marginLeft:"24px"},[`.${l.popper}[data-popper-placement*="right"] &`]:{marginRight:"24px"}}},{props:({ownerState:e})=>e.touch,style:{[`.${l.popper}[data-popper-placement*="top"] &`]:{marginBottom:"24px"}}},{props:({ownerState:e})=>e.touch,style:{[`.${l.popper}[data-popper-placement*="bottom"] &`]:{marginTop:"24px"}}}]}))),vt=j("span",{name:"MuiTooltip",slot:"Arrow",overridesResolver:(t,e)=>e.arrow})(L(({theme:t})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:t.vars?t.vars.palette.Tooltip.bg:ae(t.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}})));let oe=!1;const Ie=new lt;let G={x:0,y:0};function re(t,e){return(r,...i)=>{e&&e(r,...i),t(r,...i)}}const At=y.forwardRef(function(e,r){const i=Fe({props:e,name:"MuiTooltip"}),{arrow:c=!1,children:s,classes:d,components:m={},componentsProps:v={},describeChild:o=!1,disableFocusListener:n=!1,disableHoverListener:u=!1,disableInteractive:g=!1,disableTouchListener:p=!1,enterDelay:f=100,enterNextDelay:T=0,enterTouchDelay:R=700,followCursor:b=!1,id:E,leaveDelay:C=0,leaveTouchDelay:P=1500,onClose:A,onOpen:K,open:se,placement:M="bottom",PopperComponent:X,PopperProps:k={},slotProps:O={},slots:Pe={},title:U,TransitionComponent:Ne,TransitionProps:Be,...fe}=i,F=y.isValidElement(s)?s:h.jsx("span",{children:s}),ge=it(),Le=ot(),[_,we]=y.useState(),[ie,je]=y.useState(null),Y=y.useRef(!1),ne=g||b,ye=te(),le=te(),J=te(),ve=te(),[Ue,Te]=ct({controlled:se,default:!1,name:"Tooltip",state:"open"});let I=Ue;const pe=nt(E),W=y.useRef(),Q=Me(()=>{W.current!==void 0&&(document.body.style.WebkitUserSelect=W.current,W.current=void 0),ve.clear()});y.useEffect(()=>Q,[Q]);const Re=a=>{Ie.clear(),oe=!0,Te(!0),K&&!I&&K(a)},Z=Me(a=>{Ie.start(800+C,()=>{oe=!1}),Te(!1),A&&I&&A(a),ye.start(ge.transitions.duration.shortest,()=>{Y.current=!1})}),q=a=>{Y.current&&a.type!=="touchstart"||(_&&_.removeAttribute("title"),le.clear(),J.clear(),f||oe&&T?le.start(oe?T:f,()=>{Re(a)}):Re(a))},ce=a=>{le.clear(),J.start(C,()=>{Z(a)})},[,be]=y.useState(!1),$e=a=>{Ee(a.target)||(be(!1),ce(a))},xe=a=>{_||we(a.currentTarget),Ee(a.target)&&(be(!0),q(a))},Se=a=>{Y.current=!0;const S=F.props;S.onTouchStart&&S.onTouchStart(a)},_e=a=>{Se(a),J.clear(),ye.clear(),Q(),W.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",ve.start(R,()=>{document.body.style.WebkitUserSelect=W.current,q(a)})},We=a=>{F.props.onTouchEnd&&F.props.onTouchEnd(a),Q(),J.start(P,()=>{Z(a)})};y.useEffect(()=>{if(!I)return;function a(S){S.key==="Escape"&&Z(S)}return document.addEventListener("keydown",a),()=>{document.removeEventListener("keydown",a)}},[Z,I]);const Ve=pt(dt(F),we,r);!U&&U!==0&&(I=!1);const de=y.useRef(),He=a=>{const S=F.props;S.onMouseMove&&S.onMouseMove(a),G={x:a.clientX,y:a.clientY},de.current&&de.current.update()},V={},me=typeof U=="string";o?(V.title=!I&&me&&!u?U:null,V["aria-describedby"]=I?pe:null):(V["aria-label"]=me?U:null,V["aria-labelledby"]=I&&!me?pe:null);const $={...V,...fe,...F.props,className:he(fe.className,F.props.className),onTouchStart:Se,ref:Ve,...b?{onMouseMove:He}:{}},H={};p||($.onTouchStart=_e,$.onTouchEnd=We),u||($.onMouseOver=re(q,$.onMouseOver),$.onMouseLeave=re(ce,$.onMouseLeave),ne||(H.onMouseOver=q,H.onMouseLeave=ce)),n||($.onFocus=re(xe,$.onFocus),$.onBlur=re($e,$.onBlur),ne||(H.onFocus=xe,H.onBlur=$e));const N={...i,isRtl:Le,arrow:c,disableInteractive:ne,placement:M,PopperComponentProp:X,touch:Y.current},x=typeof O.popper=="function"?O.popper(N):O.popper,Ge=y.useMemo(()=>{var S,Ce;let a=[{name:"arrow",enabled:!!ie,options:{element:ie,padding:4}}];return(S=k.popperOptions)!=null&&S.modifiers&&(a=a.concat(k.popperOptions.modifiers)),(Ce=x==null?void 0:x.popperOptions)!=null&&Ce.modifiers&&(a=a.concat(x.popperOptions.modifiers)),{...k.popperOptions,...x==null?void 0:x.popperOptions,modifiers:a}},[ie,k.popperOptions,x==null?void 0:x.popperOptions]),ue=gt(N),Ke=typeof O.transition=="function"?O.transition(N):O.transition,ee={slots:{popper:m.Popper,transition:m.Transition??Ne,tooltip:m.Tooltip,arrow:m.Arrow,...Pe},slotProps:{arrow:O.arrow??v.arrow,popper:{...k,...x??v.popper},tooltip:O.tooltip??v.tooltip,transition:{...Be,...Ke??v.transition}}},[Xe,Ye]=B("popper",{elementType:wt,externalForwardedProps:ee,ownerState:N,className:he(ue.popper,k==null?void 0:k.className)}),[Je,Qe]=B("transition",{elementType:mt,externalForwardedProps:ee,ownerState:N}),[Ze,qe]=B("tooltip",{elementType:yt,className:ue.tooltip,externalForwardedProps:ee,ownerState:N}),[et,tt]=B("arrow",{elementType:vt,className:ue.arrow,externalForwardedProps:ee,ownerState:N,ref:je});return h.jsxs(y.Fragment,{children:[y.cloneElement(F,$),h.jsx(Xe,{as:X??De,placement:M,anchorEl:b?{getBoundingClientRect:()=>({top:G.y,left:G.x,right:G.x,bottom:G.y,width:0,height:0})}:_,popperRef:de,open:_?I:!1,id:pe,transition:!0,...H,...Ye,popperOptions:Ge,children:({TransitionProps:a})=>h.jsx(Je,{timeout:ge.transitions.duration.shorter,...a,...Qe,children:h.jsxs(Ze,{...qe,children:[U,c?h.jsx(et,{...tt}):null]})})})]})});function Tt(t){return Oe("MuiSwitch",t)}const w=ke("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),Rt=t=>{const{classes:e,edge:r,size:i,color:c,checked:s,disabled:d}=t,m={root:["root",r&&`edge${z(r)}`,`size${z(i)}`],switchBase:["switchBase",`color${z(c)}`,s&&"checked",d&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},v=ze(m,Tt,e);return{...e,...v}},bt=j("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.root,r.edge&&e[`edge${z(r.edge)}`],e[`size${z(r.size)}`]]}})({display:"inline-flex",width:34+12*2,height:14+12*2,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"},variants:[{props:{edge:"start"},style:{marginLeft:-8}},{props:{edge:"end"},style:{marginRight:-8}},{props:{size:"small"},style:{width:40,height:24,padding:7,[`& .${w.thumb}`]:{width:16,height:16},[`& .${w.switchBase}`]:{padding:4,[`&.${w.checked}`]:{transform:"translateX(16px)"}}}}]}),$t=j(ut,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(t,e)=>{const{ownerState:r}=t;return[e.switchBase,{[`& .${w.input}`]:e.input},r.color!=="default"&&e[`color${z(r.color)}`]]}})(L(({theme:t})=>({position:"absolute",top:0,left:0,zIndex:1,color:t.vars?t.vars.palette.Switch.defaultColor:`${t.palette.mode==="light"?t.palette.common.white:t.palette.grey[300]}`,transition:t.transitions.create(["left","transform"],{duration:t.transitions.duration.shortest}),[`&.${w.checked}`]:{transform:"translateX(20px)"},[`&.${w.disabled}`]:{color:t.vars?t.vars.palette.Switch.defaultDisabledColor:`${t.palette.mode==="light"?t.palette.grey[100]:t.palette.grey[600]}`},[`&.${w.checked} + .${w.track}`]:{opacity:.5},[`&.${w.disabled} + .${w.track}`]:{opacity:t.vars?t.vars.opacity.switchTrackDisabled:`${t.palette.mode==="light"?.12:.2}`},[`& .${w.input}`]:{left:"-100%",width:"300%"}})),L(({theme:t})=>({"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:ae(t.palette.action.active,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[...Object.entries(t.palette).filter(rt(["light"])).map(([e])=>({props:{color:e},style:{[`&.${w.checked}`]:{color:(t.vars||t).palette[e].main,"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette[e].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:ae(t.palette[e].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${w.disabled}`]:{color:t.vars?t.vars.palette.Switch[`${e}DisabledColor`]:`${t.palette.mode==="light"?at(t.palette[e].main,.62):st(t.palette[e].main,.55)}`}},[`&.${w.checked} + .${w.track}`]:{backgroundColor:(t.vars||t).palette[e].main}}}))]}))),xt=j("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(t,e)=>e.track})(L(({theme:t})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:t.transitions.create(["opacity","background-color"],{duration:t.transitions.duration.shortest}),backgroundColor:t.vars?t.vars.palette.common.onBackground:`${t.palette.mode==="light"?t.palette.common.black:t.palette.common.white}`,opacity:t.vars?t.vars.opacity.switchTrack:`${t.palette.mode==="light"?.38:.3}`}))),St=j("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(t,e)=>e.thumb})(L(({theme:t})=>({boxShadow:(t.vars||t).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"}))),kt=y.forwardRef(function(e,r){const i=Fe({props:e,name:"MuiSwitch"}),{className:c,color:s="primary",edge:d=!1,size:m="medium",sx:v,slots:o={},slotProps:n={},...u}=i,g={...i,color:s,edge:d,size:m},p=Rt(g),f={slots:o,slotProps:n},[T,R]=B("root",{className:he(p.root,c),elementType:bt,externalForwardedProps:f,ownerState:g,additionalProps:{sx:v}}),[b,E]=B("thumb",{className:p.thumb,elementType:St,externalForwardedProps:f,ownerState:g}),C=h.jsx(b,{...E}),[P,A]=B("track",{className:p.track,elementType:xt,externalForwardedProps:f,ownerState:g});return h.jsxs(T,{...R,children:[h.jsx($t,{type:"checkbox",icon:C,checkedIcon:C,ref:r,ownerState:g,...u,classes:{...p,root:p.switchBase},slots:{...o.switchBase&&{root:o.switchBase},...o.input&&{input:o.input}},slotProps:{...n.switchBase&&{root:typeof n.switchBase=="function"?n.switchBase(g):n.switchBase},...n.input&&{input:typeof n.input=="function"?n.input(g):n.input}}}),h.jsx(P,{...A})]})}),Ot=D(h.jsx("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M14 13v4h-4v-4H7l5-5 5 5z"})),Ft=D(h.jsx("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"})),zt=D(h.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"})),Dt=D(h.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})),Pt=D(h.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"})),Nt=D(h.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"})),Bt=D(h.jsx("path",{d:"m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"})),Lt=D(h.jsx("path",{d:"M2.5 4v3h5v12h3V7h5V4zm19 5h-9v3h3v7h3v-7h3z"})),Ae={fire:{category:"fire",color:"#dc2626",icon:"fire"},"structure fire":{category:"fire",color:"#dc2626",icon:"fire"},"vehicle fire":{category:"fire",color:"#ff6600",icon:"fire"},wildfire:{category:"fire",color:"#ff4444",icon:"fire"},medical:{category:"medical",color:"#22c55e",icon:"medical"},ems:{category:"medical",color:"#22c55e",icon:"medical"},cardiac:{category:"medical",color:"#ef4444",icon:"medical"},respiratory:{category:"medical",color:"#3b82f6",icon:"medical"},rescue:{category:"rescue",color:"#f59e0b",icon:"rescue"},"vehicle accident":{category:"rescue",color:"#f59e0b",icon:"rescue"},hazmat:{category:"hazmat",color:"#8b5cf6",icon:"hazmat"},alarm:{category:"alarm",color:"#6b7280",icon:"alarm"},"false alarm":{category:"alarm",color:"#9ca3af",icon:"alarm"}},Ct=(t,e)=>{const r={fire:`data:image/svg+xml,%3Csvg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"%3E%3Ccircle cx="12" cy="12" r="10" fill="${encodeURIComponent(e)}"/%3E%3Ctext x="50%25" y="50%25" dominant-baseline="middle" text-anchor="middle" font-family="Arial" font-size="8px" fill="white" font-weight="bold"%3EF%3C/text%3E%3C/svg%3E`,medical:`data:image/svg+xml,%3Csvg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"%3E%3Ccircle cx="12" cy="12" r="10" fill="${encodeURIComponent(e)}"/%3E%3Cpath d="M11 8h2v8h-2v-8zM8 11h8v2H8v-2z" fill="white"/%3E%3C/svg%3E`,rescue:`data:image/svg+xml,%3Csvg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"%3E%3Ccircle cx="12" cy="12" r="10" fill="${encodeURIComponent(e)}"/%3E%3Ctext x="50%25" y="50%25" dominant-baseline="middle" text-anchor="middle" font-family="Arial" font-size="8px" fill="white" font-weight="bold"%3ER%3C/text%3E%3C/svg%3E`,hazmat:`data:image/svg+xml,%3Csvg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"%3E%3Ccircle cx="12" cy="12" r="10" fill="${encodeURIComponent(e)}"/%3E%3Ctext x="50%25" y="50%25" dominant-baseline="middle" text-anchor="middle" font-family="Arial" font-size="8px" fill="white" font-weight="bold"%3EH%3C/text%3E%3C/svg%3E`,alarm:`data:image/svg+xml,%3Csvg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"%3E%3Ccircle cx="12" cy="12" r="10" fill="${encodeURIComponent(e)}"/%3E%3Ctext x="50%25" y="50%25" dominant-baseline="middle" text-anchor="middle" font-family="Arial" font-size="8px" fill="white" font-weight="bold"%3EA%3C/text%3E%3C/svg%3E`};return r[t]||r.fire};class jt{static transformToFireMapPro(e,r={toolId:"fire-map-pro"}){const i=[],c=[],s=[];let d=0,m=0;e.forEach((o,n)=>{try{const u=o.incident_id||o["Incident ID"]||o.incidentId||o.id,g=parseFloat(o.latitude||o.Latitude||o.lat),p=parseFloat(o.longitude||o.Longitude||o.lng||o.lon);if(!u){i.push(`Row ${n+1}: Missing Incident ID`),m++;return}if(isNaN(g)||isNaN(p)){i.push(`Row ${n+1}: Invalid or missing coordinates`),m++;return}const f=o.incident_type||o["Incident Type"]||o.incidentType||o.type||"Unknown",T=o.incident_date||o["Incident Date"]||o.incidentDate||o.date,R=o.incident_time||o["Incident Time"]||o.incidentTime||o.time,b=o.address||o.Address||"",E=o.city||o.City||"",C=o.state||o.State||"",P=o.priority||o.Priority||"",A=o.responding_unit||o.Station||o.station||"",K=o.response_category||o["Response Category"]||o.responseCategory||"",se=(typeof f=="string"?f:String(f||"")).toLowerCase(),M=Ae[se]||Ae.fire,X={id:`incident-${u}`,type:"marker",title:`${f} - ${u}`,description:`${f} incident${b?` at ${b}`:""}${E?`, ${E}`:""}${C?`, ${C}`:""}`,coordinates:[p,g],style:{color:M.color,icon:{id:`${M.icon}-icon`,name:M.icon,category:M.category,url:Ct(M.icon,M.color),size:"medium",color:M.color,anchor:[12,24],popupAnchor:[0,-24]}},properties:{incidentId:u,incidentType:f,incidentDate:T,incidentTime:R,address:b,city:E,state:C,priority:P,station:A,responseCategory:K,coordinates:{latitude:g,longitude:p},fullAddress:[b,E,C].filter(Boolean).join(", "),dateTime:T&&R?`${T} ${R}`:T||"",displayText:`${f}${P?` (${P})`:""}${A?` - Station ${A}`:""}`},layerId:"imported-incidents",created:new Date,modified:new Date};s.push(X),d++,T||c.push(`Row ${n+1}: Missing incident date`),!b&&!E&&c.push(`Row ${n+1}: Missing address information`)}catch(u){i.push(`Row ${n+1}: ${u instanceof Error?u.message:"Unknown error"}`),m++}});const v={id:"imported-incidents",name:`Imported Incidents (${s.length})`,visible:!0,opacity:1,zIndex:1e3,type:"feature",features:s,style:{defaultStyle:{color:"#dc2626",fillColor:"#dc2626",fillOpacity:.7,weight:2,opacity:1}},metadata:{description:`Incident data imported from Data Formatter - ${s.length} incidents`,source:"Data Formatter",created:new Date,featureCount:s.length,bounds:s.length>0?this.calculateBounds(s):void 0}};return{success:i.length===0||d>0,data:{layer:v,features:s},errors:i,warnings:c,metadata:{totalRecords:e.length,successfulRecords:d,skippedRecords:m}}}static transformToResponseTimeAnalyzer(e,r={toolId:"response-time-analyzer"}){var v;console.log("ðŸ”¥ DATA TRANSFORMER - transformToResponseTimeAnalyzer() called"),console.log("ðŸ”¥ DATA TRANSFORMER - incidents.length:",e.length),console.log("ðŸ”¥ DATA TRANSFORMER - first incident:",e[0]),console.log("ðŸ”¥ DATA TRANSFORMER - first incident field names:",Object.keys(e[0]));const i=[],c=[],s=[];let d=0,m=0;return e.forEach((o,n)=>{try{const u=o.incident_id||o["Incident ID"]||o.incidentId||o.id||o.incident_number,g=o.incident_date||o["Incident Date"]||o.incidentDate||o.date;if(!u){i.push(`Row ${n+1}: Missing Incident ID`),m++;return}if(!g){i.push(`Row ${n+1}: Missing Incident Date`),m++;return}console.log(`ðŸ”¥ TRANSFORMER ROW ${n+1} - ACTUAL FIELD NAMES:`,Object.keys(o));let p=o.incident_time;if(console.log(`ðŸ”¥ TRANSFORMER ROW ${n+1} - Primary field ID 'incident_time': "${p}"`),!p){const T=["Call Received Date/Time","Call Received Time","Call Receive Time","call received time","call receive time","Incident Time","incident time","incidentTime","time"];for(const R of T)if(o[R]){p=o[R],console.log(`ðŸ”„ TRANSFORMER ROW ${n+1} - Using original field fallback "${R}": "${p}"`);break}}console.log(`ðŸ”¥ TRANSFORMER ROW ${n+1} - Selected incidentTime: "${p}"`),p&&/^\d{1,2}\/\d{1,2}\/\d{2,4}$/.test(p.trim())&&(console.warn(`âš ï¸ DATA QUALITY WARNING ROW ${n+1}: incidentTime appears to be date-only format: "${p}"`),console.warn("âš ï¸ This may cause unrealistic dispatch time calculations. Consider using a field with full datetime information."));const f={incidentId:String(u),incidentDate:String(g),incidentTime:p,dispatchTime:o.dispatch_time||o["Dispatch Time"]||o.dispatchTime,enRouteTime:o.enroute_time||o["En Route Time"]||o.enRouteTime,arrivalTime:o.arrival_time||o["Arrival Time"]||o.arrivalTime||o.arrive_time||o["On Scene Time"],clearTime:o.clear_time||o["Clear Time"]||o.clearTime,latitude:parseFloat(o.latitude||o.Latitude),longitude:parseFloat(o.longitude||o.Longitude),incidentType:o.incident_type||o["Incident Type"]||o.incidentType||o.type,respondingUnit:o.responding_unit||o.Station||o.station||o.unit||o.unit_id,address:o.address||o.Address,city:o.city||o.City,state:o.state||o.State,zipCode:o.zip_code||o["Zip Code"]||o.zipCode,priority:o.priority||o.Priority};console.log(`ðŸ”¥ TRANSFORMER ROW ${n+1} - Final record incidentTime: "${f.incidentTime}"`),s.push(f),d++}catch(u){i.push(`Row ${n+1}: ${u instanceof Error?u.message:"Unknown error"}`),m++}}),console.log("ðŸ”¥ DATA TRANSFORMER - Processing complete"),console.log("ðŸ”¥ DATA TRANSFORMER - successfulRecords:",d),console.log("ðŸ”¥ DATA TRANSFORMER - errors:",i),console.log("ðŸ”¥ DATA TRANSFORMER - first transformed record:",s[0]),console.log("ðŸ”¥ DATA TRANSFORMER - first transformed record incidentTime:",(v=s[0])==null?void 0:v.incidentTime),{success:i.length===0||d>0,data:s,errors:i,warnings:c,metadata:{totalRecords:e.length,successfulRecords:d,skippedRecords:m}}}static calculateBounds(e){const r=e.filter(s=>s.type==="marker").map(s=>s.coordinates);if(r.length===0)return;const i=r.map(s=>s[1]),c=r.map(s=>s[0]);return{north:Math.max(...i),south:Math.min(...i),east:Math.max(...c),west:Math.min(...c)}}static validateDataForTool(e,r){if(!e||e.length===0)return{compatible:!1,missingFields:r.requiredFields,availableOptionalFields:[]};const i=Object.keys(e[0]),c=r.requiredFields.filter(d=>!i.includes(d)),s=r.optionalFields?r.optionalFields.filter(d=>i.includes(d)):[];return{compatible:c.length===0,missingFields:c,availableOptionalFields:s}}}export{zt as A,Dt as C,Pt as D,Bt as E,kt as S,At as T,Ot as U,Lt as a,Ft as b,Nt as c,jt as d};
