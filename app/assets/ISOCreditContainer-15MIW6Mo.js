import{j as r,r as W,B as t,R as B}from"./index-eBdhe-KS.js";import{S as b,E as Gr,A as Ur,a as Xr,M as Kr,D as Qr}from"./A11yProvider-6HnM_L_f.js";import{c as X,T as i,P as U,u as Jr}from"./Typography-D_4cZLQ6.js";import{L as $}from"./LinearProgress-DQUwJgLc.js";import{G as w,F as Yr,C as k,L as Q,h as v,i as S,j as C,D as Zr,e as re,f as ee,A as Wr,g as ie,v as te,I as J,l as oe}from"./Toolbar-DmuVSCh3.js";import{B as V}from"./Button-Dgl1oafn.js";import{S as ne,a as ce}from"./Save-DaSurFHB.js";import{A as Y,a as Z,E as rr,b as er,W as cr}from"./Warning-D14SQ-mI.js";import{L as qr}from"./LocalFireDepartment-Br7P7pba.js";import{S as Nr}from"./Security-DPN5DYH2.js";import{C as ir,a as tr}from"./CardContent-B-dfsYAF.js";import{E as zr}from"./Error-BIAWvEnZ.js";import{C as H}from"./CheckCircle-DtGVL49S.js";import{C as ae}from"./Close-DDLBGqMt.js";import{u as le,F as de,a as se}from"./FullscreenExit-C2tZNGh_.js";const xe=X(r.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-5.97 4.06L14.09 6l1.41 1.41L16.91 6l1.06 1.06-1.41 1.41 1.41 1.41-1.06 1.06-1.41-1.4-1.41 1.41-1.06-1.06 1.41-1.41zm-6.78.66h5v1.5h-5zM11.5 16h-2v2H8v-2H6v-1.5h2v-2h1.5v2h2zm6.5 1.25h-5v-1.5h5zm0-2.5h-5v-1.5h5z"})),$r=X(r.jsx("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02z"})),ue=X(r.jsx("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"})),_r=X(r.jsx("path",{d:"M5 13.18v4L12 21l7-3.82v-4L12 17zM12 3 1 9l11 6 9-4.91V17h2V9z"})),Hr=X(r.jsx("path",{d:"M21.98 14H22zM5.35 13c1.19 0 1.42 1 3.33 1 1.95 0 2.09-1 3.33-1 1.19 0 1.42 1 3.33 1 1.95 0 2.09-1 3.33-1 1.19 0 1.4.98 3.31 1v-2c-1.19 0-1.42-1-3.33-1-1.95 0-2.09 1-3.33 1-1.19 0-1.42-1-3.33-1-1.95 0-2.09 1-3.33 1-1.19 0-1.42-1-3.33-1-1.95 0-2.09 1-3.33 1v2c1.9 0 2.17-1 3.35-1m13.32 2c-1.95 0-2.09 1-3.33 1-1.19 0-1.42-1-3.33-1-1.95 0-2.1 1-3.34 1s-1.38-1-3.33-1-2.1 1-3.34 1v2c1.95 0 2.11-1 3.34-1 1.24 0 1.38 1 3.33 1s2.1-1 3.34-1c1.19 0 1.42 1 3.33 1 1.94 0 2.09-1 3.33-1 1.19 0 1.42 1 3.33 1v-2c-1.24 0-1.38-1-3.33-1M5.35 9c1.19 0 1.42 1 3.33 1 1.95 0 2.09-1 3.33-1 1.19 0 1.42 1 3.33 1 1.95 0 2.09-1 3.33-1 1.19 0 1.4.98 3.31 1V8c-1.19 0-1.42-1-3.33-1-1.95 0-2.09 1-3.33 1-1.19 0-1.42-1-3.33-1-1.95 0-2.09 1-3.33 1-1.19 0-1.42-1-3.33-1C3.38 7 3.24 8 2 8v2c1.9 0 2.17-1 3.35-1"})),pe=({mode:e="assessment",onAssessmentChange:R,onScoreChange:D,onClassificationChange:j})=>{const[l,u]=W.useState({fireDepartment:{staffing:0,equipment:0,training:0,distribution:0},waterSupply:{capacity:0,distribution:0,alternative:0},communications:{dispatch:0,alerting:0},communityRiskReduction:{prevention:0,education:0,investigation:0}}),[F,x]=W.useState("fire-department"),[O,_]=W.useState(!0);W.useEffect(()=>{R(l),O&&T()},[l,O]);const T=()=>{const a=Object.values(l.fireDepartment).reduce((m,h)=>m+h,0),n=Object.values(l.waterSupply).reduce((m,h)=>m+h,0),s=Object.values(l.communications).reduce((m,h)=>m+h,0),q=Object.values(l.communityRiskReduction).reduce((m,h)=>m+h,0),z=a+n+s+q,N=d(z);D(z),j(N)},d=a=>{const n=a/105.5*100;return n>=90?1:n>=80?2:n>=70?3:n>=60?4:n>=50?5:n>=40?6:n>=30?7:n>=20?8:n>=10?9:10},M=a=>(n,s)=>{x(s?a:"")},p=(a,n)=>{u(s=>({...s,fireDepartment:{...s.fireDepartment,[a]:n}}))},I=(a,n)=>{u(s=>({...s,waterSupply:{...s.waterSupply,[a]:n}}))},f=(a,n)=>{u(s=>({...s,communications:{...s.communications,[a]:n}}))},P=(a,n)=>{u(s=>({...s,communityRiskReduction:{...s.communityRiskReduction,[a]:n}}))},E=()=>{u({fireDepartment:{staffing:0,equipment:0,training:0,distribution:0},waterSupply:{capacity:0,distribution:0,alternative:0},communications:{dispatch:0,alerting:0},communityRiskReduction:{prevention:0,education:0,investigation:0}})},y=()=>Object.values(l.fireDepartment).reduce((a,n)=>a+n,0)+Object.values(l.waterSupply).reduce((a,n)=>a+n,0)+Object.values(l.communications).reduce((a,n)=>a+n,0)+Object.values(l.communityRiskReduction).reduce((a,n)=>a+n,0);return r.jsxs(t,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[r.jsxs(t,{sx:{p:2,borderBottom:1,borderColor:"divider"},children:[r.jsx(i,{variant:"h6",gutterBottom:!0,children:"ISO Assessment Input"}),r.jsx(i,{variant:"body2",color:"text.secondary",children:"Enter your fire department's capabilities to calculate ISO classification"}),r.jsxs(t,{sx:{mt:2},children:[r.jsxs(i,{variant:"body2",gutterBottom:!0,children:["Current Score: ",y().toFixed(1)," / 105.5"]}),r.jsx($,{variant:"determinate",value:y()/105.5*100,sx:{height:6,borderRadius:3}})]})]}),r.jsxs(t,{sx:{p:2,borderBottom:1,borderColor:"divider"},children:[r.jsxs(w,{container:!0,spacing:1,children:[r.jsx(w,{item:!0,xs:6,children:r.jsx(V,{variant:"outlined",size:"small",startIcon:r.jsx(xe,{}),onClick:T,disabled:O,fullWidth:!0,children:"Calculate"})}),r.jsx(w,{item:!0,xs:6,children:r.jsx(V,{variant:"outlined",size:"small",startIcon:r.jsx(ue,{}),onClick:E,fullWidth:!0,children:"Reset"})})]}),r.jsx(Yr,{control:r.jsx(ne,{checked:O,onChange:a=>_(a.target.checked),size:"small"}),label:"Auto-calculate",sx:{mt:1}})]}),r.jsxs(t,{sx:{flexGrow:1,overflow:"auto"},children:[r.jsxs(Y,{expanded:F==="fire-department",onChange:M("fire-department"),children:[r.jsx(Z,{expandIcon:r.jsx(rr,{}),children:r.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,width:"100%"},children:[r.jsx(qr,{sx:{color:"#ff5722"}}),r.jsxs(t,{sx:{flexGrow:1},children:[r.jsx(i,{variant:"subtitle1",children:"Fire Department"}),r.jsxs(i,{variant:"caption",color:"text.secondary",children:[Object.values(l.fireDepartment).reduce((a,n)=>a+n,0).toFixed(1)," / 50 points"]})]}),r.jsx(k,{label:"50 pts",size:"small",sx:{bgcolor:"#ff5722",color:"white"}})]})}),r.jsx(er,{children:r.jsxs(t,{sx:{space:2},children:[r.jsxs(t,{sx:{mb:3},children:[r.jsx(i,{variant:"body2",gutterBottom:!0,children:"Staffing & Personnel Deployment (12.5 pts)"}),r.jsx(b,{value:l.fireDepartment.staffing,onChange:(a,n)=>p("staffing",n),min:0,max:12.5,step:.1,valueLabelDisplay:"auto",sx:{color:"#ff5722"}}),r.jsx(i,{variant:"caption",color:"text.secondary",children:"Personnel availability, response times, staffing levels"})]}),r.jsxs(t,{sx:{mb:3},children:[r.jsx(i,{variant:"body2",gutterBottom:!0,children:"Equipment & Apparatus (12.5 pts)"}),r.jsx(b,{value:l.fireDepartment.equipment,onChange:(a,n)=>p("equipment",n),min:0,max:12.5,step:.1,valueLabelDisplay:"auto",sx:{color:"#ff5722"}}),r.jsx(i,{variant:"caption",color:"text.secondary",children:"NFPA 1901 compliance, maintenance, testing"})]}),r.jsxs(t,{sx:{mb:3},children:[r.jsx(i,{variant:"body2",gutterBottom:!0,children:"Training Programs (12.5 pts)"}),r.jsx(b,{value:l.fireDepartment.training,onChange:(a,n)=>p("training",n),min:0,max:12.5,step:.1,valueLabelDisplay:"auto",sx:{color:"#ff5722"}}),r.jsx(i,{variant:"caption",color:"text.secondary",children:"20+ hours/month structure fire training = 2.25 pts"})]}),r.jsxs(t,{sx:{mb:3},children:[r.jsx(i,{variant:"body2",gutterBottom:!0,children:"Station Distribution & Coverage (12.5 pts)"}),r.jsx(b,{value:l.fireDepartment.distribution,onChange:(a,n)=>p("distribution",n),min:0,max:12.5,step:.1,valueLabelDisplay:"auto",sx:{color:"#ff5722"}}),r.jsx(i,{variant:"caption",color:"text.secondary",children:"Station locations, response coverage, mutual aid"})]})]})})]}),r.jsxs(Y,{expanded:F==="water-supply",onChange:M("water-supply"),children:[r.jsx(Z,{expandIcon:r.jsx(rr,{}),children:r.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,width:"100%"},children:[r.jsx(Hr,{sx:{color:"#2196f3"}}),r.jsxs(t,{sx:{flexGrow:1},children:[r.jsx(i,{variant:"subtitle1",children:"Water Supply"}),r.jsxs(i,{variant:"caption",color:"text.secondary",children:[Object.values(l.waterSupply).reduce((a,n)=>a+n,0).toFixed(1)," / 40 points"]})]}),r.jsx(k,{label:"40 pts",size:"small",sx:{bgcolor:"#2196f3",color:"white"}})]})}),r.jsx(er,{children:r.jsxs(t,{sx:{space:2},children:[r.jsxs(t,{sx:{mb:3},children:[r.jsx(i,{variant:"body2",gutterBottom:!0,children:"Water Capacity & Flow (20 pts)"}),r.jsx(b,{value:l.waterSupply.capacity,onChange:(a,n)=>I("capacity",n),min:0,max:20,step:.1,valueLabelDisplay:"auto",sx:{color:"#2196f3"}}),r.jsx(i,{variant:"caption",color:"text.secondary",children:"Minimum 250 GPM for 2 hours (Class 8B: 200 GPM for 20 min)"})]}),r.jsxs(t,{sx:{mb:3},children:[r.jsx(i,{variant:"body2",gutterBottom:!0,children:"Hydrant Distribution (15 pts)"}),r.jsx(b,{value:l.waterSupply.distribution,onChange:(a,n)=>I("distribution",n),min:0,max:15,step:.1,valueLabelDisplay:"auto",sx:{color:"#2196f3"}}),r.jsx(i,{variant:"caption",color:"text.secondary",children:"Hydrant spacing max 1,000 feet from incidents"})]}),r.jsxs(t,{sx:{mb:3},children:[r.jsx(i,{variant:"body2",gutterBottom:!0,children:"Alternative Water Supply (5 pts)"}),r.jsx(b,{value:l.waterSupply.alternative,onChange:(a,n)=>I("alternative",n),min:0,max:5,step:.1,valueLabelDisplay:"auto",sx:{color:"#2196f3"}}),r.jsx(i,{variant:"caption",color:"text.secondary",children:"Dry hydrants, tanker shuttles, rural supplies"})]})]})})]}),r.jsxs(Y,{expanded:F==="communications",onChange:M("communications"),children:[r.jsx(Z,{expandIcon:r.jsx(rr,{}),children:r.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,width:"100%"},children:[r.jsx($r,{sx:{color:"#9c27b0"}}),r.jsxs(t,{sx:{flexGrow:1},children:[r.jsx(i,{variant:"subtitle1",children:"Communications"}),r.jsxs(i,{variant:"caption",color:"text.secondary",children:[Object.values(l.communications).reduce((a,n)=>a+n,0).toFixed(1)," / 10 points"]})]}),r.jsx(k,{label:"10 pts",size:"small",sx:{bgcolor:"#9c27b0",color:"white"}})]})}),r.jsx(er,{children:r.jsxs(t,{sx:{space:2},children:[r.jsxs(t,{sx:{mb:3},children:[r.jsx(i,{variant:"body2",gutterBottom:!0,children:"911 Dispatch Center (7 pts)"}),r.jsx(b,{value:l.communications.dispatch,onChange:(a,n)=>f("dispatch",n),min:0,max:7,step:.1,valueLabelDisplay:"auto",sx:{color:"#9c27b0"}}),r.jsx(i,{variant:"caption",color:"text.secondary",children:"Call processing, dispatch times, capabilities"})]}),r.jsxs(t,{sx:{mb:3},children:[r.jsx(i,{variant:"body2",gutterBottom:!0,children:"Alerting Systems (3 pts)"}),r.jsx(b,{value:l.communications.alerting,onChange:(a,n)=>f("alerting",n),min:0,max:3,step:.1,valueLabelDisplay:"auto",sx:{color:"#9c27b0"}}),r.jsx(i,{variant:"caption",color:"text.secondary",children:"Radio systems, pagers, notification equipment"})]})]})})]}),r.jsxs(Y,{expanded:F==="community-risk",onChange:M("community-risk"),children:[r.jsx(Z,{expandIcon:r.jsx(rr,{}),children:r.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,width:"100%"},children:[r.jsx(_r,{sx:{color:"#4caf50"}}),r.jsxs(t,{sx:{flexGrow:1},children:[r.jsx(i,{variant:"subtitle1",children:"Community Risk Reduction"}),r.jsxs(i,{variant:"caption",color:"text.secondary",children:[Object.values(l.communityRiskReduction).reduce((a,n)=>a+n,0).toFixed(1)," / 5.5 points"]})]}),r.jsx(k,{label:"BONUS",size:"small",sx:{bgcolor:"#4caf50",color:"white"}})]})}),r.jsx(er,{children:r.jsxs(t,{sx:{space:2},children:[r.jsxs(t,{sx:{mb:3},children:[r.jsx(i,{variant:"body2",gutterBottom:!0,children:"Fire Prevention (2.5 pts)"}),r.jsx(b,{value:l.communityRiskReduction.prevention,onChange:(a,n)=>P("prevention",n),min:0,max:2.5,step:.1,valueLabelDisplay:"auto",sx:{color:"#4caf50"}}),r.jsx(i,{variant:"caption",color:"text.secondary",children:"Code enforcement, inspections, prevention programs"})]}),r.jsxs(t,{sx:{mb:3},children:[r.jsx(i,{variant:"body2",gutterBottom:!0,children:"Public Education (2 pts)"}),r.jsx(b,{value:l.communityRiskReduction.education,onChange:(a,n)=>P("education",n),min:0,max:2,step:.1,valueLabelDisplay:"auto",sx:{color:"#4caf50"}}),r.jsx(i,{variant:"caption",color:"text.secondary",children:"Community outreach, education programs"})]}),r.jsxs(t,{sx:{mb:3},children:[r.jsx(i,{variant:"body2",gutterBottom:!0,children:"Fire Investigation (1 pt)"}),r.jsx(b,{value:l.communityRiskReduction.investigation,onChange:(a,n)=>P("investigation",n),min:0,max:1,step:.1,valueLabelDisplay:"auto",sx:{color:"#4caf50"}}),r.jsx(i,{variant:"caption",color:"text.secondary",children:"Fire investigation capabilities and training"})]})]})})]})]})]})},he=({assessment:e,currentScore:R,classification:D,sidebarOpen:j,isMobile:l})=>{var n,s,q,z,N,m,h,ar,lr,dr,sr,xr,ur,pr,hr,fr,jr,mr,gr,yr,br,vr,Sr,Cr,Ir,wr,Rr,Dr,Pr,kr,Fr,Or,Mr,Er,Ar,Lr,Br,Tr;const u=()=>{if(!e)return 0;const{staffing:o,equipment:c,training:g,distribution:A}=e.fireDepartment,L=Math.min(o,12.5),G=Math.min(c,12.5),nr=Math.min(g,12.5),K=Math.min(A,12.5);return L+G+nr+K},F=()=>{if(!e)return 0;const{capacity:o,distribution:c,alternative:g}=e.waterSupply,A=Math.min(o,20),L=Math.min(c,15),G=Math.min(g,5);return A+L+G},x=()=>{if(!e)return 0;const{dispatch:o,alerting:c}=e.communications,g=Math.min(o,7),A=Math.min(c,3);return g+A},O=()=>{if(!e)return 0;const{prevention:o,education:c,investigation:g}=e.communityRiskReduction,A=Math.min(o,2.5),L=Math.min(c,2),G=Math.min(g,1);return A+L+G},_=()=>{const o=u(),c=F(),g=x(),A=O();let L=o+c+g;const G=o/50,nr=c/40,K=Math.abs(G-nr);if(K>.1){const Vr=K*10;L=Math.max(0,L-Vr)}return L+A},T=o=>{const c=o/105.5*100;return c>=90?1:c>=80?2:c>=70?3:c>=60?4:c>=50?5:c>=40?6:c>=30?7:c>=20?8:c>=10?9:10},d=(o,c)=>{const g=o/c*100;return g>=90?{level:"EXCELLENT",color:"#1b5e20",bg:"#e8f5e8",icon:r.jsx(H,{}),description:"Top 10% of departments"}:g>=75?{level:"GOOD",color:"#2e7d32",bg:"#f1f8e9",icon:r.jsx(H,{}),description:"Above average performance"}:g>=60?{level:"NEEDS IMPROVEMENT",color:"#ff8f00",bg:"#fff8e1",icon:r.jsx(cr,{}),description:"Below average - opportunity exists"}:{level:"CRITICAL",color:"#d32f2f",bg:"#ffebee",icon:r.jsx(zr,{}),description:"Major deficiency affecting rating"}},M=o=>{switch(o){case 1:return{color:"#1b5e20",bg:"#e8f5e8",desc:"Superior Protection",icon:r.jsx(H,{}),benchmark:"Elite - Top 1% of departments"};case 2:case 3:return{color:"#2e7d32",bg:"#f1f8e9",desc:"Excellent Protection",icon:r.jsx(H,{}),benchmark:"Top 25% of departments"};case 4:case 5:return{color:"#558b2f",bg:"#f9fbe7",desc:"Good Protection",icon:r.jsx(H,{}),benchmark:"Above average for community size"};case 6:case 7:return{color:"#ff8f00",bg:"#fff8e1",desc:"Fair Protection",icon:r.jsx(cr,{}),benchmark:"Below average - improvement needed"};case 8:case 9:return{color:"#f57c00",bg:"#fff3e0",desc:"Poor Protection",icon:r.jsx(cr,{}),benchmark:"Bottom 25% - significant gaps"};case 10:default:return{color:"#d32f2f",bg:"#ffebee",desc:"Inadequate Protection",icon:r.jsx(zr,{}),benchmark:"Critical deficiencies present"}}},p=u(),I=F(),f=x(),P=O(),E=_(),y=T(E),a=M(y);return r.jsxs(t,{sx:{p:3,height:"100%",overflow:"auto"},children:[r.jsxs(t,{sx:{mb:4},children:[r.jsxs(i,{variant:"h4",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:2},children:[r.jsx(Nr,{sx:{fontSize:40,color:"primary.main"}}),"ISO Fire Rating Assessment"]}),r.jsx(i,{variant:"subtitle1",color:"text.secondary",children:"Fire Suppression Rating Schedule (FSRS) Analysis - 105.5 Point System"})]}),r.jsx(U,{elevation:3,sx:{p:3,mb:4,background:`linear-gradient(135deg, ${a.bg} 0%, #ffffff 100%)`,border:`2px solid ${a.color}`},children:r.jsxs(w,{container:!0,spacing:3,alignItems:"center",children:[r.jsx(w,{item:!0,xs:12,md:4,children:r.jsxs(t,{sx:{textAlign:"center"},children:[r.jsx(i,{variant:"h2",sx:{color:a.color,fontWeight:"bold",mb:1},children:y}),r.jsx(k,{icon:a.icon,label:`Class ${y}`,sx:{bgcolor:a.color,color:"white",fontSize:"1.1rem",px:2,py:1}})]})}),r.jsxs(w,{item:!0,xs:12,md:8,children:[r.jsx(i,{variant:"h5",sx:{color:a.color,mb:1},children:a.desc}),r.jsxs(i,{variant:"body1",sx:{color:"text.secondary",mb:2,fontStyle:"italic"},children:["📊 ",a.benchmark]}),r.jsxs(i,{variant:"h6",gutterBottom:!0,children:["Total Score: ",E.toFixed(1)," / 105.5 points"]}),r.jsx($,{variant:"determinate",value:E/105.5*100,sx:{height:10,borderRadius:5,bgcolor:"rgba(0,0,0,0.1)","& .MuiLinearProgress-bar":{bgcolor:a.color}}}),r.jsxs(i,{variant:"body2",sx:{mt:1,color:"text.secondary"},children:[(E/105.5*100).toFixed(1),"% of maximum possible score"]}),y>1&&r.jsxs(t,{sx:{mt:2,p:2,bgcolor:"rgba(0,0,0,0.05)",borderRadius:1},children:[r.jsxs(i,{variant:"body2",sx:{fontWeight:"bold",color:"primary.main"},children:["🎯 Path to Class ",y-1,":"]}),r.jsxs(i,{variant:"body2",color:"text.secondary",children:["Need ",(Math.ceil((y-1)*10.55)-E).toFixed(1)," more points",y===5&&" (90+ points for Class 4 - significant insurance savings)",y===2&&" (95+ points for Class 1 - elite rating)"]})]})]})]})}),r.jsxs(w,{container:!0,spacing:3,sx:{mb:4},children:[r.jsx(w,{item:!0,xs:12,md:6,children:r.jsx(ir,{elevation:2,children:r.jsxs(tr,{children:[r.jsxs(t,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[r.jsxs(t,{sx:{display:"flex",alignItems:"center"},children:[r.jsx(qr,{sx:{color:"#ff5722",mr:1}}),r.jsx(i,{variant:"h6",children:"Fire Department Operations"})]}),(()=>{const o=d(p,50);return r.jsx(k,{icon:o.icon,label:o.level,size:"small",sx:{bgcolor:o.color,color:"white",fontWeight:"bold"}})})()]}),r.jsxs(i,{variant:"h4",sx:{color:"#ff5722",mb:1},children:[p.toFixed(1)," / 50"]}),r.jsxs(i,{variant:"body2",sx:{color:"text.secondary",mb:2},children:[(p/50*100).toFixed(0),"% • ",d(p,50).description]}),r.jsx($,{variant:"determinate",value:p/50*100,sx:{mb:2,"& .MuiLinearProgress-bar":{bgcolor:"#ff5722"}}}),r.jsxs(Q,{dense:!0,children:[r.jsxs(v,{children:[r.jsx(S,{children:(()=>{var c;const o=d(((c=e==null?void 0:e.fireDepartment)==null?void 0:c.staffing)||0,12.5);return r.jsx(t,{sx:{color:o.color},children:o.icon})})()}),r.jsx(C,{primary:`Staffing: ${((s=(n=e==null?void 0:e.fireDepartment)==null?void 0:n.staffing)==null?void 0:s.toFixed(1))||"0.0"} / 12.5`,secondary:r.jsxs(t,{children:[r.jsx(i,{variant:"caption",color:"text.secondary",children:"Personnel deployment • NFPA 1710 standard"}),((q=e==null?void 0:e.fireDepartment)==null?void 0:q.staffing)&&e.fireDepartment.staffing<9.5&&r.jsx(i,{variant:"caption",sx:{color:"#ff8f00",display:"block"},children:"💡 Add 2-3 firefighters per shift for Class 4 eligibility"})]})})]}),r.jsxs(v,{children:[r.jsx(S,{children:(()=>{var c;const o=d(((c=e==null?void 0:e.fireDepartment)==null?void 0:c.equipment)||0,12.5);return r.jsx(t,{sx:{color:o.color},children:o.icon})})()}),r.jsx(C,{primary:`Equipment: ${((N=(z=e==null?void 0:e.fireDepartment)==null?void 0:z.equipment)==null?void 0:N.toFixed(1))||"0.0"} / 12.5`,secondary:r.jsxs(t,{children:[r.jsx(i,{variant:"caption",color:"text.secondary",children:"NFPA 1901 apparatus standards"}),((m=e==null?void 0:e.fireDepartment)==null?void 0:m.equipment)&&e.fireDepartment.equipment>=10&&r.jsx(i,{variant:"caption",sx:{color:"#2e7d32",display:"block"},children:"✅ Meets equipment requirements for community size"})]})})]}),r.jsxs(v,{children:[r.jsx(S,{children:(()=>{var c;const o=d(((c=e==null?void 0:e.fireDepartment)==null?void 0:c.training)||0,12.5);return r.jsx(t,{sx:{color:o.color},children:o.icon})})()}),r.jsx(C,{primary:`Training: ${((ar=(h=e==null?void 0:e.fireDepartment)==null?void 0:h.training)==null?void 0:ar.toFixed(1))||"0.0"} / 12.5`,secondary:r.jsxs(t,{children:[r.jsx(i,{variant:"caption",color:"text.secondary",children:"Monthly training hours (need 20+ hrs structure fire)"}),((lr=e==null?void 0:e.fireDepartment)==null?void 0:lr.training)&&e.fireDepartment.training<9.5&&r.jsx(i,{variant:"caption",sx:{color:"#ff8f00",display:"block"},children:"📚 Document additional training hours → Quick points"})]})})]}),r.jsxs(v,{children:[r.jsx(S,{children:(()=>{var c;const o=d(((c=e==null?void 0:e.fireDepartment)==null?void 0:c.distribution)||0,12.5);return r.jsx(t,{sx:{color:o.color},children:o.icon})})()}),r.jsx(C,{primary:`Distribution: ${((sr=(dr=e==null?void 0:e.fireDepartment)==null?void 0:dr.distribution)==null?void 0:sr.toFixed(1))||"0.0"} / 12.5`,secondary:r.jsxs(t,{children:[r.jsx(i,{variant:"caption",color:"text.secondary",children:"Station coverage (target: <2.5 mile response distance)"}),((xr=e==null?void 0:e.fireDepartment)==null?void 0:xr.distribution)&&e.fireDepartment.distribution>=10&&r.jsx(i,{variant:"caption",sx:{color:"#2e7d32",display:"block"},children:"✅ Good coverage for community layout"})]})})]})]})]})})}),r.jsx(w,{item:!0,xs:12,md:6,children:r.jsx(ir,{elevation:2,children:r.jsxs(tr,{children:[r.jsxs(t,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[r.jsxs(t,{sx:{display:"flex",alignItems:"center"},children:[r.jsx(Hr,{sx:{color:"#2196f3",mr:1}}),r.jsx(i,{variant:"h6",children:"Water Supply"})]}),(()=>{const o=d(I,40);return r.jsx(k,{icon:o.icon,label:o.level,size:"small",sx:{bgcolor:o.color,color:"white",fontWeight:"bold"}})})()]}),r.jsxs(i,{variant:"h4",sx:{color:"#2196f3",mb:1},children:[I.toFixed(1)," / 40"]}),r.jsxs(i,{variant:"body2",sx:{color:"text.secondary",mb:2},children:[(I/40*100).toFixed(0),"% • ",d(I,40).description]}),r.jsx($,{variant:"determinate",value:I/40*100,sx:{mb:2,"& .MuiLinearProgress-bar":{bgcolor:"#2196f3"}}}),r.jsxs(Q,{dense:!0,children:[r.jsxs(v,{children:[r.jsx(S,{children:(()=>{var c;const o=d(((c=e==null?void 0:e.waterSupply)==null?void 0:c.capacity)||0,20);return r.jsx(t,{sx:{color:o.color},children:o.icon})})()}),r.jsx(C,{primary:`Capacity: ${((pr=(ur=e==null?void 0:e.waterSupply)==null?void 0:ur.capacity)==null?void 0:pr.toFixed(1))||"0.0"} / 20`,secondary:r.jsxs(t,{children:[r.jsx(i,{variant:"caption",color:"text.secondary",children:"Flow rates • Need 250 GPM minimum (Class 1-8B)"}),((hr=e==null?void 0:e.waterSupply)==null?void 0:hr.capacity)&&e.waterSupply.capacity>=15&&r.jsx(i,{variant:"caption",sx:{color:"#2e7d32",display:"block"},children:"✅ Meets flow requirements for fire suppression"}),((fr=e==null?void 0:e.waterSupply)==null?void 0:fr.capacity)&&e.waterSupply.capacity<12&&r.jsx(i,{variant:"caption",sx:{color:"#ff8f00",display:"block"},children:"💧 Consider water main upgrades or booster systems"})]})})]}),r.jsxs(v,{children:[r.jsx(S,{children:(()=>{var c;const o=d(((c=e==null?void 0:e.waterSupply)==null?void 0:c.distribution)||0,15);return r.jsx(t,{sx:{color:o.color},children:o.icon})})()}),r.jsx(C,{primary:`Distribution: ${((mr=(jr=e==null?void 0:e.waterSupply)==null?void 0:jr.distribution)==null?void 0:mr.toFixed(1))||"0.0"} / 15`,secondary:r.jsxs(t,{children:[r.jsx(i,{variant:"caption",color:"text.secondary",children:"Hydrant spacing (max 1,000 ft from incidents)"}),((gr=e==null?void 0:e.waterSupply)==null?void 0:gr.distribution)&&e.waterSupply.distribution>=12&&r.jsx(i,{variant:"caption",sx:{color:"#2e7d32",display:"block"},children:"✅ Good hydrant coverage for community"}),((yr=e==null?void 0:e.waterSupply)==null?void 0:yr.distribution)&&e.waterSupply.distribution<10&&r.jsx(i,{variant:"caption",sx:{color:"#ff8f00",display:"block"},children:"🔧 Install hydrants in coverage gaps → 2-4 points"})]})})]}),r.jsxs(v,{children:[r.jsx(S,{children:(()=>{var c;const o=d(((c=e==null?void 0:e.waterSupply)==null?void 0:c.alternative)||0,5);return r.jsx(t,{sx:{color:o.color},children:o.icon})})()}),r.jsx(C,{primary:`Alternative: ${((vr=(br=e==null?void 0:e.waterSupply)==null?void 0:br.alternative)==null?void 0:vr.toFixed(1))||"0.0"} / 5`,secondary:r.jsxs(t,{children:[r.jsx(i,{variant:"caption",color:"text.secondary",children:"Dry hydrants, tanker shuttles, static sources"}),((Sr=e==null?void 0:e.waterSupply)==null?void 0:Sr.alternative)&&e.waterSupply.alternative<3&&r.jsx(i,{variant:"caption",sx:{color:"#ff8f00",display:"block"},children:"🚛 Develop tanker shuttle operations for rural areas"})]})})]})]})]})})}),r.jsx(w,{item:!0,xs:12,md:6,children:r.jsx(ir,{elevation:2,children:r.jsxs(tr,{children:[r.jsxs(t,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[r.jsxs(t,{sx:{display:"flex",alignItems:"center"},children:[r.jsx($r,{sx:{color:"#9c27b0",mr:1}}),r.jsx(i,{variant:"h6",children:"Emergency Communications"})]}),(()=>{const o=d(f,10);return r.jsx(k,{icon:o.icon,label:o.level,size:"small",sx:{bgcolor:o.color,color:"white",fontWeight:"bold"}})})()]}),r.jsxs(i,{variant:"h4",sx:{color:"#9c27b0",mb:1},children:[f.toFixed(1)," / 10"]}),r.jsxs(i,{variant:"body2",sx:{color:"text.secondary",mb:2},children:[(f/10*100).toFixed(0),"% • ",d(f,10).description]}),r.jsx($,{variant:"determinate",value:f/10*100,sx:{mb:2,"& .MuiLinearProgress-bar":{bgcolor:"#9c27b0"}}}),r.jsxs(Q,{dense:!0,children:[r.jsxs(v,{children:[r.jsx(S,{children:(()=>{var c;const o=d(((c=e==null?void 0:e.communications)==null?void 0:c.dispatch)||0,7);return r.jsx(t,{sx:{color:o.color},children:o.icon})})()}),r.jsx(C,{primary:`Dispatch: ${((Ir=(Cr=e==null?void 0:e.communications)==null?void 0:Cr.dispatch)==null?void 0:Ir.toFixed(1))||"0.0"} / 7`,secondary:r.jsxs(t,{children:[r.jsx(i,{variant:"caption",color:"text.secondary",children:"911 center capabilities • Call processing efficiency"}),((wr=e==null?void 0:e.communications)==null?void 0:wr.dispatch)&&e.communications.dispatch>=6&&r.jsx(i,{variant:"caption",sx:{color:"#2e7d32",display:"block"},children:"✅ Excellent dispatch operations"}),((Rr=e==null?void 0:e.communications)==null?void 0:Rr.dispatch)&&e.communications.dispatch<5&&r.jsx(i,{variant:"caption",sx:{color:"#ff8f00",display:"block"},children:"📞 Improve dispatch training and protocols"})]})})]}),r.jsxs(v,{children:[r.jsx(S,{children:(()=>{var c;const o=d(((c=e==null?void 0:e.communications)==null?void 0:c.alerting)||0,3);return r.jsx(t,{sx:{color:o.color},children:o.icon})})()}),r.jsx(C,{primary:`Alerting: ${((Pr=(Dr=e==null?void 0:e.communications)==null?void 0:Dr.alerting)==null?void 0:Pr.toFixed(1))||"0.0"} / 3`,secondary:r.jsxs(t,{children:[r.jsx(i,{variant:"caption",color:"text.secondary",children:"Radio systems • Notification reliability"}),((kr=e==null?void 0:e.communications)==null?void 0:kr.alerting)&&e.communications.alerting>=2.5&&r.jsx(i,{variant:"caption",sx:{color:"#2e7d32",display:"block"},children:"✅ Modern communication systems"})]})})]})]})]})})}),r.jsx(w,{item:!0,xs:12,md:6,children:r.jsx(ir,{elevation:2,children:r.jsxs(tr,{children:[r.jsxs(t,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[r.jsxs(t,{sx:{display:"flex",alignItems:"center"},children:[r.jsx(_r,{sx:{color:"#4caf50",mr:1}}),r.jsx(i,{variant:"h6",children:"Community Risk Reduction"}),r.jsx(k,{label:"BONUS",size:"small",sx:{ml:1,bgcolor:"#4caf50",color:"white"}})]}),(()=>{const o=d(P,5.5);return r.jsx(k,{icon:o.icon,label:o.level,size:"small",sx:{bgcolor:o.color,color:"white",fontWeight:"bold"}})})()]}),r.jsxs(i,{variant:"h4",sx:{color:"#4caf50",mb:1},children:[P.toFixed(1)," / 5.5"]}),r.jsxs(i,{variant:"body2",sx:{color:"text.secondary",mb:2},children:[(P/5.5*100).toFixed(0),"% • Bonus points toward total score"]}),r.jsx($,{variant:"determinate",value:P/5.5*100,sx:{mb:2,"& .MuiLinearProgress-bar":{bgcolor:"#4caf50"}}}),r.jsxs(Q,{dense:!0,children:[r.jsxs(v,{children:[r.jsx(S,{children:(()=>{var c;const o=d(((c=e==null?void 0:e.communityRiskReduction)==null?void 0:c.prevention)||0,2.5);return r.jsx(t,{sx:{color:o.color},children:o.icon})})()}),r.jsx(C,{primary:`Prevention: ${((Or=(Fr=e==null?void 0:e.communityRiskReduction)==null?void 0:Fr.prevention)==null?void 0:Or.toFixed(1))||"0.0"} / 2.5`,secondary:r.jsxs(t,{children:[r.jsx(i,{variant:"caption",color:"text.secondary",children:"Fire prevention • Code enforcement programs"}),((Mr=e==null?void 0:e.communityRiskReduction)==null?void 0:Mr.prevention)&&e.communityRiskReduction.prevention>=2&&r.jsx(i,{variant:"caption",sx:{color:"#2e7d32",display:"block"},children:"✅ Strong prevention programs"})]})})]}),r.jsxs(v,{children:[r.jsx(S,{children:(()=>{var c;const o=d(((c=e==null?void 0:e.communityRiskReduction)==null?void 0:c.education)||0,2);return r.jsx(t,{sx:{color:o.color},children:o.icon})})()}),r.jsx(C,{primary:`Education: ${((Ar=(Er=e==null?void 0:e.communityRiskReduction)==null?void 0:Er.education)==null?void 0:Ar.toFixed(1))||"0.0"} / 2`,secondary:r.jsxs(t,{children:[r.jsx(i,{variant:"caption",color:"text.secondary",children:"Public education • School programs • Community outreach"}),((Lr=e==null?void 0:e.communityRiskReduction)==null?void 0:Lr.education)&&e.communityRiskReduction.education<1.5&&r.jsx(i,{variant:"caption",sx:{color:"#ff8f00",display:"block"},children:"🏫 Expand school fire safety programs → Easy points"})]})})]}),r.jsxs(v,{children:[r.jsx(S,{children:(()=>{var c;const o=d(((c=e==null?void 0:e.communityRiskReduction)==null?void 0:c.investigation)||0,1);return r.jsx(t,{sx:{color:o.color},children:o.icon})})()}),r.jsx(C,{primary:`Investigation: ${((Tr=(Br=e==null?void 0:e.communityRiskReduction)==null?void 0:Br.investigation)==null?void 0:Tr.toFixed(1))||"0.0"} / 1`,secondary:r.jsx(t,{children:r.jsx(i,{variant:"caption",color:"text.secondary",children:"Fire investigation • Origin & cause determination"})})})]})]})]})})})]}),!e&&r.jsxs(U,{elevation:1,sx:{p:3,textAlign:"center",bgcolor:"#f5f5f5"},children:[r.jsx(i,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No Assessment Data"}),r.jsx(i,{variant:"body1",color:"text.secondary",children:"Use the sidebar to input your fire department's capabilities and generate an ISO score assessment."})]})]})},fe=({open:e,onClose:R,assessment:D,score:j,classification:l})=>{const u=()=>{console.log("🏆 Generating ISO Credit Report:",{assessment:D,score:j,classification:l}),alert(`ISO Report Generator - Coming in Phase 3!

Will generate professional PDF reports with:
• Current ISO classification analysis
• Improvement recommendations
• Cost-benefit analysis
• Community insurance savings projections`)};return r.jsxs(Zr,{open:e,onClose:R,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{minHeight:"60vh"}},children:[r.jsx(re,{children:r.jsxs(t,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsx(i,{variant:"h6",children:"ISO Credit Report Generator"}),r.jsx(V,{onClick:R,size:"small",sx:{minWidth:"auto",p:1},children:r.jsx(ae,{})})]})}),r.jsxs(ee,{children:[r.jsx(Wr,{severity:"info",sx:{mb:3},children:"Professional PDF report generation will be implemented in Phase 3 of development."}),r.jsxs(U,{elevation:1,sx:{p:3,mb:3},children:[r.jsx(i,{variant:"h6",gutterBottom:!0,children:"Planned Report Features:"}),r.jsx(i,{component:"div",variant:"body1",children:r.jsxs("ul",{children:[r.jsxs("li",{children:[r.jsx("strong",{children:"ISO Classification Analysis"})," - Current score breakdown and classification"]}),r.jsxs("li",{children:[r.jsx("strong",{children:"Improvement Recommendations"})," - Specific areas for ISO score enhancement"]}),r.jsxs("li",{children:[r.jsx("strong",{children:"Cost-Benefit Analysis"})," - ROI calculations for improvements"]}),r.jsxs("li",{children:[r.jsx("strong",{children:"Community Insurance Savings"})," - Projected premium reductions"]}),r.jsxs("li",{children:[r.jsx("strong",{children:"Grant Application Support"})," - Data formatted for funding requests"]}),r.jsxs("li",{children:[r.jsx("strong",{children:"City Council Presentations"})," - Executive-ready presentation materials"]})]})})]}),D&&r.jsxs(U,{elevation:1,sx:{p:3},children:[r.jsx(i,{variant:"h6",gutterBottom:!0,children:"Current Assessment Summary:"}),r.jsxs(i,{variant:"body1",children:[r.jsx("strong",{children:"ISO Classification:"})," Class ",l,r.jsx("br",{}),r.jsx("strong",{children:"Total Score:"})," ",j.toFixed(1)," / 105.5 points",r.jsx("br",{}),r.jsx("strong",{children:"Score Percentage:"})," ",(j/105.5*100).toFixed(1),"%"]})]})]}),r.jsxs(ie,{sx:{p:3},children:[r.jsx(V,{onClick:R,variant:"outlined",children:"Close"}),r.jsx(V,{onClick:u,variant:"contained",startIcon:r.jsx(Gr,{}),disabled:!D,children:"Generate Report (Phase 3)"})]})]})},or=320,Oe=({initialAssessment:e,onAssessmentComplete:R,mode:D="assessment"})=>{const j=Jr(),l=le(j.breakpoints.down("md")),[u,F]=B.useState(!l),[x,O]=B.useState(!1),[_,T]=B.useState(!1),[d,M]=B.useState(null),[p,I]=B.useState(0),[f,P]=B.useState(10),[E,y]=B.useState(!1),[a,n]=B.useState(null);W.useEffect(()=>{document.title="FireEMS ISO Credit Calculator"},[]),W.useEffect(()=>{e&&(M(e),console.log("Loading initial ISO assessment:",e))},[e]),W.useEffect(()=>{d&&R&&R(d)},[d,R]);const s=()=>{F(!u)},q=()=>{O(!x),x?document.fullscreenElement&&document.exitFullscreen&&document.exitFullscreen():document.documentElement.requestFullscreen&&document.documentElement.requestFullscreen()},z=()=>{const h={assessment:d,score:p,classification:f,timestamp:new Date};localStorage.setItem("iso_credit_calculator_autosave",JSON.stringify(h)),console.log("ISO assessment data saved")},N=()=>{console.log("🏆 ISO EXPORT BUTTON CLICKED - Starting export process");const h=d!==null;if(console.log("🏆 ISO EXPORT DATA CHECK:",{hasAssessment:h,currentScore:p,classification:f}),!h){console.log("🏆 NO ISO DATA - Showing alert"),alert("No ISO assessment data to export. Please complete the assessment first.");return}console.log("🏆 OPENING ISO REPORT GENERATOR - Setting state"),T(!0),console.log("📊 Opening professional ISO credit report generator:",{score:p,classification:f,hasAssessment:!!d,showReportGenerator:!0})},m=()=>{n(null)};return r.jsx(Ur,{children:r.jsxs(t,{sx:{display:"flex",height:"100vh",overflow:"hidden",bgcolor:"background.default",position:x?"fixed":"relative",top:x?0:"auto",left:x?0:"auto",right:x?0:"auto",bottom:x?0:"auto",zIndex:x?1300:"auto"},role:"main","aria-label":"ISO Credit Calculator Tool",children:[!x&&r.jsx(Xr,{position:"fixed",sx:{zIndex:j.zIndex.drawer+1,bgcolor:"primary.main"},children:r.jsxs(te,{children:[r.jsx(J,{color:"inherit","aria-label":"toggle sidebar",onClick:s,edge:"start",sx:{mr:2},children:r.jsx(Kr,{})}),r.jsx(Nr,{sx:{mr:1}}),r.jsxs(i,{variant:"h6",noWrap:!0,component:"div",sx:{flexGrow:1},children:["ISO Credit Calculator",D==="planning"&&" - Planning Mode",D==="presentation"&&" - Presentation Mode"]}),r.jsxs(t,{sx:{display:"flex",gap:1},children:[r.jsx(J,{color:"inherit",onClick:z,title:"Save Assessment",children:r.jsx(ce,{})}),r.jsx(J,{color:"inherit",onClick:N,title:"Generate Professional ISO Report",disabled:!d,children:r.jsx(Gr,{})}),r.jsx(J,{color:"inherit",onClick:q,title:"Toggle Fullscreen",children:x?r.jsx(de,{}):r.jsx(se,{})})]})]})}),r.jsx(Qr,{variant:l?"temporary":"persistent",anchor:"left",open:u,onClose:s,sx:{width:or,flexShrink:0,"& .MuiDrawer-paper":{width:or,boxSizing:"border-box",marginTop:x?0:"56px",height:x?"100vh":"calc(100vh - 56px)",borderRight:`1px solid ${j.palette.divider}`}},ModalProps:{keepMounted:!0,disablePortal:!1,hideBackdrop:!l,disableAutoFocus:!0,disableEnforceFocus:!0,disableRestoreFocus:!0},PaperProps:{"aria-hidden":!1,role:"complementary","aria-label":"ISO Credit Calculator Tools"},children:r.jsx(pe,{mode:D,onAssessmentChange:M,onScoreChange:I,onClassificationChange:P})}),r.jsxs(t,{component:"main",sx:{flexGrow:1,position:"relative",marginLeft:!l&&u?`${or}px`:0,width:!l&&u?`calc(100% - ${or}px)`:"100%",marginTop:x?0:"56px",height:x?"100vh":"calc(100vh - 56px)",transition:j.transitions.create(["margin","width"],{easing:j.transitions.easing.sharp,duration:j.transitions.duration.leavingScreen})},children:[r.jsx(U,{elevation:0,sx:{height:"100%",width:"100%",borderRadius:0,overflow:"hidden",position:"relative",minHeight:"500px",display:"flex",flexDirection:"column"},children:r.jsx(he,{assessment:d,currentScore:p,classification:f,sidebarOpen:u,isMobile:l})}),E&&r.jsx(t,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,bgcolor:"rgba(255, 255, 255, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:r.jsx(i,{variant:"h6",children:"Calculating ISO Score..."})})]}),r.jsx(oe,{open:!!a,autoHideDuration:6e3,onClose:m,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:r.jsx(Wr,{onClose:m,severity:"error",sx:{width:"100%"},children:a})}),r.jsx(fe,{open:_,onClose:()=>T(!1),assessment:d,score:p,classification:f})]})})};export{Oe as default};
