var tt=Object.defineProperty;var it=(i,c,d)=>c in i?tt(i,c,{enumerable:!0,configurable:!0,writable:!0,value:d}):i[c]=d;var pe=(i,c,d)=>it(i,typeof c!="symbol"?c+"":c,d);import{j as e,r as B,B as r,C as rt,R as z}from"./index-DYabat_f.js";import{S as F,A as nt,a as ot}from"./A11yProvider-B8zJ_jy9.js";import{c as de,T as t,P as V,u as at}from"./Typography-K_7xKURX.js";import{L as ee}from"./LinearProgress-BB_BBVYI.js";import{G as g,C as L}from"./listItemTextClasses-CblO_0qc.js";import{B as le,L as ie}from"./List-DYoGPKW9.js";import{R as st,T as be}from"./TrendingUp-CwJG6Qxr.js";import{F as ct,D as lt,a as dt,b as pt,c as ut}from"./FormControlLabel-C_oHUh7O.js";import{S as xt,a as ht}from"./Save-CCsdrlRq.js";import{A as re,a as ne,E as oe,b as ae}from"./ExpandMore-fr4593Xf.js";import{L as ve}from"./LocalFireDepartment-BVW5PKXa.js";import{S as Qe}from"./Security-fbFK76eU.js";import{C as se,a as ce}from"./CardContent-C4tvZ5Q3.js";import{L as T,a as M,b as A}from"./ListItemText-DP_zGjtC.js";import{E as Ye}from"./Error-Duq_vB2L.js";import{W as je}from"./Warning-umQJFDy6.js";import{C as te}from"./CheckCircle-BjIj4dUe.js";import{T as mt}from"./Tune-BX75ZnZt.js";import{F as J,j as Q,A as fe,T as Ke,a as xe}from"./TextField-CyNaTQmj.js";import{T as ft}from"./AccessTime-CaTNpBMO.js";import{T as gt}from"./Timeline-BHlIT0kj.js";import{e as jt,T as yt,a as bt,b as ye,c as Z,d as vt}from"./TableRow-BJjG2zl4.js";import{B as St}from"./Business-CzdD7h2q.js";import{D as Ct}from"./Divider-DPukK-sS.js";import{E as It,T as kt}from"./jspdf.es.min-grSEWAmR.js";import{a as he}from"./jspdf.plugin.autotable-CtA5BUKo.js";import{C as Ft}from"./Close-CcDj7Sd9.js";import{E as Ze,M as Rt,D as Pt}from"./Menu-CYAsoXa4.js";import{u as Dt,F as wt,a as Ot}from"./FullscreenExit-DnUxfqpL.js";import{T as Et,a as Je}from"./Tabs-DHMFSUoM.js";import{A as Tt}from"./Assessment-Bo_OseOB.js";import{S as Mt}from"./Snackbar-DfKWNpFZ.js";const At=de(e.jsx("path",{d:"M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4"})),Lt=de(e.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-5.97 4.06L14.09 6l1.41 1.41L16.91 6l1.06 1.06-1.41 1.41 1.41 1.41-1.06 1.06-1.41-1.4-1.41 1.41-1.06-1.06 1.41-1.41zm-6.78.66h5v1.5h-5zM11.5 16h-2v2H8v-2H6v-1.5h2v-2h1.5v2h2zm6.5 1.25h-5v-1.5h5zm0-2.5h-5v-1.5h5z"})),Se=de(e.jsx("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02z"})),Bt=de([e.jsx("circle",{cx:"12",cy:"19",r:"2"},"0"),e.jsx("path",{d:"M10 3h4v12h-4z"},"1")]),Ce=de(e.jsx("path",{d:"M5 13.18v4L12 21l7-3.82v-4L12 17zM12 3 1 9l11 6 9-4.91V17h2V9z"})),Ie=de(e.jsx("path",{d:"M21.98 14H22zM5.35 13c1.19 0 1.42 1 3.33 1 1.95 0 2.09-1 3.33-1 1.19 0 1.42 1 3.33 1 1.95 0 2.09-1 3.33-1 1.19 0 1.4.98 3.31 1v-2c-1.19 0-1.42-1-3.33-1-1.95 0-2.09 1-3.33 1-1.19 0-1.42-1-3.33-1-1.95 0-2.09 1-3.33 1-1.19 0-1.42-1-3.33-1-1.95 0-2.09 1-3.33 1v2c1.9 0 2.17-1 3.35-1m13.32 2c-1.95 0-2.09 1-3.33 1-1.19 0-1.42-1-3.33-1-1.95 0-2.1 1-3.34 1s-1.38-1-3.33-1-2.1 1-3.34 1v2c1.95 0 2.11-1 3.34-1 1.24 0 1.38 1 3.33 1s2.1-1 3.34-1c1.19 0 1.42 1 3.33 1 1.94 0 2.09-1 3.33-1 1.19 0 1.42 1 3.33 1v-2c-1.24 0-1.38-1-3.33-1M5.35 9c1.19 0 1.42 1 3.33 1 1.95 0 2.09-1 3.33-1 1.19 0 1.42 1 3.33 1 1.95 0 2.09-1 3.33-1 1.19 0 1.4.98 3.31 1V8c-1.19 0-1.42-1-3.33-1-1.95 0-2.09 1-3.33 1-1.19 0-1.42-1-3.33-1-1.95 0-2.09 1-3.33 1-1.19 0-1.42-1-3.33-1C3.38 7 3.24 8 2 8v2c1.9 0 2.17-1 3.35-1"})),Wt=({mode:i="assessment",onAssessmentChange:c,onScoreChange:d,onClassificationChange:x})=>{const[u,I]=B.useState({fireDepartment:{staffing:0,equipment:0,training:0,distribution:0},waterSupply:{capacity:0,distribution:0,alternative:0},communications:{dispatch:0,alerting:0},communityRiskReduction:{prevention:0,education:0,investigation:0}}),[D,j]=B.useState("fire-department"),[E,G]=B.useState(!0);B.useEffect(()=>{c(u),E&&h()},[u,E]);const h=()=>{const o=Object.values(u.fireDepartment).reduce((C,P)=>C+P,0),a=Object.values(u.waterSupply).reduce((C,P)=>C+P,0),n=Object.values(u.communications).reduce((C,P)=>C+P,0),p=Object.values(u.communityRiskReduction).reduce((C,P)=>C+P,0),y=o+a+n+p,S=m(y);d(y),x(S)},m=o=>{const a=o/105.5*100;return a>=90?1:a>=80?2:a>=70?3:a>=60?4:a>=50?5:a>=40?6:a>=30?7:a>=20?8:a>=10?9:10},b=o=>(a,n)=>{j(n?o:"")},f=(o,a)=>{I(n=>({...n,fireDepartment:{...n.fireDepartment,[o]:a}}))},R=(o,a)=>{I(n=>({...n,waterSupply:{...n.waterSupply,[o]:a}}))},k=(o,a)=>{I(n=>({...n,communications:{...n.communications,[o]:a}}))},w=(o,a)=>{I(n=>({...n,communityRiskReduction:{...n.communityRiskReduction,[o]:a}}))},v=()=>{I({fireDepartment:{staffing:0,equipment:0,training:0,distribution:0},waterSupply:{capacity:0,distribution:0,alternative:0},communications:{dispatch:0,alerting:0},communityRiskReduction:{prevention:0,education:0,investigation:0}})},O=()=>Object.values(u.fireDepartment).reduce((o,a)=>o+a,0)+Object.values(u.waterSupply).reduce((o,a)=>o+a,0)+Object.values(u.communications).reduce((o,a)=>o+a,0)+Object.values(u.communityRiskReduction).reduce((o,a)=>o+a,0);return e.jsxs(r,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[e.jsxs(r,{sx:{p:2,borderBottom:1,borderColor:"divider"},children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"ISO Assessment Input"}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Enter your fire department's capabilities to calculate ISO classification"}),e.jsxs(r,{sx:{mt:2},children:[e.jsxs(t,{variant:"body2",gutterBottom:!0,children:["Current Score: ",O().toFixed(1)," / 105.5"]}),e.jsx(ee,{variant:"determinate",value:O()/105.5*100,sx:{height:6,borderRadius:3}})]})]}),e.jsxs(r,{sx:{p:2,borderBottom:1,borderColor:"divider"},children:[e.jsxs(g,{container:!0,spacing:1,children:[e.jsx(g,{item:!0,xs:6,children:e.jsx(le,{variant:"outlined",size:"small",startIcon:e.jsx(Lt,{}),onClick:h,disabled:E,fullWidth:!0,children:"Calculate"})}),e.jsx(g,{item:!0,xs:6,children:e.jsx(le,{variant:"outlined",size:"small",startIcon:e.jsx(st,{}),onClick:v,fullWidth:!0,children:"Reset"})})]}),e.jsx(ct,{control:e.jsx(xt,{checked:E,onChange:o=>G(o.target.checked),size:"small"}),label:"Auto-calculate",sx:{mt:1}})]}),e.jsxs(r,{sx:{flexGrow:1,overflow:"auto"},children:[e.jsxs(re,{expanded:D==="fire-department",onChange:b("fire-department"),children:[e.jsx(ne,{expandIcon:e.jsx(oe,{}),children:e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1,width:"100%"},children:[e.jsx(ve,{sx:{color:"#ff5722"}}),e.jsxs(r,{sx:{flexGrow:1},children:[e.jsx(t,{variant:"subtitle1",children:"Fire Department"}),e.jsxs(t,{variant:"caption",color:"text.secondary",children:[Object.values(u.fireDepartment).reduce((o,a)=>o+a,0).toFixed(1)," / 50 points"]})]}),e.jsx(L,{label:"50 pts",size:"small",sx:{bgcolor:"#ff5722",color:"white"}})]})}),e.jsx(ae,{children:e.jsxs(r,{sx:{space:2},children:[e.jsxs(r,{sx:{mb:3},children:[e.jsx(t,{variant:"body2",gutterBottom:!0,children:"Staffing & Personnel Deployment (12.5 pts)"}),e.jsx(F,{value:u.fireDepartment.staffing,onChange:(o,a)=>f("staffing",a),min:0,max:12.5,step:.1,valueLabelDisplay:"auto",sx:{color:"#ff5722"}}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Personnel availability, response times, staffing levels"})]}),e.jsxs(r,{sx:{mb:3},children:[e.jsx(t,{variant:"body2",gutterBottom:!0,children:"Equipment & Apparatus (12.5 pts)"}),e.jsx(F,{value:u.fireDepartment.equipment,onChange:(o,a)=>f("equipment",a),min:0,max:12.5,step:.1,valueLabelDisplay:"auto",sx:{color:"#ff5722"}}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"NFPA 1901 compliance, maintenance, testing"})]}),e.jsxs(r,{sx:{mb:3},children:[e.jsx(t,{variant:"body2",gutterBottom:!0,children:"Training Programs (12.5 pts)"}),e.jsx(F,{value:u.fireDepartment.training,onChange:(o,a)=>f("training",a),min:0,max:12.5,step:.1,valueLabelDisplay:"auto",sx:{color:"#ff5722"}}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"20+ hours/month structure fire training = 2.25 pts"})]}),e.jsxs(r,{sx:{mb:3},children:[e.jsx(t,{variant:"body2",gutterBottom:!0,children:"Station Distribution & Coverage (12.5 pts)"}),e.jsx(F,{value:u.fireDepartment.distribution,onChange:(o,a)=>f("distribution",a),min:0,max:12.5,step:.1,valueLabelDisplay:"auto",sx:{color:"#ff5722"}}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Station locations, response coverage, mutual aid"})]})]})})]}),e.jsxs(re,{expanded:D==="water-supply",onChange:b("water-supply"),children:[e.jsx(ne,{expandIcon:e.jsx(oe,{}),children:e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1,width:"100%"},children:[e.jsx(Ie,{sx:{color:"#2196f3"}}),e.jsxs(r,{sx:{flexGrow:1},children:[e.jsx(t,{variant:"subtitle1",children:"Water Supply"}),e.jsxs(t,{variant:"caption",color:"text.secondary",children:[Object.values(u.waterSupply).reduce((o,a)=>o+a,0).toFixed(1)," / 40 points"]})]}),e.jsx(L,{label:"40 pts",size:"small",sx:{bgcolor:"#2196f3",color:"white"}})]})}),e.jsx(ae,{children:e.jsxs(r,{sx:{space:2},children:[e.jsxs(r,{sx:{mb:3},children:[e.jsx(t,{variant:"body2",gutterBottom:!0,children:"Water Capacity & Flow (20 pts)"}),e.jsx(F,{value:u.waterSupply.capacity,onChange:(o,a)=>R("capacity",a),min:0,max:20,step:.1,valueLabelDisplay:"auto",sx:{color:"#2196f3"}}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Minimum 250 GPM for 2 hours (Class 8B: 200 GPM for 20 min)"})]}),e.jsxs(r,{sx:{mb:3},children:[e.jsx(t,{variant:"body2",gutterBottom:!0,children:"Hydrant Distribution (15 pts)"}),e.jsx(F,{value:u.waterSupply.distribution,onChange:(o,a)=>R("distribution",a),min:0,max:15,step:.1,valueLabelDisplay:"auto",sx:{color:"#2196f3"}}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Hydrant spacing max 1,000 feet from incidents"})]}),e.jsxs(r,{sx:{mb:3},children:[e.jsx(t,{variant:"body2",gutterBottom:!0,children:"Alternative Water Supply (5 pts)"}),e.jsx(F,{value:u.waterSupply.alternative,onChange:(o,a)=>R("alternative",a),min:0,max:5,step:.1,valueLabelDisplay:"auto",sx:{color:"#2196f3"}}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Dry hydrants, tanker shuttles, rural supplies"})]})]})})]}),e.jsxs(re,{expanded:D==="communications",onChange:b("communications"),children:[e.jsx(ne,{expandIcon:e.jsx(oe,{}),children:e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1,width:"100%"},children:[e.jsx(Se,{sx:{color:"#9c27b0"}}),e.jsxs(r,{sx:{flexGrow:1},children:[e.jsx(t,{variant:"subtitle1",children:"Communications"}),e.jsxs(t,{variant:"caption",color:"text.secondary",children:[Object.values(u.communications).reduce((o,a)=>o+a,0).toFixed(1)," / 10 points"]})]}),e.jsx(L,{label:"10 pts",size:"small",sx:{bgcolor:"#9c27b0",color:"white"}})]})}),e.jsx(ae,{children:e.jsxs(r,{sx:{space:2},children:[e.jsxs(r,{sx:{mb:3},children:[e.jsx(t,{variant:"body2",gutterBottom:!0,children:"911 Dispatch Center (7 pts)"}),e.jsx(F,{value:u.communications.dispatch,onChange:(o,a)=>k("dispatch",a),min:0,max:7,step:.1,valueLabelDisplay:"auto",sx:{color:"#9c27b0"}}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Call processing, dispatch times, capabilities"})]}),e.jsxs(r,{sx:{mb:3},children:[e.jsx(t,{variant:"body2",gutterBottom:!0,children:"Alerting Systems (3 pts)"}),e.jsx(F,{value:u.communications.alerting,onChange:(o,a)=>k("alerting",a),min:0,max:3,step:.1,valueLabelDisplay:"auto",sx:{color:"#9c27b0"}}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Radio systems, pagers, notification equipment"})]})]})})]}),e.jsxs(re,{expanded:D==="community-risk",onChange:b("community-risk"),children:[e.jsx(ne,{expandIcon:e.jsx(oe,{}),children:e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1,width:"100%"},children:[e.jsx(Ce,{sx:{color:"#4caf50"}}),e.jsxs(r,{sx:{flexGrow:1},children:[e.jsx(t,{variant:"subtitle1",children:"Community Risk Reduction"}),e.jsxs(t,{variant:"caption",color:"text.secondary",children:[Object.values(u.communityRiskReduction).reduce((o,a)=>o+a,0).toFixed(1)," / 5.5 points"]})]}),e.jsx(L,{label:"BONUS",size:"small",sx:{bgcolor:"#4caf50",color:"white"}})]})}),e.jsx(ae,{children:e.jsxs(r,{sx:{space:2},children:[e.jsxs(r,{sx:{mb:3},children:[e.jsx(t,{variant:"body2",gutterBottom:!0,children:"Fire Prevention (2.5 pts)"}),e.jsx(F,{value:u.communityRiskReduction.prevention,onChange:(o,a)=>w("prevention",a),min:0,max:2.5,step:.1,valueLabelDisplay:"auto",sx:{color:"#4caf50"}}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Code enforcement, inspections, prevention programs"})]}),e.jsxs(r,{sx:{mb:3},children:[e.jsx(t,{variant:"body2",gutterBottom:!0,children:"Public Education (2 pts)"}),e.jsx(F,{value:u.communityRiskReduction.education,onChange:(o,a)=>w("education",a),min:0,max:2,step:.1,valueLabelDisplay:"auto",sx:{color:"#4caf50"}}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Community outreach, education programs"})]}),e.jsxs(r,{sx:{mb:3},children:[e.jsx(t,{variant:"body2",gutterBottom:!0,children:"Fire Investigation (1 pt)"}),e.jsx(F,{value:u.communityRiskReduction.investigation,onChange:(o,a)=>w("investigation",a),min:0,max:1,step:.1,valueLabelDisplay:"auto",sx:{color:"#4caf50"}}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Fire investigation capabilities and training"})]})]})})]})]})]})},Gt=({assessment:i,currentScore:c,classification:d,sidebarOpen:x,isMobile:u})=>{var a,n,p,y,S,C,P,N,H,X,$,q,K,ke,Fe,Re,Pe,De,we,Oe,Ee,Te,Me,Ae,Le,Be,We,Ge,$e,qe,ze,Ne,He,Ue,_e,Ve,Xe;const I=()=>{if(!i)return 0;const{staffing:s,equipment:l,training:W,distribution:U}=i.fireDepartment,_=Math.min(s,12.5),Y=Math.min(l,12.5),ge=Math.min(W,12.5),ue=Math.min(U,12.5);return _+Y+ge+ue},D=()=>{if(!i)return 0;const{capacity:s,distribution:l,alternative:W}=i.waterSupply,U=Math.min(s,20),_=Math.min(l,15),Y=Math.min(W,5);return U+_+Y},j=()=>{if(!i)return 0;const{dispatch:s,alerting:l}=i.communications,W=Math.min(s,7),U=Math.min(l,3);return W+U},E=()=>{if(!i)return 0;const{prevention:s,education:l,investigation:W}=i.communityRiskReduction,U=Math.min(s,2.5),_=Math.min(l,2),Y=Math.min(W,1);return U+_+Y},G=()=>{const s=I(),l=D(),W=j(),U=E();let _=s+l+W;const Y=s/50,ge=l/40,ue=Math.abs(Y-ge);if(ue>.1){const et=ue*10;_=Math.max(0,_-et)}return _+U},h=s=>{const l=s/105.5*100;return l>=90?1:l>=80?2:l>=70?3:l>=60?4:l>=50?5:l>=40?6:l>=30?7:l>=20?8:l>=10?9:10},m=(s,l)=>{const W=s/l*100;return W>=90?{level:"EXCELLENT",color:"#1b5e20",bg:"#e8f5e8",icon:e.jsx(te,{}),description:"Top 10% of departments"}:W>=75?{level:"GOOD",color:"#2e7d32",bg:"#f1f8e9",icon:e.jsx(te,{}),description:"Above average performance"}:W>=60?{level:"NEEDS IMPROVEMENT",color:"#ff8f00",bg:"#fff8e1",icon:e.jsx(je,{}),description:"Below average - opportunity exists"}:{level:"CRITICAL",color:"#d32f2f",bg:"#ffebee",icon:e.jsx(Ye,{}),description:"Major deficiency affecting rating"}},b=s=>{switch(s){case 1:return{color:"#1b5e20",bg:"#e8f5e8",desc:"Superior Protection",icon:e.jsx(te,{}),benchmark:"Elite - Top 1% of departments"};case 2:case 3:return{color:"#2e7d32",bg:"#f1f8e9",desc:"Excellent Protection",icon:e.jsx(te,{}),benchmark:"Top 25% of departments"};case 4:case 5:return{color:"#558b2f",bg:"#f9fbe7",desc:"Good Protection",icon:e.jsx(te,{}),benchmark:"Above average for community size"};case 6:case 7:return{color:"#ff8f00",bg:"#fff8e1",desc:"Fair Protection",icon:e.jsx(je,{}),benchmark:"Below average - improvement needed"};case 8:case 9:return{color:"#f57c00",bg:"#fff3e0",desc:"Poor Protection",icon:e.jsx(je,{}),benchmark:"Bottom 25% - significant gaps"};case 10:default:return{color:"#d32f2f",bg:"#ffebee",desc:"Inadequate Protection",icon:e.jsx(Ye,{}),benchmark:"Critical deficiencies present"}}},f=I(),R=D(),k=j(),w=E(),v=G(),O=h(v),o=b(O);return e.jsxs(r,{sx:{p:3,height:"100%",overflow:"auto"},children:[e.jsxs(r,{sx:{mb:4},children:[e.jsxs(t,{variant:"h4",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(Qe,{sx:{fontSize:40,color:"primary.main"}}),"ISO Fire Rating Assessment"]}),e.jsx(t,{variant:"subtitle1",color:"text.secondary",children:"Fire Suppression Rating Schedule (FSRS) Analysis - 105.5 Point System"})]}),e.jsx(V,{elevation:3,sx:{p:3,mb:4,background:`linear-gradient(135deg, ${o.bg} 0%, #ffffff 100%)`,border:`2px solid ${o.color}`},children:e.jsxs(g,{container:!0,spacing:3,alignItems:"center",children:[e.jsx(g,{item:!0,xs:12,md:4,children:e.jsxs(r,{sx:{textAlign:"center"},children:[e.jsx(t,{variant:"h2",sx:{color:o.color,fontWeight:"bold",mb:1},children:O}),e.jsx(L,{icon:o.icon,label:`Class ${O}`,sx:{bgcolor:o.color,color:"white",fontSize:"1.1rem",px:2,py:1}})]})}),e.jsxs(g,{item:!0,xs:12,md:8,children:[e.jsx(t,{variant:"h5",sx:{color:o.color,mb:1},children:o.desc}),e.jsxs(t,{variant:"body1",sx:{color:"text.secondary",mb:2,fontStyle:"italic"},children:["📊 ",o.benchmark]}),e.jsxs(t,{variant:"h6",gutterBottom:!0,children:["Total Score: ",v.toFixed(1)," / 105.5 points"]}),e.jsx(ee,{variant:"determinate",value:v/105.5*100,sx:{height:10,borderRadius:5,bgcolor:"rgba(0,0,0,0.1)","& .MuiLinearProgress-bar":{bgcolor:o.color}}}),e.jsxs(t,{variant:"body2",sx:{mt:1,color:"text.secondary"},children:[(v/105.5*100).toFixed(1),"% of maximum possible score"]}),O>1&&e.jsxs(r,{sx:{mt:2,p:2,bgcolor:"rgba(0,0,0,0.05)",borderRadius:1},children:[e.jsxs(t,{variant:"body2",sx:{fontWeight:"bold",color:"primary.main"},children:["🎯 Path to Class ",O-1,":"]}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:["Need ",(Math.ceil((O-1)*10.55)-v).toFixed(1)," more points",O===5&&" (90+ points for Class 4 - significant insurance savings)",O===2&&" (95+ points for Class 1 - elite rating)"]})]})]})]})}),e.jsxs(g,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(g,{item:!0,xs:12,md:6,children:e.jsx(se,{elevation:2,children:e.jsxs(ce,{children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ve,{sx:{color:"#ff5722",mr:1}}),e.jsx(t,{variant:"h6",children:"Fire Department Operations"})]}),(()=>{const s=m(f,50);return e.jsx(L,{icon:s.icon,label:s.level,size:"small",sx:{bgcolor:s.color,color:"white",fontWeight:"bold"}})})()]}),e.jsxs(t,{variant:"h4",sx:{color:"#ff5722",mb:1},children:[f.toFixed(1)," / 50"]}),e.jsxs(t,{variant:"body2",sx:{color:"text.secondary",mb:2},children:[(f/50*100).toFixed(0),"% • ",m(f,50).description]}),e.jsx(ee,{variant:"determinate",value:f/50*100,sx:{mb:2,"& .MuiLinearProgress-bar":{bgcolor:"#ff5722"}}}),e.jsxs(ie,{dense:!0,children:[e.jsxs(T,{children:[e.jsx(M,{children:(()=>{var l;const s=m(((l=i==null?void 0:i.fireDepartment)==null?void 0:l.staffing)||0,12.5);return e.jsx(r,{sx:{color:s.color},children:s.icon})})()}),e.jsx(A,{primary:`Staffing: ${((n=(a=i==null?void 0:i.fireDepartment)==null?void 0:a.staffing)==null?void 0:n.toFixed(1))||"0.0"} / 12.5`,secondary:e.jsxs(r,{children:[e.jsx(t,{variant:"caption",color:"text.secondary",children:e.jsx("strong",{children:"ISO Requirements:"})}),e.jsxs(t,{variant:"caption",sx:{display:"block",mt:.5},children:["• ",e.jsx("strong",{children:"Engine Company:"})," Minimum 3 firefighters + 1 officer (4 total)"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Ladder Company:"})," Minimum 3 firefighters + 1 officer (4 total)"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"On-Duty Staffing:"})," 24/7 coverage with sufficient personnel"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Response Goal:"})," 15 firefighters within 8 minutes for structure fires"]}),((p=i==null?void 0:i.fireDepartment)==null?void 0:p.staffing)&&i.fireDepartment.staffing<9.5&&e.jsxs(t,{variant:"caption",sx:{color:"#ff8f00",display:"block",mt:1,fontWeight:"bold"},children:["💡 Need: +",Math.ceil((9.5-i.fireDepartment.staffing)/2)," firefighters per shift"]})]})})]}),e.jsxs(T,{children:[e.jsx(M,{children:(()=>{var l;const s=m(((l=i==null?void 0:i.fireDepartment)==null?void 0:l.equipment)||0,12.5);return e.jsx(r,{sx:{color:s.color},children:s.icon})})()}),e.jsx(A,{primary:`Equipment: ${((S=(y=i==null?void 0:i.fireDepartment)==null?void 0:y.equipment)==null?void 0:S.toFixed(1))||"0.0"} / 12.5`,secondary:e.jsxs(r,{children:[e.jsx(t,{variant:"caption",color:"text.secondary",children:e.jsx("strong",{children:"ISO Equipment Requirements:"})}),e.jsxs(t,{variant:"caption",sx:{display:"block",mt:.5},children:["• ",e.jsx("strong",{children:"Engine Companies:"})," 1,000+ GPM pump, 300+ gallons water tank"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Ladder Companies:"})," 75-100 ft aerial ladder or platform"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Ground Ladders:"})," 115 ft total (various lengths)"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"SCBA:"})," 10 sets minimum per engine/ladder company"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Hose:"}),' 3,000 ft of 2½" hose per engine company']}),(C=i==null?void 0:i.fireDepartment)!=null&&C.equipment&&i.fireDepartment.equipment>=10?e.jsx(t,{variant:"caption",sx:{color:"#2e7d32",display:"block",mt:1,fontWeight:"bold"},children:"✅ Equipment meets community requirements"}):e.jsx(t,{variant:"caption",sx:{color:"#ff8f00",display:"block",mt:1,fontWeight:"bold"},children:"⚠️ Review apparatus compliance with NFPA 1901 standards"})]})})]}),e.jsxs(T,{children:[e.jsx(M,{children:(()=>{var l;const s=m(((l=i==null?void 0:i.fireDepartment)==null?void 0:l.training)||0,12.5);return e.jsx(r,{sx:{color:s.color},children:s.icon})})()}),e.jsx(A,{primary:`Training: ${((N=(P=i==null?void 0:i.fireDepartment)==null?void 0:P.training)==null?void 0:N.toFixed(1))||"0.0"} / 12.5`,secondary:e.jsxs(r,{children:[e.jsx(t,{variant:"caption",color:"text.secondary",children:e.jsx("strong",{children:"ISO Training Requirements:"})}),e.jsxs(t,{variant:"caption",sx:{display:"block",mt:.5},children:["• ",e.jsx("strong",{children:"Structure Fire:"})," 20+ hours per firefighter per month"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Basic Training:"})," Firefighter I & II certification required"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Officer Training:"})," Fire Officer I minimum for company officers"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Specialized Training:"})," Hazmat, rescue, EMS as applicable"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Documentation:"})," Detailed training records maintained"]}),(H=i==null?void 0:i.fireDepartment)!=null&&H.training&&i.fireDepartment.training<9.5?e.jsxs(t,{variant:"caption",sx:{color:"#ff8f00",display:"block",mt:1,fontWeight:"bold"},children:["📚 Need: +",Math.ceil((10-i.fireDepartment.training)*2)," additional training hours/month"]}):e.jsx(t,{variant:"caption",sx:{color:"#2e7d32",display:"block",mt:1,fontWeight:"bold"},children:"✅ Training program meets ISO standards"})]})})]}),e.jsxs(T,{children:[e.jsx(M,{children:(()=>{var l;const s=m(((l=i==null?void 0:i.fireDepartment)==null?void 0:l.distribution)||0,12.5);return e.jsx(r,{sx:{color:s.color},children:s.icon})})()}),e.jsx(A,{primary:`Distribution: ${(($=(X=i==null?void 0:i.fireDepartment)==null?void 0:X.distribution)==null?void 0:$.toFixed(1))||"0.0"} / 12.5`,secondary:e.jsxs(r,{children:[e.jsx(t,{variant:"caption",color:"text.secondary",children:e.jsx("strong",{children:"ISO Distribution Requirements:"})}),e.jsxs(t,{variant:"caption",sx:{display:"block",mt:.5},children:["• ",e.jsx("strong",{children:"Engine Coverage:"})," ≤1.5 mile road distance for engines"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Ladder Coverage:"})," ≤2.5 mile road distance for aerials"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Response Time:"})," ≤5 minutes (240 seconds) travel time"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"First Due Area:"})," ≤5 square miles per engine company"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Station Location:"})," Strategically placed for optimal coverage"]}),(q=i==null?void 0:i.fireDepartment)!=null&&q.distribution&&i.fireDepartment.distribution>=10?e.jsx(t,{variant:"caption",sx:{color:"#2e7d32",display:"block",mt:1,fontWeight:"bold"},children:"✅ Station distribution meets ISO standards"}):e.jsx(t,{variant:"caption",sx:{color:"#ff8f00",display:"block",mt:1,fontWeight:"bold"},children:"📍 Consider additional station or relocate existing station"})]})})]})]})]})})}),e.jsx(g,{item:!0,xs:12,md:6,children:e.jsx(se,{elevation:2,children:e.jsxs(ce,{children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(Ie,{sx:{color:"#2196f3",mr:1}}),e.jsx(t,{variant:"h6",children:"Water Supply"})]}),(()=>{const s=m(R,40);return e.jsx(L,{icon:s.icon,label:s.level,size:"small",sx:{bgcolor:s.color,color:"white",fontWeight:"bold"}})})()]}),e.jsxs(t,{variant:"h4",sx:{color:"#2196f3",mb:1},children:[R.toFixed(1)," / 40"]}),e.jsxs(t,{variant:"body2",sx:{color:"text.secondary",mb:2},children:[(R/40*100).toFixed(0),"% • ",m(R,40).description]}),e.jsx(ee,{variant:"determinate",value:R/40*100,sx:{mb:2,"& .MuiLinearProgress-bar":{bgcolor:"#2196f3"}}}),e.jsxs(ie,{dense:!0,children:[e.jsxs(T,{children:[e.jsx(M,{children:(()=>{var l;const s=m(((l=i==null?void 0:i.waterSupply)==null?void 0:l.capacity)||0,20);return e.jsx(r,{sx:{color:s.color},children:s.icon})})()}),e.jsx(A,{primary:`Capacity: ${((ke=(K=i==null?void 0:i.waterSupply)==null?void 0:K.capacity)==null?void 0:ke.toFixed(1))||"0.0"} / 20`,secondary:e.jsxs(r,{children:[e.jsx(t,{variant:"caption",color:"text.secondary",children:e.jsx("strong",{children:"ISO Water Flow Requirements:"})}),e.jsxs(t,{variant:"caption",sx:{display:"block",mt:.5},children:["• ",e.jsx("strong",{children:"Minimum Flow:"})," 250 GPM for 2 hours (Class 8B areas)"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Residential:"})," 500-750 GPM for typical single-family homes"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Commercial:"})," 1,500-3,500+ GPM for large buildings"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Pressure:"})," 20 PSI residual minimum during flow test"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Duration:"})," Maintain flow for minimum 2 hours"]}),(Fe=i==null?void 0:i.waterSupply)!=null&&Fe.capacity&&i.waterSupply.capacity>=15?e.jsx(t,{variant:"caption",sx:{color:"#2e7d32",display:"block",mt:1,fontWeight:"bold"},children:"✅ Water system meets ISO flow requirements"}):e.jsx(t,{variant:"caption",sx:{color:"#ff8f00",display:"block",mt:1,fontWeight:"bold"},children:"💧 Need: Water main upgrades or booster pump systems"})]})})]}),e.jsxs(T,{children:[e.jsx(M,{children:(()=>{var l;const s=m(((l=i==null?void 0:i.waterSupply)==null?void 0:l.distribution)||0,15);return e.jsx(r,{sx:{color:s.color},children:s.icon})})()}),e.jsx(A,{primary:`Distribution: ${((Pe=(Re=i==null?void 0:i.waterSupply)==null?void 0:Re.distribution)==null?void 0:Pe.toFixed(1))||"0.0"} / 15`,secondary:e.jsxs(r,{children:[e.jsx(t,{variant:"caption",color:"text.secondary",children:e.jsx("strong",{children:"ISO Hydrant Distribution Standards:"})}),e.jsxs(t,{variant:"caption",sx:{display:"block",mt:.5},children:["• ",e.jsx("strong",{children:"Spacing:"})," ≤1,000 ft from any point to nearest hydrant"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Commercial Areas:"})," ≤500 ft spacing between hydrants"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Residential Areas:"})," ≤800 ft spacing between hydrants"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Arterial Streets:"})," ≤600 ft maximum spacing"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Dead End Streets:"})," ≤500 ft from end of street"]}),(De=i==null?void 0:i.waterSupply)!=null&&De.distribution&&i.waterSupply.distribution>=12?e.jsx(t,{variant:"caption",sx:{color:"#2e7d32",display:"block",mt:1,fontWeight:"bold"},children:"✅ Hydrant distribution meets ISO standards"}):e.jsxs(t,{variant:"caption",sx:{color:"#ff8f00",display:"block",mt:1,fontWeight:"bold"},children:["🔧 Need: ",Math.ceil((12-(((we=i==null?void 0:i.waterSupply)==null?void 0:we.distribution)||0))*2)," additional hydrants"]})]})})]}),e.jsxs(T,{children:[e.jsx(M,{children:(()=>{var l;const s=m(((l=i==null?void 0:i.waterSupply)==null?void 0:l.alternative)||0,5);return e.jsx(r,{sx:{color:s.color},children:s.icon})})()}),e.jsx(A,{primary:`Alternative: ${((Ee=(Oe=i==null?void 0:i.waterSupply)==null?void 0:Oe.alternative)==null?void 0:Ee.toFixed(1))||"0.0"} / 5`,secondary:e.jsxs(r,{children:[e.jsx(t,{variant:"caption",color:"text.secondary",children:e.jsx("strong",{children:"ISO Alternative Water Supply Options:"})}),e.jsxs(t,{variant:"caption",sx:{display:"block",mt:.5},children:["• ",e.jsx("strong",{children:"Dry Hydrants:"}),' 6" minimum diameter, 500+ GPM capacity']}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Tanker Shuttles:"})," 1,000+ gallon capacity per tanker"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Static Sources:"})," Ponds, lakes with ≥30,000 gallons"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Mobile Supply:"})," Portable tanks, fold-a-tanks for operations"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Fill Sites:"})," Designated locations for tanker refill"]}),(Te=i==null?void 0:i.waterSupply)!=null&&Te.alternative&&i.waterSupply.alternative>=3?e.jsx(t,{variant:"caption",sx:{color:"#2e7d32",display:"block",mt:1,fontWeight:"bold"},children:"✅ Alternative water supply systems adequate"}):e.jsx(t,{variant:"caption",sx:{color:"#ff8f00",display:"block",mt:1,fontWeight:"bold"},children:"🚛 Need: Additional tankers or dry hydrant installation"})]})})]})]})]})})}),e.jsx(g,{item:!0,xs:12,md:6,children:e.jsx(se,{elevation:2,children:e.jsxs(ce,{children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(Se,{sx:{color:"#9c27b0",mr:1}}),e.jsx(t,{variant:"h6",children:"Emergency Communications"})]}),(()=>{const s=m(k,10);return e.jsx(L,{icon:s.icon,label:s.level,size:"small",sx:{bgcolor:s.color,color:"white",fontWeight:"bold"}})})()]}),e.jsxs(t,{variant:"h4",sx:{color:"#9c27b0",mb:1},children:[k.toFixed(1)," / 10"]}),e.jsxs(t,{variant:"body2",sx:{color:"text.secondary",mb:2},children:[(k/10*100).toFixed(0),"% • ",m(k,10).description]}),e.jsx(ee,{variant:"determinate",value:k/10*100,sx:{mb:2,"& .MuiLinearProgress-bar":{bgcolor:"#9c27b0"}}}),e.jsxs(ie,{dense:!0,children:[e.jsxs(T,{children:[e.jsx(M,{children:(()=>{var l;const s=m(((l=i==null?void 0:i.communications)==null?void 0:l.dispatch)||0,7);return e.jsx(r,{sx:{color:s.color},children:s.icon})})()}),e.jsx(A,{primary:`Dispatch: ${((Ae=(Me=i==null?void 0:i.communications)==null?void 0:Me.dispatch)==null?void 0:Ae.toFixed(1))||"0.0"} / 7`,secondary:e.jsxs(r,{children:[e.jsx(t,{variant:"caption",color:"text.secondary",children:e.jsx("strong",{children:"ISO 911 Dispatch Requirements:"})}),e.jsxs(t,{variant:"caption",sx:{display:"block",mt:.5},children:["• ",e.jsx("strong",{children:"24/7 Operations:"})," Full-time dispatchers on duty"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Call Processing:"})," Emergency calls answered within 15 seconds"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Dispatch Time:"})," Units dispatched within 60 seconds"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Equipment:"})," CAD system, mapping, multiple phone lines"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Training:"})," EMD certification, continuing education"]}),(Le=i==null?void 0:i.communications)!=null&&Le.dispatch&&i.communications.dispatch>=6?e.jsx(t,{variant:"caption",sx:{color:"#2e7d32",display:"block",mt:1,fontWeight:"bold"},children:"✅ Dispatch center meets ISO standards"}):e.jsx(t,{variant:"caption",sx:{color:"#ff8f00",display:"block",mt:1,fontWeight:"bold"},children:"📞 Need: Enhanced dispatch training and equipment upgrades"})]})})]}),e.jsxs(T,{children:[e.jsx(M,{children:(()=>{var l;const s=m(((l=i==null?void 0:i.communications)==null?void 0:l.alerting)||0,3);return e.jsx(r,{sx:{color:s.color},children:s.icon})})()}),e.jsx(A,{primary:`Alerting: ${((We=(Be=i==null?void 0:i.communications)==null?void 0:Be.alerting)==null?void 0:We.toFixed(1))||"0.0"} / 3`,secondary:e.jsxs(r,{children:[e.jsx(t,{variant:"caption",color:"text.secondary",children:e.jsx("strong",{children:"ISO Alerting System Requirements:"})}),e.jsxs(t,{variant:"caption",sx:{display:"block",mt:.5},children:["• ",e.jsx("strong",{children:"Radio System:"})," VHF/UHF digital trunked preferred"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Coverage:"})," 95%+ mobile and portable coverage area"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Backup Power:"})," 24-hour minimum battery backup"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Station Alerting:"})," Automated station notification systems"]}),(Ge=i==null?void 0:i.communications)!=null&&Ge.alerting&&i.communications.alerting>=2.5?e.jsx(t,{variant:"caption",sx:{color:"#2e7d32",display:"block",mt:1,fontWeight:"bold"},children:"✅ Communication systems meet ISO standards"}):e.jsx(t,{variant:"caption",sx:{color:"#ff8f00",display:"block",mt:1,fontWeight:"bold"},children:"📡 Need: Radio system upgrades or coverage improvements"})]})})]})]})]})})}),e.jsx(g,{item:!0,xs:12,md:6,children:e.jsx(se,{elevation:2,children:e.jsxs(ce,{children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(Ce,{sx:{color:"#4caf50",mr:1}}),e.jsx(t,{variant:"h6",children:"Community Risk Reduction"}),e.jsx(L,{label:"BONUS",size:"small",sx:{ml:1,bgcolor:"#4caf50",color:"white"}})]}),(()=>{const s=m(w,5.5);return e.jsx(L,{icon:s.icon,label:s.level,size:"small",sx:{bgcolor:s.color,color:"white",fontWeight:"bold"}})})()]}),e.jsxs(t,{variant:"h4",sx:{color:"#4caf50",mb:1},children:[w.toFixed(1)," / 5.5"]}),e.jsxs(t,{variant:"body2",sx:{color:"text.secondary",mb:2},children:[(w/5.5*100).toFixed(0),"% • Bonus points toward total score"]}),e.jsx(ee,{variant:"determinate",value:w/5.5*100,sx:{mb:2,"& .MuiLinearProgress-bar":{bgcolor:"#4caf50"}}}),e.jsxs(ie,{dense:!0,children:[e.jsxs(T,{children:[e.jsx(M,{children:(()=>{var l;const s=m(((l=i==null?void 0:i.communityRiskReduction)==null?void 0:l.prevention)||0,2.5);return e.jsx(r,{sx:{color:s.color},children:s.icon})})()}),e.jsx(A,{primary:`Prevention: ${((qe=($e=i==null?void 0:i.communityRiskReduction)==null?void 0:$e.prevention)==null?void 0:qe.toFixed(1))||"0.0"} / 2.5`,secondary:e.jsxs(r,{children:[e.jsx(t,{variant:"caption",color:"text.secondary",children:e.jsx("strong",{children:"ISO Fire Prevention Requirements:"})}),e.jsxs(t,{variant:"caption",sx:{display:"block",mt:.5},children:["• ",e.jsx("strong",{children:"Fire Inspector:"})," Certified fire inspector on staff"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Code Enforcement:"})," Adopt current fire codes (IFC/NFPA)"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Plan Review:"})," Review building plans for fire safety"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Inspections:"})," Annual inspections of commercial buildings"]}),(ze=i==null?void 0:i.communityRiskReduction)!=null&&ze.prevention&&i.communityRiskReduction.prevention>=2?e.jsx(t,{variant:"caption",sx:{color:"#2e7d32",display:"block",mt:1,fontWeight:"bold"},children:"✅ Fire prevention program meets ISO standards"}):e.jsx(t,{variant:"caption",sx:{color:"#ff8f00",display:"block",mt:1,fontWeight:"bold"},children:"🔍 Need: Certified fire inspector and active inspection program"})]})})]}),e.jsxs(T,{children:[e.jsx(M,{children:(()=>{var l;const s=m(((l=i==null?void 0:i.communityRiskReduction)==null?void 0:l.education)||0,2);return e.jsx(r,{sx:{color:s.color},children:s.icon})})()}),e.jsx(A,{primary:`Education: ${((He=(Ne=i==null?void 0:i.communityRiskReduction)==null?void 0:Ne.education)==null?void 0:He.toFixed(1))||"0.0"} / 2`,secondary:e.jsxs(r,{children:[e.jsx(t,{variant:"caption",color:"text.secondary",children:e.jsx("strong",{children:"ISO Public Education Requirements:"})}),e.jsxs(t,{variant:"caption",sx:{display:"block",mt:.5},children:["• ",e.jsx("strong",{children:"School Programs:"})," Fire safety education in schools K-12"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Public Outreach:"})," Community fire safety events/programs"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"High-Risk Groups:"})," Senior citizens, disabled residents"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Documentation:"})," Maintain records of education activities"]}),(Ue=i==null?void 0:i.communityRiskReduction)!=null&&Ue.education&&i.communityRiskReduction.education>=1.5?e.jsx(t,{variant:"caption",sx:{color:"#2e7d32",display:"block",mt:1,fontWeight:"bold"},children:"✅ Public education program meets ISO standards"}):e.jsx(t,{variant:"caption",sx:{color:"#ff8f00",display:"block",mt:1,fontWeight:"bold"},children:"🏫 Need: Expand school programs and community outreach"})]})})]}),e.jsxs(T,{children:[e.jsx(M,{children:(()=>{var l;const s=m(((l=i==null?void 0:i.communityRiskReduction)==null?void 0:l.investigation)||0,1);return e.jsx(r,{sx:{color:s.color},children:s.icon})})()}),e.jsx(A,{primary:`Investigation: ${((Ve=(_e=i==null?void 0:i.communityRiskReduction)==null?void 0:_e.investigation)==null?void 0:Ve.toFixed(1))||"0.0"} / 1`,secondary:e.jsxs(r,{children:[e.jsx(t,{variant:"caption",color:"text.secondary",children:e.jsx("strong",{children:"ISO Fire Investigation Requirements:"})}),e.jsxs(t,{variant:"caption",sx:{display:"block",mt:.5},children:["• ",e.jsx("strong",{children:"Trained Investigator:"})," Fire investigator certification"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Origin & Cause:"})," Determine fire cause and origin"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Documentation:"})," Detailed investigation reports"]}),e.jsxs(t,{variant:"caption",sx:{display:"block"},children:["• ",e.jsx("strong",{children:"Evidence Collection:"})," Proper evidence handling procedures"]}),(Xe=i==null?void 0:i.communityRiskReduction)!=null&&Xe.investigation&&i.communityRiskReduction.investigation>=.8?e.jsx(t,{variant:"caption",sx:{color:"#2e7d32",display:"block",mt:1,fontWeight:"bold"},children:"✅ Fire investigation program meets ISO standards"}):e.jsx(t,{variant:"caption",sx:{color:"#ff8f00",display:"block",mt:1,fontWeight:"bold"},children:"🔍 Need: Train certified fire investigator"})]})})]})]})]})})})]}),!i&&e.jsxs(V,{elevation:1,sx:{p:3,textAlign:"center",bgcolor:"#f5f5f5"},children:[e.jsx(t,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No Assessment Data"}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Use the sidebar to input your fire department's capabilities and generate an ISO score assessment."})]})]})},$t=({assessment:i,currentScore:c,classification:d,communityProfile:x})=>{const[u,I]=B.useState([]),[D,j]=B.useState(!1),[E,G]=B.useState(!0),[h,m]=B.useState({firefighterAnnualCost:75e3,apparatusCost:8e5,trainingProgramCost:8e3,hydrantInstallationCost:12e3,waterSystemUpgradeCost:15e5,constructionMultiplier:1}),b=(n,p)=>{m(y=>({...y,[n]:p}))},f=()=>{if(!i)return[];const n=[];return i.fireDepartment.staffing<10&&n.push({category:"Fire Department",subcategory:"Staffing",title:"Increase Minimum Staffing Levels",description:"Add firefighters to meet NFPA 1720 minimum staffing requirements for initial response",pointsGain:10-i.fireDepartment.staffing,estimatedCost:(10-i.fireDepartment.staffing)*h.firefighterAnnualCost,implementationTime:"6-12 months",priority:"HIGH",difficulty:"COMPLEX",requirements:["Budget approval from city council","Recruitment and hiring process","Training and certification programs","Additional equipment and PPE"],benefits:["Faster initial response times","Improved firefighter safety","Better emergency scene management","Enhanced public confidence"],fundingSources:["FEMA Assistance to Firefighters Grant (AFG)","FEMA Staffing for Adequate Fire and Emergency Response (SAFER)","State fire department grants","Municipal bond financing"]}),i.fireDepartment.training<10&&n.push({category:"Fire Department",subcategory:"Training",title:"Implement Structured Training Program",description:"Establish documented training program with minimum 20 hours monthly per firefighter",pointsGain:10-i.fireDepartment.training,estimatedCost:h.trainingProgramCost,implementationTime:"3-6 months",priority:"HIGH",difficulty:"MODERATE",requirements:["Training officer designation","Training facility or agreements","Record keeping system","Curriculum development"],benefits:["Improved firefighter competency","Better emergency outcomes","Reduced liability exposure","ISO credit improvement"],fundingSources:["FEMA AFG Training grants","State fire training academies","Regional training consortiums","Municipal training budgets"]}),i.fireDepartment.equipment<10&&n.push({category:"Fire Department",subcategory:"Equipment",title:"Upgrade Apparatus and Equipment",description:"Purchase NFPA 1901 compliant apparatus and maintain proper equipment inventory",pointsGain:10-i.fireDepartment.equipment,estimatedCost:h.apparatusCost,implementationTime:"12-24 months",priority:"HIGH",difficulty:"COMPLEX",requirements:["Capital improvement planning","Specifications development","Procurement process","Training on new equipment"],benefits:["Improved fire suppression capability","Enhanced equipment reliability","Better firefighter safety","Community protection upgrade"],fundingSources:["FEMA AFG Equipment grants","Municipal bonds","State equipment grants","Regional equipment sharing"]}),i.waterSupply.capacity<15&&n.push({category:"Water Supply",subcategory:"Capacity",title:"Improve Water System Capacity",description:"Upgrade water mains and pumping capacity to meet fire flow requirements",pointsGain:15-i.waterSupply.capacity,estimatedCost:h.waterSystemUpgradeCost*h.constructionMultiplier,implementationTime:"18-36 months",priority:"HIGH",difficulty:"COMPLEX",requirements:["Water system engineering study","Municipal utility coordination","Construction permits","Public works coordination"],benefits:["Increased fire suppression capability","Better residential water pressure","Enhanced commercial protection","Significant ISO improvement"],fundingSources:["EPA Drinking Water State Revolving Fund","USDA Rural Development grants","Municipal utility bonds","State infrastructure grants"]}),i.waterSupply.distribution<12&&n.push({category:"Water Supply",subcategory:"Distribution",title:"Install Additional Fire Hydrants",description:"Add hydrants to reduce spacing and improve coverage areas",pointsGain:12-i.waterSupply.distribution,estimatedCost:(12-i.waterSupply.distribution)*h.hydrantInstallationCost*h.constructionMultiplier,implementationTime:"6-12 months",priority:"MEDIUM",difficulty:"MODERATE",requirements:["Hydrant spacing analysis","Water main connections","Installation permits","Ongoing maintenance program"],benefits:["Reduced hose lay distances","Faster fire attack setup","Better neighborhood protection","Lower insurance rates for residents"],fundingSources:["Municipal capital improvements","Water utility funds","Community development grants","Special assessment districts"]}),i.communications.dispatch<6&&n.push({category:"Communications",subcategory:"Dispatch",title:"Improve Dispatch Operations",description:"Upgrade dispatch protocols, training, and equipment for faster call processing",pointsGain:6-i.communications.dispatch,estimatedCost:15e4*h.constructionMultiplier,implementationTime:"6-12 months",priority:"MEDIUM",difficulty:"MODERATE",requirements:["Dispatch training enhancement","Protocol documentation","Equipment upgrades","Quality assurance program"],benefits:["Faster emergency response","Better call processing times","Improved coordination","Enhanced public safety"],fundingSources:["FEMA Emergency Communications grants","State 911 improvement funds","Regional communications consortiums","Municipal emergency services budget"]}),i.communityRiskReduction.prevention<2&&n.push({category:"Community Risk Reduction",subcategory:"Prevention",title:"Establish Fire Prevention Program",description:"Implement code enforcement and fire prevention inspection program",pointsGain:2-i.communityRiskReduction.prevention,estimatedCost:85e3*h.constructionMultiplier,implementationTime:"6-12 months",priority:"LOW",difficulty:"MODERATE",requirements:["Fire prevention officer training","Code adoption and enforcement","Inspection scheduling system","Public education materials"],benefits:["Reduced fire incidents","Better building code compliance","Enhanced community safety","Bonus ISO points"],fundingSources:["FEMA Fire Prevention grants","Municipal code enforcement budget","State fire prevention programs","Community foundation grants"]}),n.sort((p,y)=>{const S={HIGH:3,MEDIUM:2,LOW:1},C=S[p.priority],P=S[y.priority];if(C!==P)return P-C;const N=p.pointsGain/p.estimatedCost;return y.pointsGain/y.estimatedCost-N})},R=n=>{const y=n*.07,S=x.population*.4*x.avgHomePremium*y,C=x.commercialPremiums*y;return S+C},k=()=>{const p=f().filter(q=>u.includes(q.title)),y=p.reduce((q,K)=>q+K.estimatedCost,0),S=p.reduce((q,K)=>q+K.pointsGain,0),C=c+S,P=w(c),N=w(C),H=Math.max(0,P-N),X=R(H),$=y/Math.max(X,1);return{totalCost:y,totalPointsGain:S,newScore:C,newClass:N,classImprovement:H,annualSavings:X,paybackPeriod:$}},w=n=>{const p=n/105.5*100;return p>=90?1:p>=80?2:p>=70?3:p>=60?4:p>=50?5:p>=40?6:p>=30?7:p>=20?8:p>=10?9:10},v=n=>{switch(n){case"HIGH":return"#d32f2f";case"MEDIUM":return"#ff8f00";case"LOW":return"#2e7d32";default:return"#757575"}},O=n=>{switch(n){case"Fire Department":return e.jsx(ve,{});case"Water Supply":return e.jsx(Ie,{});case"Communications":return e.jsx(Se,{});case"Community Risk Reduction":return e.jsx(Ce,{});default:return e.jsx(be,{})}},o=n=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(n),a=f();return k(),i?e.jsxs(r,{sx:{p:3},children:[e.jsxs(r,{sx:{mb:3},children:[e.jsx(t,{variant:"h4",gutterBottom:!0,children:"ISO Improvement Planner"}),e.jsx(t,{variant:"body1",color:"text.secondary",children:"Strategic recommendations to improve your ISO classification with cost-benefit analysis"})]}),e.jsx(V,{sx:{p:3,mb:3},children:e.jsxs(g,{container:!0,spacing:3,children:[e.jsx(g,{item:!0,xs:12,md:4,children:e.jsxs(r,{sx:{textAlign:"center"},children:[e.jsx(t,{variant:"h6",color:"text.secondary",children:"Current Score"}),e.jsx(t,{variant:"h3",color:"primary",children:c.toFixed(1)}),e.jsx(t,{variant:"body2",children:"out of 105.5 points"})]})}),e.jsx(g,{item:!0,xs:12,md:4,children:e.jsxs(r,{sx:{textAlign:"center"},children:[e.jsx(t,{variant:"h6",color:"text.secondary",children:"Current Classification"}),e.jsxs(t,{variant:"h3",color:"primary",children:["Class ",d]}),e.jsx(t,{variant:"body2",children:"ISO rating"})]})}),e.jsx(g,{item:!0,xs:12,md:4,children:e.jsxs(r,{sx:{textAlign:"center"},children:[e.jsx(t,{variant:"h6",color:"text.secondary",children:"Improvement Opportunities"}),e.jsx(t,{variant:"h3",color:"secondary",children:a.length}),e.jsx(t,{variant:"body2",children:"recommendations available"})]})})]})}),e.jsxs(re,{sx:{mb:3},expanded:E,onChange:()=>G(!E),children:[e.jsx(ne,{expandIcon:e.jsx(oe,{}),children:e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(mt,{color:"primary"}),e.jsxs(r,{children:[e.jsx(t,{variant:"h6",children:"Customize Cost Parameters"}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Adjust costs based on your regional market conditions and department specifications"})]})]})}),e.jsxs(ae,{children:[e.jsxs(g,{container:!0,spacing:4,children:[e.jsxs(g,{item:!0,xs:12,md:6,children:[e.jsxs(J,{fullWidth:!0,sx:{mb:3},children:[e.jsxs(Q,{children:["Firefighter Annual Cost (salary + benefits): ",o(h.firefighterAnnualCost)]}),e.jsx(F,{value:h.firefighterAnnualCost,onChange:(n,p)=>b("firefighterAnnualCost",p),min:4e4,max:12e4,step:5e3,valueLabelDisplay:"auto",valueLabelFormat:o,marks:[{value:4e4,label:"$40k"},{value:75e3,label:"$75k"},{value:12e4,label:"$120k"}]}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Rural departments: $40-60k | Suburban: $60-85k | Urban/High COL: $85-120k"})]}),e.jsxs(J,{fullWidth:!0,sx:{mb:3},children:[e.jsxs(Q,{children:["Fire Apparatus Cost (per unit): ",o(h.apparatusCost)]}),e.jsx(F,{value:h.apparatusCost,onChange:(n,p)=>b("apparatusCost",p),min:2e5,max:3e6,step:5e4,valueLabelDisplay:"auto",valueLabelFormat:o,marks:[{value:2e5,label:"$200k"},{value:8e5,label:"$800k"},{value:15e5,label:"$1.5M"},{value:27e5,label:"$2.7M"},{value:3e6,label:"$3M"}]}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Engine: $200-600k | Pumper: $400-800k | Ladder: $750k-2.7M | Specialty: $1M-3M (cost per apparatus - departments typically need multiple units)"})]}),e.jsxs(J,{fullWidth:!0,sx:{mb:3},children:[e.jsxs(Q,{children:["Training Program Implementation: ",o(h.trainingProgramCost)]}),e.jsx(F,{value:h.trainingProgramCost,onChange:(n,p)=>b("trainingProgramCost",p),min:2e3,max:2e4,step:1e3,valueLabelDisplay:"auto",valueLabelFormat:o,marks:[{value:2e3,label:"$2k"},{value:8e3,label:"$8k"},{value:2e4,label:"$20k"}]}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Basic program: $2-5k | Comprehensive: $8-15k | Advanced multi-discipline: $15-20k"})]})]}),e.jsxs(g,{item:!0,xs:12,md:6,children:[e.jsxs(J,{fullWidth:!0,sx:{mb:3},children:[e.jsxs(Q,{children:["Hydrant Installation Cost: ",o(h.hydrantInstallationCost)]}),e.jsx(F,{value:h.hydrantInstallationCost,onChange:(n,p)=>b("hydrantInstallationCost",p),min:6e3,max:25e3,step:1e3,valueLabelDisplay:"auto",valueLabelFormat:o,marks:[{value:6e3,label:"$6k"},{value:12e3,label:"$12k"},{value:25e3,label:"$25k"}]}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Easy access: $6-10k | Standard: $10-15k | Difficult terrain/deep lines: $15-25k"})]}),e.jsxs(J,{fullWidth:!0,sx:{mb:3},children:[e.jsxs(Q,{children:["Water System Upgrade: ",o(h.waterSystemUpgradeCost)]}),e.jsx(F,{value:h.waterSystemUpgradeCost,onChange:(n,p)=>b("waterSystemUpgradeCost",p),min:8e5,max:5e6,step:1e5,valueLabelDisplay:"auto",valueLabelFormat:n=>`$${(n/1e6).toFixed(1)}M`,marks:[{value:8e5,label:"$0.8M"},{value:15e5,label:"$1.5M"},{value:5e6,label:"$5M"}]}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Minor upgrades: $0.8-1.2M | Major infrastructure: $1.5-3M | Complete overhaul: $3-5M"})]}),e.jsxs(J,{fullWidth:!0,sx:{mb:3},children:[e.jsxs(Q,{children:["Regional Cost Multiplier: ",h.constructionMultiplier.toFixed(1),"x"]}),e.jsx(F,{value:h.constructionMultiplier,onChange:(n,p)=>b("constructionMultiplier",p),min:.7,max:1.8,step:.1,valueLabelDisplay:"auto",marks:[{value:.7,label:"0.7x"},{value:1,label:"1.0x"},{value:1.5,label:"1.5x"},{value:1.8,label:"1.8x"}]}),e.jsx(t,{variant:"caption",color:"text.secondary",children:"Rural/Low COL: 0.7-0.9x | National average: 1.0x | High COL areas: 1.2-1.8x"})]})]})]}),e.jsx(fe,{severity:"info",sx:{mt:2},children:e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Regional Examples:"})," Rural Alabama (0.7x), National Average (1.0x), San Francisco Bay Area (1.6x), Manhattan (1.8x). Adjust based on local contractor quotes and labor market conditions."]})})]})]}),e.jsxs(t,{variant:"h5",gutterBottom:!0,sx:{mt:4,mb:2},children:["Improvement Recommendations",e.jsx(t,{variant:"body2",color:"text.secondary",component:"span",sx:{ml:2},children:"(Updated with your cost parameters)"})]}),a.map((n,p)=>e.jsxs(re,{sx:{mb:2},children:[e.jsx(ne,{expandIcon:e.jsx(oe,{}),children:e.jsxs(r,{sx:{display:"flex",alignItems:"center",width:"100%"},children:[e.jsx(r,{sx:{mr:2},children:O(n.category)}),e.jsxs(r,{sx:{flexGrow:1},children:[e.jsx(t,{variant:"h6",children:n.title}),e.jsxs(r,{sx:{display:"flex",gap:1,mt:1},children:[e.jsx(L,{label:n.priority,size:"small",sx:{backgroundColor:v(n.priority),color:"white"}}),e.jsx(L,{label:`+${n.pointsGain} points`,size:"small",color:"primary"}),e.jsx(L,{label:o(n.estimatedCost),size:"small",variant:"outlined"})]})]})]})}),e.jsx(ae,{children:e.jsxs(g,{container:!0,spacing:3,children:[e.jsxs(g,{item:!0,xs:12,md:8,children:[e.jsx(t,{variant:"body1",paragraph:!0,children:n.description}),e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Requirements"}),e.jsx(ie,{dense:!0,children:n.requirements.map((y,S)=>e.jsxs(T,{children:[e.jsx(M,{children:e.jsx(te,{fontSize:"small"})}),e.jsx(A,{primary:y})]},S))}),e.jsx(t,{variant:"h6",gutterBottom:!0,sx:{mt:2},children:"Benefits"}),e.jsx(ie,{dense:!0,children:n.benefits.map((y,S)=>e.jsxs(T,{children:[e.jsx(M,{children:e.jsx(be,{fontSize:"small",color:"primary"})}),e.jsx(A,{primary:y})]},S))})]}),e.jsx(g,{item:!0,xs:12,md:4,children:e.jsx(se,{variant:"outlined",children:e.jsxs(ce,{children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Project Details"}),e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(At,{sx:{mr:1}}),e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Cost:"})," ",o(n.estimatedCost)]})]}),e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(ft,{sx:{mr:1}}),e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Timeline:"})," ",n.implementationTime]})]}),e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(Bt,{sx:{mr:1}}),e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Difficulty:"})," ",n.difficulty]})]}),e.jsx(t,{variant:"subtitle2",gutterBottom:!0,children:"Funding Sources"}),n.fundingSources.map((y,S)=>e.jsx(L,{label:y,size:"small",variant:"outlined",sx:{mr:.5,mb:.5}},S))]})})})]})})]},p)),e.jsx(r,{sx:{mt:4,textAlign:"center"},children:e.jsxs(le,{variant:"contained",color:"secondary",size:"large",startIcon:e.jsx(gt,{}),onClick:()=>j(!D),children:[D?"Hide":"Show"," Cost-Benefit Analysis"]})}),D&&e.jsxs(V,{sx:{p:3,mt:3},children:[e.jsx(t,{variant:"h5",gutterBottom:!0,children:"Community Insurance Savings Analysis"}),e.jsx(fe,{severity:"info",sx:{mb:3},children:e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Cost-Benefit Analysis Disclaimer:"})," ISO classification improvements typically reduce property insurance premiums by 3-10% per class improvement (industry-validated). Cost estimates are based on national averages and should be refined with local contractor quotes. Actual savings vary by insurance company - some insurers don't use ISO ratings."]})}),e.jsxs(g,{container:!0,spacing:3,children:[e.jsxs(g,{item:!0,xs:12,md:6,children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Implementation Costs"}),e.jsx(jt,{children:e.jsxs(yt,{size:"small",children:[e.jsx(bt,{children:e.jsxs(ye,{children:[e.jsx(Z,{children:"Category"}),e.jsx(Z,{align:"right",children:"Estimated Cost"})]})}),e.jsxs(vt,{children:[a.slice(0,5).map((n,p)=>e.jsxs(ye,{children:[e.jsx(Z,{children:n.title}),e.jsx(Z,{align:"right",children:o(n.estimatedCost)})]},p)),e.jsxs(ye,{children:[e.jsx(Z,{children:e.jsx("strong",{children:"Total Estimated Cost"})}),e.jsx(Z,{align:"right",children:e.jsx("strong",{children:o(a.reduce((n,p)=>n+p.estimatedCost,0))})})]})]})]})})]}),e.jsxs(g,{item:!0,xs:12,md:6,children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Projected Benefits"}),e.jsxs(r,{sx:{mb:2},children:[e.jsxs(t,{variant:"body2",color:"text.secondary",children:["Current Classification: Class ",d]}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:["Projected Classification: Class ",Math.max(1,d-2)]}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:["Classification Improvement: ",Math.min(2,d-1)," classes"]})]}),e.jsx(se,{variant:"outlined",children:e.jsxs(ce,{children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(St,{sx:{mr:1,color:"primary.main"}}),e.jsx(t,{variant:"h6",children:"Annual Community Savings"})]}),e.jsx(t,{variant:"h4",color:"primary",gutterBottom:!0,children:o(R(Math.min(2,d-1)))}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:["Based on ",x.population.toLocaleString()," residents and average premiums"]}),e.jsx(Ct,{sx:{my:2}}),e.jsxs(t,{variant:"body2",children:[e.jsx("strong",{children:"Payback Period:"})," ",(a.reduce((n,p)=>n+p.estimatedCost,0)/R(Math.min(2,d-1))).toFixed(1)," years"]})]})})]})]})]})]}):e.jsx(r,{sx:{p:3,textAlign:"center"},children:e.jsx(t,{variant:"h6",color:"text.secondary",children:"Complete your ISO assessment to see improvement recommendations"})})};let qt=class{constructor(c,d){pe(this,"pdf");pe(this,"config");pe(this,"data");pe(this,"yPosition",20);this.pdf=new It("portrait","mm","a4"),this.config=c,this.data=d,console.log("📋 PDF DEBUG: autoTable import:",typeof he),typeof he=="function"?(this.pdf.autoTable=he.bind(null,this.pdf),console.log("📋 PDF DEBUG: ✅ autoTable attached successfully")):console.error("📋 PDF DEBUG: ❌ autoTable is not a function:",he)}generateReport(){return new Promise((c,d)=>{try{console.log("🚀 GENERATING ISO CREDIT CALCULATOR REPORT"),this.addHeader(),this.addExecutiveSummary(),this.addISOScoreBreakdown(),this.addComplianceAnalysis(),this.addRecommendations();const x=new Blob([this.pdf.output("blob")],{type:"application/pdf"});console.log("✅ ISO PDF REPORT GENERATED SUCCESSFULLY"),c(x)}catch(x){console.error("❌ ISO PDF GENERATION ERROR:",x),d(x)}})}addHeader(){try{if(this.config.logoDataUrl)try{this.pdf.addImage(this.config.logoDataUrl,"PNG",15,15,25,25)}catch(c){console.warn("Could not add department logo:",c)}this.pdf.setFontSize(20),this.pdf.setFont("helvetica","bold"),this.pdf.text("ISO Fire Suppression Rating Report",50,25),this.pdf.setFontSize(14),this.pdf.setFont("helvetica","normal"),this.pdf.text(this.config.departmentName,50,32),this.pdf.text(`Fire Chief: ${this.config.chiefName}`,50,38),this.pdf.text(`Report Date: ${this.config.reportDate}`,50,44),this.pdf.setLineWidth(.5),this.pdf.line(15,50,195,50),this.yPosition=60}catch(c){console.error("Error adding header:",c),this.yPosition=60}}addExecutiveSummary(){try{this.pdf.setFontSize(16),this.pdf.setFont("helvetica","bold"),this.pdf.text("Executive Summary",15,this.yPosition),this.yPosition+=10,this.pdf.setFontSize(12),this.pdf.setFont("helvetica","normal"),[`Current ISO Classification: Class ${this.data.classification}`,`Total Score: ${this.data.currentScore.toFixed(1)} out of 105.5 points`,`Overall Performance: ${this.getPerformanceLevel()}`,"","This report provides a comprehensive analysis of your fire department's","ISO Fire Suppression Rating Schedule (FSRS) compliance and identifies","specific opportunities for classification improvement."].forEach(d=>{this.pdf.text(d,15,this.yPosition),this.yPosition+=6}),this.yPosition+=10}catch(c){console.error("Error adding executive summary:",c),this.yPosition+=50}}addISOScoreBreakdown(){try{this.pdf.setFontSize(16),this.pdf.setFont("helvetica","bold"),this.pdf.text("ISO Score Breakdown",15,this.yPosition),this.yPosition+=10;const c=[["Fire Department Operations","50.0",this.getTotalFireDeptScore().toFixed(1),this.getComplianceStatus(this.getTotalFireDeptScore(),50)],["Water Supply","40.0",this.getTotalWaterSupplyScore().toFixed(1),this.getComplianceStatus(this.getTotalWaterSupplyScore(),40)],["Emergency Communications","10.0",this.getTotalCommunicationsScore().toFixed(1),this.getComplianceStatus(this.getTotalCommunicationsScore(),10)],["Community Risk Reduction","5.5",this.getTotalCRRScore().toFixed(1),this.getComplianceStatus(this.getTotalCRRScore(),5.5)],["","","",""],["TOTAL SCORE","105.5",this.data.currentScore.toFixed(1),`Class ${this.data.classification}`]];this.pdf.autoTable?(this.pdf.autoTable({startY:this.yPosition,head:[["Category","Max Points","Current Score","Status"]],body:c,styles:{fontSize:10,cellPadding:3},headStyles:{fillColor:[41,128,185],textColor:255,fontStyle:"bold"},columnStyles:{0:{cellWidth:80},1:{cellWidth:30,halign:"center"},2:{cellWidth:30,halign:"center"},3:{cellWidth:40,halign:"center"}},didParseCell:d=>{d.row.index===c.length-1&&(d.cell.styles.fillColor=[241,196,15],d.cell.styles.fontStyle="bold")}}),this.yPosition=this.pdf.lastAutoTable.finalY+15):(console.warn("AutoTable not available, using text fallback"),this.addTextFallbackTable("ISO Score Breakdown",c))}catch(c){console.error("Could not create ISO score breakdown table:",c),this.addTextFallbackTable("ISO Score Breakdown",[])}}addComplianceAnalysis(){try{this.pdf.setFontSize(16),this.pdf.setFont("helvetica","bold"),this.pdf.text("Compliance Analysis",15,this.yPosition),this.yPosition+=10,this.pdf.setFontSize(12),this.pdf.setFont("helvetica","normal"),this.generateComplianceAnalysis().forEach(d=>{this.pdf.text(d,15,this.yPosition),this.yPosition+=6}),this.yPosition+=10}catch(c){console.error("Error adding compliance analysis:",c),this.yPosition+=30}}addRecommendations(){try{this.pdf.setFontSize(16),this.pdf.setFont("helvetica","bold"),this.pdf.text("Improvement Recommendations",15,this.yPosition),this.yPosition+=10,this.pdf.setFontSize(12),this.pdf.setFont("helvetica","normal"),this.generateRecommendations().forEach(d=>{this.pdf.text(`• ${d}`,20,this.yPosition),this.yPosition+=6})}catch(c){console.error("Error adding recommendations:",c),this.yPosition+=30}}addTextFallbackTable(c,d){this.pdf.setFontSize(12),this.pdf.setFont("helvetica","bold"),this.pdf.text(c,15,this.yPosition),this.yPosition+=10,this.pdf.setFont("helvetica","normal"),this.pdf.text("(Professional table format not available - data summary)",15,this.yPosition),this.yPosition+=10,d.forEach(x=>{x.length>0&&(this.pdf.text(x.join(" | "),20,this.yPosition),this.yPosition+=5)}),this.yPosition+=10}getTotalFireDeptScore(){return this.data.assessment.fireDepartment.staffing+this.data.assessment.fireDepartment.equipment+this.data.assessment.fireDepartment.training+this.data.assessment.fireDepartment.distribution}getTotalWaterSupplyScore(){return this.data.assessment.waterSupply.capacity+this.data.assessment.waterSupply.distribution+this.data.assessment.waterSupply.alternative}getTotalCommunicationsScore(){return this.data.assessment.communications.dispatch+this.data.assessment.communications.alerting}getTotalCRRScore(){return this.data.assessment.communityRiskReduction.prevention+this.data.assessment.communityRiskReduction.education+this.data.assessment.communityRiskReduction.investigation}getPerformanceLevel(){const c=this.data.currentScore/105.5*100;return c>=90?"Excellent (Class 1-2)":c>=70?"Good (Class 3-4)":c>=50?"Fair (Class 5-6)":"Needs Improvement (Class 7-10)"}getComplianceStatus(c,d){const x=c/d*100;return x>=90?"Excellent":x>=70?"Good":x>=50?"Fair":"Poor"}generateComplianceAnalysis(){const c=[];c.push(`Your department achieved ${this.data.currentScore.toFixed(1)} out of 105.5 possible points,`),c.push(`resulting in a Class ${this.data.classification} ISO rating.`),c.push("");const d=this.getTotalFireDeptScore();c.push(`Fire Department Operations: ${d.toFixed(1)}/50.0 points (${(d/50*100).toFixed(1)}%)`);const x=this.getTotalWaterSupplyScore();c.push(`Water Supply: ${x.toFixed(1)}/40.0 points (${(x/40*100).toFixed(1)}%)`);const u=this.getTotalCommunicationsScore();return c.push(`Communications: ${u.toFixed(1)}/10.0 points (${(u/10*100).toFixed(1)}%)`),c}generateRecommendations(){const c=[],d=this.getTotalFireDeptScore(),x=this.getTotalWaterSupplyScore();return d<40&&c.push("Focus on fire department operations - consider staffing and equipment upgrades"),x<30&&c.push("Water supply improvements could significantly impact your ISO rating"),this.data.classification>=6&&c.push("Consider comprehensive assessment with ISO improvement consultant"),c.push("Regular training and equipment maintenance support continued compliance"),c}};const zt=({open:i,onClose:c,assessment:d,score:x,classification:u})=>{const[I,D]=B.useState(!1),[j,E]=B.useState("Fire Department"),[G,h]=B.useState("Fire Chief"),m=async()=>{console.log("🏆 Generating ISO Credit Report:",{assessment:d,score:x,classification:u}),D(!0);try{const b={template:"iso_assessment_report",departmentName:j,chiefName:G,reportDate:new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})},f={currentScore:x,classification:u,assessment:d,communityProfile:{population:25e3,avgHomePremium:1200,commercialPremiums:125e3}},k=await new qt(b,f).generateReport(),w=URL.createObjectURL(k),v=document.createElement("a");v.href=w,v.download=`ISO_Assessment_Report_${j.replace(/\s+/g,"_")}_${new Date().toISOString().split("T")[0]}.pdf`,document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(w),console.log("✅ ISO PDF Report generated successfully")}catch(b){console.error("❌ ISO PDF generation failed:",b),alert("Failed to generate PDF report. Please try again.")}finally{D(!1)}};return e.jsxs(lt,{open:i,onClose:c,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{minHeight:"60vh"}},children:[e.jsx(dt,{children:e.jsxs(r,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(t,{variant:"h6",children:"ISO Credit Report Generator"}),e.jsx(le,{onClick:c,size:"small",sx:{minWidth:"auto",p:1},children:e.jsx(Ft,{})})]})}),e.jsxs(pt,{children:[e.jsx(fe,{severity:"success",sx:{mb:3},children:"Generate professional PDF reports for ISO assessments with customizable department information."}),e.jsxs(V,{elevation:1,sx:{p:3,mb:3},children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Department Information"}),e.jsxs(g,{container:!0,spacing:2,children:[e.jsx(g,{item:!0,xs:12,md:6,children:e.jsx(Ke,{fullWidth:!0,label:"Department Name",value:j,onChange:b=>E(b.target.value),variant:"outlined",placeholder:"Houston Fire Department"})}),e.jsx(g,{item:!0,xs:12,md:6,children:e.jsx(Ke,{fullWidth:!0,label:"Fire Chief Name",value:G,onChange:b=>h(b.target.value),variant:"outlined",placeholder:"Fire Chief John Smith"})})]})]}),e.jsxs(V,{elevation:1,sx:{p:3,mb:3},children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Report Features:"}),e.jsx(t,{component:"div",variant:"body1",children:e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"ISO Classification Analysis"})," - Current score breakdown and classification"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Category Performance"})," - Fire Department, Water Supply, Communications, CRR"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Compliance Analysis"})," - Detailed performance assessment"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Improvement Recommendations"})," - Specific areas for ISO score enhancement"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Professional Tables"})," - Structured data presentation"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Department Branding"})," - Custom department information"]})]})})]}),d&&e.jsxs(V,{elevation:1,sx:{p:3},children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Current Assessment Summary:"}),e.jsxs(t,{variant:"body1",children:[e.jsx("strong",{children:"ISO Classification:"})," Class ",u,e.jsx("br",{}),e.jsx("strong",{children:"Total Score:"})," ",x.toFixed(1)," / 105.5 points",e.jsx("br",{}),e.jsx("strong",{children:"Score Percentage:"})," ",(x/105.5*100).toFixed(1),"%"]})]})]}),e.jsxs(ut,{sx:{p:3},children:[e.jsx(le,{onClick:c,variant:"outlined",children:"Close"}),e.jsx(le,{onClick:m,variant:"contained",startIcon:I?e.jsx(rt,{size:20,color:"inherit"}):e.jsx(Ze,{}),disabled:!d||I,children:I?"Generating...":"Generate PDF Report"})]})]})},me=320,Ci=({initialAssessment:i,onAssessmentComplete:c,mode:d="assessment"})=>{const x=at(),u=Dt(x.breakpoints.down("md")),[I,D]=z.useState(!u),[j,E]=z.useState(!1),[G,h]=z.useState(!1),[m,b]=z.useState(0),[f,R]=z.useState(null),[k,w]=z.useState(0),[v,O]=z.useState(10),[o,a]=z.useState(!1),[n,p]=z.useState(null),[y]=z.useState({population:25e3,avgHomePremium:1200,commercialPremiums:5e5});B.useEffect(()=>{document.title="FireEMS ISO Credit Calculator"},[]),B.useEffect(()=>{i&&(R(i),console.log("Loading initial ISO assessment:",i))},[i]),B.useEffect(()=>{f&&c&&c(f)},[f,c]);const S=()=>{D(!I)},C=()=>{E(!j),j?document.fullscreenElement&&document.exitFullscreen&&document.exitFullscreen():document.documentElement.requestFullscreen&&document.documentElement.requestFullscreen()},P=()=>{const $={assessment:f,score:k,classification:v,timestamp:new Date};localStorage.setItem("iso_credit_calculator_autosave",JSON.stringify($)),console.log("ISO assessment data saved")},N=()=>{console.log("🏆 ISO EXPORT BUTTON CLICKED - Starting export process");const $=f!==null;if(console.log("🏆 ISO EXPORT DATA CHECK:",{hasAssessment:$,currentScore:k,classification:v}),!$){console.log("🏆 NO ISO DATA - Showing alert"),alert("No ISO assessment data to export. Please complete the assessment first.");return}console.log("🏆 OPENING ISO REPORT GENERATOR - Setting state"),h(!0),console.log("📊 Opening professional ISO credit report generator:",{score:k,classification:v,hasAssessment:!!f,showReportGenerator:!0})},H=()=>{p(null)},X=($,q)=>{b(q)};return e.jsx(nt,{children:e.jsxs(r,{sx:{display:"flex",height:"100vh",overflow:"hidden",bgcolor:"background.default",position:j?"fixed":"relative",top:j?0:"auto",left:j?0:"auto",right:j?0:"auto",bottom:j?0:"auto",zIndex:j?1300:"auto"},role:"main","aria-label":"ISO Credit Calculator Tool",children:[!j&&e.jsx(ot,{position:"fixed",sx:{zIndex:x.zIndex.drawer+1,bgcolor:"primary.main"},children:e.jsxs(kt,{children:[e.jsx(xe,{color:"inherit","aria-label":"toggle sidebar",onClick:S,edge:"start",sx:{mr:2},children:e.jsx(Rt,{})}),e.jsx(Qe,{sx:{mr:1}}),e.jsxs(t,{variant:"h6",noWrap:!0,component:"div",sx:{flexGrow:1},children:["ISO Credit Calculator",d==="planning"&&" - Planning Mode",d==="presentation"&&" - Presentation Mode"]}),e.jsxs(r,{sx:{display:"flex",gap:1},children:[e.jsx(xe,{color:"inherit",onClick:P,title:"Save Assessment",children:e.jsx(ht,{})}),e.jsx(xe,{color:"inherit",onClick:N,title:"Generate Professional ISO Report",disabled:!f,children:e.jsx(Ze,{})}),e.jsx(xe,{color:"inherit",onClick:C,title:"Toggle Fullscreen",children:j?e.jsx(wt,{}):e.jsx(Ot,{})})]})]})}),e.jsx(Pt,{variant:u?"temporary":"persistent",anchor:"left",open:I,onClose:S,sx:{width:me,flexShrink:0,"& .MuiDrawer-paper":{width:me,boxSizing:"border-box",marginTop:j?0:"56px",height:j?"100vh":"calc(100vh - 56px)",borderRight:`1px solid ${x.palette.divider}`}},ModalProps:{keepMounted:!0,disablePortal:!1,hideBackdrop:!u,disableAutoFocus:!0,disableEnforceFocus:!0,disableRestoreFocus:!0},PaperProps:{"aria-hidden":!1,role:"complementary","aria-label":"ISO Credit Calculator Tools"},children:e.jsx(Wt,{mode:d,onAssessmentChange:R,onScoreChange:w,onClassificationChange:O})}),e.jsxs(r,{component:"main",sx:{flexGrow:1,position:"relative",marginLeft:!u&&I?`${me}px`:0,width:!u&&I?`calc(100% - ${me}px)`:"100%",marginTop:j?0:"56px",height:j?"100vh":"calc(100vh - 56px)",transition:x.transitions.create(["margin","width"],{easing:x.transitions.easing.sharp,duration:x.transitions.duration.leavingScreen}),display:"flex",flexDirection:"column"},children:[e.jsx(V,{elevation:1,sx:{borderRadius:0,borderBottom:`1px solid ${x.palette.divider}`},children:e.jsxs(Et,{value:m,onChange:X,"aria-label":"ISO Credit Calculator Tabs",sx:{px:2},children:[e.jsx(Je,{icon:e.jsx(Tt,{}),label:"Score Calculator",id:"iso-tab-0","aria-controls":"iso-tabpanel-0"}),e.jsx(Je,{icon:e.jsx(be,{}),label:"Improvement Planner",id:"iso-tab-1","aria-controls":"iso-tabpanel-1",disabled:!f})]})}),e.jsxs(r,{sx:{flexGrow:1,overflow:"auto",position:"relative"},children:[m===0&&e.jsx(V,{elevation:0,sx:{height:"100%",width:"100%",borderRadius:0,overflow:"auto",position:"relative",minHeight:"500px",display:"flex",flexDirection:"column"},role:"tabpanel",id:"iso-tabpanel-0","aria-labelledby":"iso-tab-0",children:e.jsx(Gt,{assessment:f,currentScore:k,classification:v,sidebarOpen:I,isMobile:u})}),m===1&&e.jsx(r,{sx:{height:"100%",overflow:"auto"},role:"tabpanel",id:"iso-tabpanel-1","aria-labelledby":"iso-tab-1",children:e.jsx($t,{assessment:f,currentScore:k,classification:v,communityProfile:y})})]}),o&&e.jsx(r,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,bgcolor:"rgba(255, 255, 255, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsx(t,{variant:"h6",children:"Calculating ISO Score..."})})]}),e.jsx(Mt,{open:!!n,autoHideDuration:6e3,onClose:H,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(fe,{onClose:H,severity:"error",sx:{width:"100%"},children:n})}),e.jsx(zt,{open:G,onClose:()=>h(!1),assessment:f,score:k,classification:v})]})})};export{Ci as default};
