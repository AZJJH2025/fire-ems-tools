<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FireMapPro | FireEMS.ai</title>
    
    <!-- External CSS Libraries -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet-draw@1.0.4/dist/leaflet.draw.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet-search@3.0.2/dist/leaflet-search.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet-easybutton@2/src/easy-button.css">
    <!-- Removed problematic leaflet-measure library -->
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='fire-map-pro.css') }}">
    
    <!-- Required scripts before content loads -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-draw@1.0.4/dist/leaflet.draw.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/leaflet-search@3.0.2/dist/leaflet-search.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/leaflet-easybutton@2/src/easy-button.js"></script>
    <!-- Removed problematic leaflet-measure library -->
    <!-- Removed leaflet-measure CSP fix since we're not using leaflet-measure anymore -->
    
    <!-- Export libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <!-- Heatmap plugin for Hotspot Analysis -->
    <script src="https://unpkg.com/leaflet.heat@0.2.0/dist/leaflet-heat.js"></script>
    
    <!-- Favicon -->
    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">
</head>
<body>
    <div class="navbar">
        <div class="logo">
            <a href="/">
                <i class="fas fa-fire"></i> FireEMS.ai
            </a>
        </div>
        <div class="nav-links">
            <a href="/">Home</a>
            <a href="/fire-ems-dashboard">Response Time Analyzer</a>
            <a href="/isochrone-map">Isochrone Map</a>
            <a href="/call-density-heatmap">Call Density</a>
            <a href="/station-overview">Station Overview</a>
            <a href="/incident-logger">Incident Logger</a>
            <a href="/coverage-gap-finder">Coverage Gap Finder</a>
            <a href="/fire-map-pro" class="active">FireMapPro</a>
            <a href="/data-formatter">Data Formatter</a>
            <a href="/user-guide">User Guide</a>
        </div>
    </div>

    <header class="tool-header">
        <div class="container">
            <h1><i class="fas fa-map-marked-alt"></i> FireMapPro</h1>
            <p>Advanced interactive map creator for fire department and EMS planning</p>
        </div>
    </header>

    <main class="container">
        <div class="firemappro-container">
            <div class="sidebar">
                <div class="tool-section">
                    <h3>Base Maps</h3>
                    <div class="radio-group">
                        <div>
                            <input type="radio" id="street-layer" name="base-layer" value="street" checked>
                            <label for="street-layer">Street Map</label>
                        </div>
                        <div>
                            <input type="radio" id="satellite-layer" name="base-layer" value="satellite">
                            <label for="satellite-layer">Satellite Imagery</label>
                        </div>
                        <div>
                            <input type="radio" id="terrain-layer" name="base-layer" value="terrain">
                            <label for="terrain-layer">Terrain Map</label>
                        </div>
                    </div>
                </div>

                <div class="tool-section">
                    <h3>Map Tools</h3>
                    <div class="tool-buttons">
                        <button id="draw-tool" class="tool-btn">
                            <i class="fas fa-draw-polygon"></i> Draw Tools
                        </button>
                        <button id="measure-tool" class="tool-btn">
                            <i class="fas fa-ruler"></i> Measure
                        </button>
                        <button id="clear-tool" class="tool-btn">
                            <i class="fas fa-trash-alt"></i> Clear All
                        </button>
                    </div>
                </div>

                <div class="tool-section">
                    <h3>Layers</h3>
                    <div class="layer-controls">
                        <div class="layer-item">
                            <input type="checkbox" id="stations-layer" checked>
                            <label for="stations-layer">Fire Stations</label>
                        </div>
                        <div class="layer-item">
                            <input type="checkbox" id="incidents-layer">
                            <label for="incidents-layer">Recent Incidents</label>
                        </div>
                        <div class="layer-item">
                            <input type="checkbox" id="response-zones-layer">
                            <label for="response-zones-layer">Response Zones</label>
                        </div>
                        <div class="layer-item">
                            <input type="checkbox" id="hydrants-layer">
                            <label for="hydrants-layer">Hydrants</label>
                        </div>
                        <div class="layer-item">
                            <input type="checkbox" id="hospitals-layer">
                            <label for="hospitals-layer">Hospitals</label>
                        </div>
                    </div>
                </div>

                <div class="tool-section">
                    <h3>Import Data</h3>
                    <div class="import-controls">
                        <div class="import-item">
                            <label for="csv-import" class="import-btn">
                                <i class="fas fa-file-csv"></i> Import CSV
                                <input type="file" id="csv-import" accept=".csv" style="display: none;">
                            </label>
                        </div>
                        <div class="import-item">
                            <label for="kml-import" class="import-btn">
                                <i class="fas fa-file-import"></i> Import KML/GPX
                                <input type="file" id="kml-import" accept=".kml,.gpx" style="display: none;">
                            </label>
                        </div>
                        <div class="import-item">
                            <label for="geojson-import" class="import-btn">
                                <i class="fas fa-file-code"></i> Import GeoJSON
                                <input type="file" id="geojson-import" accept=".geojson,.json" style="display: none;">
                            </label>
                        </div>
                    </div>
                </div>

                <div class="tool-section">
                    <h3>Analysis Tools</h3>
                    <div class="analysis-buttons">
                        <button id="hotspot-analysis" class="tool-btn">
                            <i class="fas fa-fire"></i> Hotspot Analysis
                        </button>
                        <button id="distance-analysis" class="tool-btn">
                            <i class="fas fa-road"></i> Distance Analysis
                        </button>
                        <button id="buffer-tool" class="tool-btn">
                            <i class="fas fa-expand-alt"></i> Create Buffer
                        </button>
                    </div>
                </div>

                <div class="tool-section">
                    <h3>Map Symbols</h3>
                    
                    <!-- Fire Apparatus -->
                    <div class="icon-category">
                        <h4>Fire Apparatus</h4>
                        <div class="icon-grid">
                            <div class="draggable-icon" data-icon="fa-truck" draggable="true">
                                <i class="fas fa-truck"></i>
                                <span>Engine</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-truck-loading" draggable="true">
                                <i class="fas fa-truck-loading"></i>
                                <span>Ladder Truck</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-truck-moving" draggable="true">
                                <i class="fas fa-truck-moving"></i>
                                <span>Tanker</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-truck-pickup" draggable="true">
                                <i class="fas fa-truck-pickup"></i>
                                <span>Brush Unit</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-truck-monster" draggable="true">
                                <i class="fas fa-truck-monster"></i>
                                <span>HazMat Unit</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-car-side" draggable="true">
                                <i class="fas fa-car-side"></i>
                                <span>Command</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-truck-monster" draggable="true">
                                <i class="fas fa-truck-monster"></i>
                                <span>Dozer</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-ship" draggable="true">
                                <i class="fas fa-ship"></i>
                                <span>Fire Boat</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- EMS Units -->
                    <div class="icon-category">
                        <h4>EMS Units</h4>
                        <div class="icon-grid">
                            <div class="draggable-icon" data-icon="fa-ambulance" draggable="true">
                                <i class="fas fa-ambulance"></i>
                                <span>ALS Ambulance</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-first-aid" draggable="true">
                                <i class="fas fa-first-aid"></i>
                                <span>BLS Ambulance</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-heartbeat" draggable="true">
                                <i class="fas fa-heartbeat"></i>
                                <span>Paramedic</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-helicopter" draggable="true">
                                <i class="fas fa-helicopter"></i>
                                <span>Air Ambulance</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-bus" draggable="true">
                                <i class="fas fa-bus"></i>
                                <span>Mass Casualty</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-bicycle" draggable="true">
                                <i class="fas fa-bicycle"></i>
                                <span>Bike Medic</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Incident Types -->
                    <div class="icon-category">
                        <h4>Incident Types</h4>
                        <div class="icon-grid">
                            <div class="draggable-icon" data-icon="fa-fire" draggable="true">
                                <i class="fas fa-fire"></i>
                                <span>Structure Fire</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-car-burst" draggable="true">
                                <i class="fas fa-car-burst"></i>
                                <span>Vehicle Fire</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-tree" draggable="true">
                                <i class="fas fa-tree"></i>
                                <span>Wildland Fire</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-bell" draggable="true">
                                <i class="fas fa-bell"></i>
                                <span>Fire Alarm</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-car-crash" draggable="true">
                                <i class="fas fa-car-crash"></i>
                                <span>MVA</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-water" draggable="true">
                                <i class="fas fa-water"></i>
                                <span>Water Rescue</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-user-injured" draggable="true">
                                <i class="fas fa-user-injured"></i>
                                <span>Medical</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-exclamation-triangle" draggable="true">
                                <i class="fas fa-exclamation-triangle"></i>
                                <span>Hazardous</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Facilities & POI -->
                    <div class="icon-category">
                        <h4>Facilities & POI</h4>
                        <div class="icon-grid">
                            <div class="draggable-icon" data-icon="fa-building" draggable="true">
                                <i class="fas fa-building"></i>
                                <span>Fire Station</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-hospital" draggable="true">
                                <i class="fas fa-hospital"></i>
                                <span>Hospital</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-h-square" draggable="true">
                                <i class="fas fa-h-square"></i>
                                <span>Helipad</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-tint" draggable="true">
                                <i class="fas fa-tint"></i>
                                <span>Hydrant</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-school" draggable="true">
                                <i class="fas fa-school"></i>
                                <span>School</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-warehouse" draggable="true">
                                <i class="fas fa-warehouse"></i>
                                <span>Shelter</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-industry" draggable="true">
                                <i class="fas fa-industry"></i>
                                <span>Industrial</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-road" draggable="true">
                                <i class="fas fa-road"></i>
                                <span>Access Point</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Command & Hazards -->
                    <div class="icon-category">
                        <h4>Command & Hazards</h4>
                        <div class="icon-grid">
                            <div class="draggable-icon" data-icon="fa-flag" draggable="true">
                                <i class="fas fa-flag"></i>
                                <span>Command Post</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-medkit" draggable="true">
                                <i class="fas fa-medkit"></i>
                                <span>Triage</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-chair" draggable="true">
                                <i class="fas fa-chair"></i>
                                <span>Rehab</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-parking" draggable="true">
                                <i class="fas fa-parking"></i>
                                <span>Staging</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-biohazard" draggable="true">
                                <i class="fas fa-biohazard"></i>
                                <span>Biohazard</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-radiation" draggable="true">
                                <i class="fas fa-radiation"></i>
                                <span>Radiation</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-skull-crossbones" draggable="true">
                                <i class="fas fa-skull-crossbones"></i>
                                <span>Hazard</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-bolt" draggable="true">
                                <i class="fas fa-bolt"></i>
                                <span>Electrical</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Energy System Components -->
                    <div class="icon-category">
                        <h4>Energy System Components</h4>
                        <div class="icon-grid">
                            <div class="draggable-icon" data-icon="fa-solar-panel" draggable="true">
                                <i class="fas fa-solar-panel"></i>
                                <span>Solar Array</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-battery-full" draggable="true">
                                <i class="fas fa-battery-full"></i>
                                <span>Battery Bank</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-battery-half" draggable="true">
                                <i class="fas fa-battery-half"></i>
                                <span>Battery Module</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-server" draggable="true">
                                <i class="fas fa-server"></i>
                                <span>Battery Rack</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-box" draggable="true">
                                <i class="fas fa-box"></i>
                                <span>BESS Container</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-random" draggable="true">
                                <i class="fas fa-random"></i>
                                <span>Inverter</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-exchange-alt" draggable="true">
                                <i class="fas fa-exchange-alt"></i>
                                <span>Hybrid Inverter</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-microchip" draggable="true">
                                <i class="fas fa-microchip"></i>
                                <span>BMS</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Energy Distribution -->
                    <div class="icon-category">
                        <h4>Energy Distribution</h4>
                        <div class="icon-grid">
                            <div class="draggable-icon" data-icon="fa-toggle-on" draggable="true">
                                <i class="fas fa-toggle-on"></i>
                                <span>AC Switchgear</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-toggle-off" draggable="true">
                                <i class="fas fa-toggle-off"></i>
                                <span>DC Switchgear</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-plug" draggable="true">
                                <i class="fas fa-plug"></i>
                                <span>Grid Connection</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-lightbulb" draggable="true">
                                <i class="fas fa-lightbulb"></i>
                                <span>Load/Facility</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-charging-station" draggable="true">
                                <i class="fas fa-charging-station"></i>
                                <span>EV Charger</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-cogs" draggable="true">
                                <i class="fas fa-cogs"></i>
                                <span>Generator</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-tachometer-alt" draggable="true">
                                <i class="fas fa-tachometer-alt"></i>
                                <span>Meter</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-brain" draggable="true">
                                <i class="fas fa-brain"></i>
                                <span>EMS/Controller</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Status & Environmental -->
                    <div class="icon-category">
                        <h4>Status & Environmental</h4>
                        <div class="icon-grid">
                            <div class="draggable-icon" data-icon="fa-check-circle" draggable="true">
                                <i class="fas fa-check-circle"></i>
                                <span>Operational</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-arrow-circle-down" draggable="true">
                                <i class="fas fa-arrow-circle-down"></i>
                                <span>Charging</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-arrow-circle-up" draggable="true">
                                <i class="fas fa-arrow-circle-up"></i>
                                <span>Discharging</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-pause-circle" draggable="true">
                                <i class="fas fa-pause-circle"></i>
                                <span>Standby/Idle</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-exclamation-circle" draggable="true">
                                <i class="fas fa-exclamation-circle"></i>
                                <span>Fault/Alarm</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-thermometer-half" draggable="true">
                                <i class="fas fa-thermometer-half"></i>
                                <span>Temperature</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-fan" draggable="true">
                                <i class="fas fa-fan"></i>
                                <span>HVAC/Cooling</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-fire-extinguisher" draggable="true">
                                <i class="fas fa-fire-extinguisher"></i>
                                <span>Fire Suppression</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Data Flow & Measurement -->
                    <div class="icon-category">
                        <h4>Data Flow & Measurement</h4>
                        <div class="icon-grid">
                            <div class="draggable-icon" data-icon="fa-long-arrow-alt-right" draggable="true">
                                <i class="fas fa-long-arrow-alt-right"></i>
                                <span>Energy Flow</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-bolt" draggable="true">
                                <i class="fas fa-bolt"></i>
                                <span>Voltage (V)</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-wave-square" draggable="true">
                                <i class="fas fa-wave-square"></i>
                                <span>Current (A)</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-broadcast-tower" draggable="true">
                                <i class="fas fa-broadcast-tower"></i>
                                <span>Power (kW)</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-percentage" draggable="true">
                                <i class="fas fa-percentage"></i>
                                <span>State of Charge</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-tachometer-alt" draggable="true">
                                <i class="fas fa-tachometer-alt"></i>
                                <span>Frequency (Hz)</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-chart-line" draggable="true">
                                <i class="fas fa-chart-line"></i>
                                <span>Data Monitor</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-satellite-dish" draggable="true">
                                <i class="fas fa-satellite-dish"></i>
                                <span>Weather/Sensors</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Fire Prevention Personnel -->
                    <div class="icon-category">
                        <h4>Prevention Personnel</h4>
                        <div class="icon-grid">
                            <div class="draggable-icon" data-icon="fa-id-badge" draggable="true">
                                <i class="fas fa-id-badge"></i>
                                <span>Fire Marshal</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-search" draggable="true">
                                <i class="fas fa-search"></i>
                                <span>Inspector</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-search-plus" draggable="true">
                                <i class="fas fa-search-plus"></i>
                                <span>Investigator</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-drafting-compass" draggable="true">
                                <i class="fas fa-drafting-compass"></i>
                                <span>Plans Examiner</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-chalkboard-teacher" draggable="true">
                                <i class="fas fa-chalkboard-teacher"></i>
                                <span>Pub Ed Officer</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-gavel" draggable="true">
                                <i class="fas fa-gavel"></i>
                                <span>Code Enforcement</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-car" draggable="true">
                                <i class="fas fa-car"></i>
                                <span>Inspector Unit</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-clipboard-check" draggable="true">
                                <i class="fas fa-clipboard-check"></i>
                                <span>Prevention Staff</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Inspection Activities -->
                    <div class="icon-category">
                        <h4>Inspection Activities</h4>
                        <div class="icon-grid">
                            <div class="draggable-icon" data-icon="fa-calendar-check" draggable="true">
                                <i class="fas fa-calendar-check"></i>
                                <span>Inspection Scheduled</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-clipboard" draggable="true">
                                <i class="fas fa-clipboard"></i>
                                <span>Inspection in Progress</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-clipboard-check" draggable="true">
                                <i class="fas fa-clipboard-check"></i>
                                <span>Inspection Passed</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-clipboard-list" draggable="true">
                                <i class="fas fa-clipboard-list"></i>
                                <span>Violations Noted</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-redo" draggable="true">
                                <i class="fas fa-redo"></i>
                                <span>Follow-up Required</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-scroll" draggable="true">
                                <i class="fas fa-scroll"></i>
                                <span>Permit Issued</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-file-signature" draggable="true">
                                <i class="fas fa-file-signature"></i>
                                <span>Permit Application</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-exclamation-triangle" draggable="true">
                                <i class="fas fa-exclamation-triangle"></i>
                                <span>Violation Issued</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Investigation & Plan Review -->
                    <div class="icon-category">
                        <h4>Investigation & Plan Review</h4>
                        <div class="icon-grid">
                            <div class="draggable-icon" data-icon="fa-fire" draggable="true">
                                <i class="fas fa-fire"></i>
                                <span>Investigation Scene</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-map-marker-alt" draggable="true">
                                <i class="fas fa-map-marker-alt"></i>
                                <span>Evidence Marker</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-drafting-compass" draggable="true">
                                <i class="fas fa-drafting-compass"></i>
                                <span>Plans Review</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-stamp" draggable="true">
                                <i class="fas fa-stamp"></i>
                                <span>Plans Approved</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-times-circle" draggable="true">
                                <i class="fas fa-times-circle"></i>
                                <span>Plans Rejected</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-comment" draggable="true">
                                <i class="fas fa-comment"></i>
                                <span>Complaint Received</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-bullhorn" draggable="true">
                                <i class="fas fa-bullhorn"></i>
                                <span>Public Education</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-school" draggable="true">
                                <i class="fas fa-school"></i>
                                <span>School Visit</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Prevention Locations -->
                    <div class="icon-category">
                        <h4>Prevention Locations</h4>
                        <div class="icon-grid">
                            <div class="draggable-icon" data-icon="fa-building" draggable="true">
                                <i class="fas fa-building"></i>
                                <span>Inspection Target</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-key" draggable="true">
                                <i class="fas fa-key"></i>
                                <span>Knox Box</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-bell" draggable="true">
                                <i class="fas fa-bell"></i>
                                <span>FACP</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-water" draggable="true">
                                <i class="fas fa-water"></i>
                                <span>Sprinkler Room</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-smoking-ban" draggable="true">
                                <i class="fas fa-smoking-ban"></i>
                                <span>Smoke Detector</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-cloud" draggable="true">
                                <i class="fas fa-cloud"></i>
                                <span>CO Detector</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-theater-masks" draggable="true">
                                <i class="fas fa-theater-masks"></i>
                                <span>Assembly</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-home" draggable="true">
                                <i class="fas fa-home"></i>
                                <span>Licensed Premise</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Status & Result Icons -->
                    <div class="icon-category">
                        <h4>Status & Results</h4>
                        <div class="icon-grid">
                            <div class="draggable-icon" data-icon="fa-check" draggable="true">
                                <i class="fas fa-check"></i>
                                <span>Compliance/Pass</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-times" draggable="true">
                                <i class="fas fa-times"></i>
                                <span>Non-Compliance</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-exclamation-triangle" draggable="true">
                                <i class="fas fa-exclamation-triangle"></i>
                                <span>Warning</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-hourglass-half" draggable="true">
                                <i class="fas fa-hourglass-half"></i>
                                <span>Pending</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-external-link-alt" draggable="true">
                                <i class="fas fa-external-link-alt"></i>
                                <span>Referral Made</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-thumbs-up" draggable="true">
                                <i class="fas fa-thumbs-up"></i>
                                <span>Resolved/Abated</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-folder-open" draggable="true">
                                <i class="fas fa-folder-open"></i>
                                <span>Case Open</span>
                            </div>
                            <div class="draggable-icon" data-icon="fa-folder" draggable="true">
                                <i class="fas fa-folder"></i>
                                <span>Case Closed</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- More color options -->
                    <div class="icon-options">
                        <div class="color-selector">
                            <label for="icon-color">Icon Color:</label>
                            <select id="icon-color">
                                <option value="#d32f2f">Red</option>
                                <option value="#1976d2">Blue</option>
                                <option value="#4caf50">Green</option>
                                <option value="#ff9800">Orange</option>
                                <option value="#9c27b0">Purple</option>
                                <option value="#607d8b">Gray</option>
                                <option value="#000000">Black</option>
                                <option value="#e91e63">Pink</option>
                                <option value="#ffeb3b">Yellow</option>
                                <option value="#009688">Teal</option>
                                <option value="#795548">Brown</option>
                                <option value="#ffffff">White</option>
                            </select>
                        </div>
                        <div class="size-selector" style="margin-top: 10px;">
                            <label for="icon-size">Icon Size:</label>
                            <select id="icon-size">
                                <option value="small">Small</option>
                                <option value="medium" selected>Medium</option>
                                <option value="large">Large</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="tool-section">
                    <h3>Export Map</h3>
                    <div class="export-buttons">
                        <button id="export-png" class="tool-btn">
                            <i class="fas fa-image"></i> Export PNG
                        </button>
                        <button id="export-pdf" class="tool-btn premium-btn">
                            <i class="fas fa-file-pdf"></i> Export PDF
                        </button>
                        <button id="export-data" class="tool-btn">
                            <i class="fas fa-file-export"></i> Export Data
                        </button>
                    </div>
                </div>
            </div>

            <div class="map-container">
                <div id="map-title-container" class="map-title-container hidden">
                    <div id="map-logo" class="map-logo"></div>
                    <div class="map-title-text">
                        <h2 id="map-title">Map Title</h2>
                        <p id="map-subtitle"></p>
                    </div>
                    <button id="edit-title-btn" class="map-btn">
                        <i class="fas fa-edit"></i>
                    </button>
                </div>
                <div id="map"></div>
                <div class="map-controls">
                    <div class="map-control-item">
                        <button id="title-toggle-btn" class="map-btn" title="Toggle Title">
                            <i class="fas fa-heading"></i>
                        </button>
                    </div>
                    <div class="map-control-item">
                        <button id="fullscreen-btn" class="map-btn" title="Fullscreen">
                            <i class="fas fa-expand"></i>
                        </button>
                    </div>
                    <div class="map-control-item">
                        <button id="home-btn" class="map-btn" title="Reset View">
                            <i class="fas fa-home"></i>
                        </button>
                    </div>
                </div>
                <div class="coords-display">
                    <span id="mouse-position">Coordinates: ---, ---</span>
                </div>
            </div>
        </div>
    </main>

    <!-- Modal Templates -->
    <div id="buffer-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Create Buffer</h2>
                <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="buffer-distance">Buffer Distance (miles):</label>
                    <input type="number" id="buffer-distance" min="0.1" max="50" step="0.1" value="1.0">
                </div>
                <div class="form-group">
                    <label for="buffer-layers">Apply to Layer:</label>
                    <select id="buffer-layers">
                        <option value="all">All Layers</option>
                        <option value="stations">Fire Stations</option>
                        <option value="hydrants">Hydrants</option>
                        <option value="hospitals">Hospitals</option>
                        <option value="selection">Current Selection</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button id="buffer-cancel" class="modal-btn">Cancel</button>
                <button id="buffer-apply" class="modal-btn primary-btn">Apply Buffer</button>
            </div>
        </div>
    </div>

    <div id="export-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Export Options</h2>
                <span class="close-modal">&times;</span>
                <div class="modal-tabs">
                    <button class="modal-tab active" data-tab="export-basic">Basic</button>
                    <button class="modal-tab" data-tab="export-advanced">Advanced</button>
                    <button class="modal-tab" data-tab="layout-designer">Layout Designer</button>
                </div>
            </div>
            <div class="modal-body">
                <div class="tab-panel" id="export-basic-panel">
                    <div class="form-group">
                        <label for="export-title">Map Title:</label>
                        <input type="text" id="export-title" placeholder="My Fire Department Map">
                    </div>
                    <div class="form-group">
                        <label for="export-subtitle">Subtitle (optional):</label>
                        <input type="text" id="export-subtitle" placeholder="Created by Fire Prevention Division">
                    </div>
                    <div class="form-group">
                        <label for="department-logo">Department Logo:</label>
                        <div class="logo-upload">
                            <label for="logo-file" class="custom-file-upload">
                                <i class="fas fa-upload"></i> Choose Logo
                            </label>
                            <input type="file" id="logo-file" accept="image/*" style="display: none;">
                            <span id="logo-file-name">No file chosen</span>
                        </div>
                        <div id="logo-preview" class="logo-preview"></div>
                    </div>
                    <div class="form-group">
                        <label for="export-format">Export Format:</label>
                        <select id="export-format">
                            <!-- Raster Formats -->
                            <optgroup label="Raster Formats">
                                <option value="png">PNG Image</option>
                                <option value="jpg">JPEG Image</option>
                                <option value="tiff">TIFF Image</option>
                            </optgroup>
                            <!-- Vector Formats -->
                            <optgroup label="Vector Formats">
                                <option value="pdf">PDF Document</option>
                                <option value="svg">SVG Vector</option>
                                <option value="eps">EPS Vector</option>
                            </optgroup>
                            <!-- GIS Formats -->
                            <optgroup label="GIS Formats">
                                <option value="geojson">GeoJSON</option>
                                <option value="kml">KML</option>
                                <option value="geopdf">GeoPDF</option>
                            </optgroup>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="export-dpi">Resolution (DPI):</label>
                        <select id="export-dpi">
                            <option value="96">Standard (96 DPI)</option>
                            <option value="150">Medium (150 DPI)</option>
                            <option value="300">High (300 DPI)</option>
                            <option value="450">Very High (450 DPI)</option>
                            <option value="600">Ultra High (600 DPI)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="print-size">Print Size:</label>
                        <div class="preset-sizes">
                            <select id="paper-preset">
                                <option value="custom">Custom Size</option>
                                <option value="letter" selected>Letter (8.5"  11")</option>
                                <option value="legal">Legal (8.5"  14")</option>
                                <option value="tabloid">Tabloid (11"  17")</option>
                                <option value="a4">A4 (210mm  297mm)</option>
                                <option value="a3">A3 (297mm  420mm)</option>
                                <option value="a2">A2 (420mm  594mm)</option>
                                <option value="a1">A1 (594mm  841mm)</option>
                                <option value="a0">A0 (841mm  1189mm)</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="export-options-section">
                        <h4>Layout Elements</h4>
                        <div class="form-group checkbox">
                            <input type="checkbox" id="export-legend" checked>
                            <label for="export-legend">Include Legend</label>
                        </div>
                        <div class="form-group checkbox">
                            <input type="checkbox" id="export-scale" checked>
                            <label for="export-scale">Include Scale Bar</label>
                        </div>
                        <div class="form-group checkbox">
                            <input type="checkbox" id="export-north" checked>
                            <label for="export-north">Include North Arrow</label>
                        </div>
                        <div class="form-group checkbox">
                            <input type="checkbox" id="export-title-element" checked>
                            <label for="export-title-element">Include Title Banner</label>
                        </div>
                    </div>
                </div>
                
                <div class="tab-panel" id="export-advanced-panel" style="display: none;">
                    <div class="form-group">
                        <label for="color-mode">Color Mode:</label>
                        <select id="color-mode">
                            <option value="rgb">RGB (Screen)</option>
                            <option value="cmyk">CMYK (Print)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="color-profile">ICC Color Profile:</label>
                        <select id="color-profile">
                            <option value="srgb">sRGB (Default)</option>
                            <option value="adobergb">Adobe RGB</option>
                            <option value="cmyk-swop">CMYK SWOP (U.S.)</option>
                            <option value="cmyk-fogra">CMYK FOGRA39 (Europe)</option>
                            <option value="custom">Custom Profile...</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="print-size-custom">Custom Print Size:</label>
                        <div class="size-inputs">
                            <div class="input-with-label">
                                <input type="number" id="print-width" min="1" max="100" step="0.1" value="8.5">
                                <span></span>
                                <input type="number" id="print-height" min="1" max="100" step="0.1" value="11">
                            </div>
                            <select id="print-units">
                                <option value="in">inches</option>
                                <option value="cm">centimeters</option>
                                <option value="mm">millimeters</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="export-options-section">
                        <h4>Professional Print Options</h4>
                        <div class="form-group checkbox">
                            <input type="checkbox" id="export-bleed">
                            <label for="export-bleed">Add Bleed (0.125")</label>
                        </div>
                        <div class="form-group checkbox">
                            <input type="checkbox" id="export-crop-marks">
                            <label for="export-crop-marks">Show Crop Marks</label>
                        </div>
                        <div class="form-group checkbox">
                            <input type="checkbox" id="export-color-bars">
                            <label for="export-color-bars">Include Color Calibration Bars</label>
                        </div>
                        <div class="form-group checkbox">
                            <input type="checkbox" id="export-registration-marks">
                            <label for="export-registration-marks">Add Registration Marks</label>
                        </div>
                        <div class="form-group checkbox">
                            <input type="checkbox" id="export-icc">
                            <label for="export-icc">Embed ICC Profile</label>
                        </div>
                    </div>
                    
                    <div class="export-options-section">
                        <h4>Large Format Printing</h4>
                        <div class="form-group checkbox">
                            <input type="checkbox" id="export-tile-print">
                            <label for="export-tile-print">Enable Tiled Printing</label>
                        </div>
                        <div class="form-group" id="tile-options" style="display: none;">
                            <label for="tile-size">Tile Size:</label>
                            <select id="tile-size">
                                <option value="letter">Letter (8.5"  11")</option>
                                <option value="a4">A4 (210mm  297mm)</option>
                            </select>
                            <label for="tile-overlap">Overlap:</label>
                            <input type="number" id="tile-overlap" min="0" max="2" step="0.25" value="0.5"> inches
                        </div>
                    </div>
                    
                    <div class="export-options-section">
                        <h4>Layer Controls</h4>
                        <div class="layer-export-controls">
                            <div id="export-layers-list" class="scrollable-list">
                                <!-- Will be populated dynamically -->
                            </div>
                            <div class="form-group checkbox">
                                <input type="checkbox" id="export-all-layers" checked>
                                <label for="export-all-layers">Export All Visible Layers</label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="tab-panel" id="layout-designer-panel" style="display: none;">
                    <div class="layout-designer-container">
                        <div class="layout-toolbox">
                            <h4>Page Setup</h4>
                            <div class="form-group">
                                <label for="layout-orientation">Orientation:</label>
                                <select id="layout-orientation">
                                    <option value="portrait">Portrait</option>
                                    <option value="landscape">Landscape</option>
                                </select>
                            </div>
                            
                            <h4>Elements</h4>
                            <div class="layout-elements">
                                <div class="layout-element-item" draggable="true" data-element="map">
                                    <i class="fas fa-map"></i> Map Frame
                                </div>
                                <div class="layout-element-item" draggable="true" data-element="title">
                                    <i class="fas fa-heading"></i> Title
                                </div>
                                <div class="layout-element-item" draggable="true" data-element="legend">
                                    <i class="fas fa-list"></i> Legend
                                </div>
                                <div class="layout-element-item" draggable="true" data-element="north-arrow">
                                    <i class="fas fa-arrow-up"></i> North Arrow
                                </div>
                                <div class="layout-element-item" draggable="true" data-element="scale-bar">
                                    <i class="fas fa-ruler-horizontal"></i> Scale Bar
                                </div>
                                <div class="layout-element-item" draggable="true" data-element="text">
                                    <i class="fas fa-font"></i> Text Box
                                </div>
                                <div class="layout-element-item" draggable="true" data-element="image">
                                    <i class="fas fa-image"></i> Image
                                </div>
                                <div class="layout-element-item" draggable="true" data-element="shape">
                                    <i class="fas fa-draw-polygon"></i> Shape
                                </div>
                            </div>
                            
                            <h4>Templates</h4>
                            <div class="layout-templates">
                                <div class="template-item" data-template="standard">
                                    <img src="{{ url_for('static', filename='images/template-standard.png') }}" alt="Standard Layout">
                                    <span>Standard</span>
                                </div>
                                <div class="template-item" data-template="professional">
                                    <img src="{{ url_for('static', filename='images/template-professional.png') }}" alt="Professional Layout">
                                    <span>Professional</span>
                                </div>
                                <div class="template-item" data-template="presentation">
                                    <img src="{{ url_for('static', filename='images/template-presentation.png') }}" alt="Presentation Layout">
                                    <span>Presentation</span>
                                </div>
                                <div class="template-item" data-template="tactical">
                                    <img src="{{ url_for('static', filename='images/template-tactical.png') }}" alt="Tactical Layout">
                                    <span>Tactical</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="layout-canvas-container">
                            <div id="layout-canvas" class="layout-canvas">
                                <!-- Canvas will be populated with draggable elements -->
                                <div class="paper-sheet"></div>
                            </div>
                        </div>
                        
                        <div class="layout-properties">
                            <h4>Properties</h4>
                            <div id="element-properties">
                                <p class="no-selection-message">Select an element to edit its properties</p>
                                <!-- Properties will be dynamically populated based on selected element -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="export-cancel" class="modal-btn">Cancel</button>
                <button id="export-confirm" class="modal-btn primary-btn">Export Map</button>
            </div>
        </div>
    </div>

    <div id="hotspot-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Hotspot Analysis</h2>
                <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="hotspot-layer">Analyze Layer:</label>
                    <select id="hotspot-layer">
                        <option value="incidents">Incident Points</option>
                        <option value="custom">Custom Data</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="hotspot-radius">Analysis Radius (miles):</label>
                    <input type="number" id="hotspot-radius" min="0.1" max="10" step="0.1" value="1.0">
                </div>
                <div class="form-group">
                    <label for="hotspot-intensity">Color Intensity:</label>
                    <select id="hotspot-intensity">
                        <option value="low">Low</option>
                        <option value="medium" selected>Medium</option>
                        <option value="high">High</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button id="hotspot-cancel" class="modal-btn">Cancel</button>
                <button id="hotspot-apply" class="modal-btn primary-btn">Generate Heatmap</button>
            </div>
        </div>
    </div>

    <!-- CSV Column Mapping Modal -->
    <div id="csv-mapping-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Map CSV Columns</h2>
                <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <p>Please identify which columns contain location data:</p>
                <div class="form-group">
                    <label for="csv-lat-column">Latitude Column:</label>
                    <select id="csv-lat-column">
                        <!-- Will be populated dynamically -->
                    </select>
                </div>
                <div class="form-group">
                    <label for="csv-lng-column">Longitude Column:</label>
                    <select id="csv-lng-column">
                        <!-- Will be populated dynamically -->
                    </select>
                </div>
                <div class="form-group">
                    <label for="csv-name-column">Name/Title Column (optional):</label>
                    <select id="csv-name-column">
                        <option value="">-- None --</option>
                        <!-- Will be populated dynamically -->
                    </select>
                </div>
                <div class="form-group">
                    <label for="csv-category-column">Category Column (optional):</label>
                    <select id="csv-category-column">
                        <option value="">-- None --</option>
                        <!-- Will be populated dynamically -->
                    </select>
                </div>
                <div class="form-group">
                    <label for="csv-icon-style">Icon Style:</label>
                    <select id="csv-icon-style">
                        <option value="circle">Circle Markers</option>
                        <option value="marker">Default Markers</option>
                        <option value="custom">Custom Icons</option>
                    </select>
                </div>
                <div class="form-group checkbox">
                    <input type="checkbox" id="csv-first-row-header" checked>
                    <label for="csv-first-row-header">First Row Contains Headers</label>
                </div>
            </div>
            <div class="modal-footer">
                <button id="csv-cancel" class="modal-btn">Cancel</button>
                <button id="csv-import-confirm" class="modal-btn primary-btn">Import Data</button>
            </div>
        </div>
    </div>

    <!-- Map Title Modal -->
    <div id="map-title-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Edit Map Title</h2>
                <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="map-title-input">Map Title:</label>
                    <input type="text" id="map-title-input" placeholder="Enter map title">
                </div>
                <div class="form-group">
                    <label for="map-subtitle-input">Subtitle (optional):</label>
                    <input type="text" id="map-subtitle-input" placeholder="Enter subtitle">
                </div>
                <div class="form-group">
                    <label for="map-logo-upload">Department Logo:</label>
                    <div class="logo-upload">
                        <label for="map-logo-file" class="custom-file-upload">
                            <i class="fas fa-upload"></i> Choose Logo
                        </label>
                        <input type="file" id="map-logo-file" accept="image/*" style="display: none;">
                        <span id="map-logo-file-name">No file chosen</span>
                    </div>
                    <div id="map-logo-preview" class="logo-preview"></div>
                </div>
                <div class="form-group">
                    <label for="map-title-position">Position:</label>
                    <select id="map-title-position">
                        <option value="top">Top</option>
                        <option value="topleft">Top Left</option>
                        <option value="topright">Top Right</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button id="map-title-cancel" class="modal-btn">Cancel</button>
                <button id="map-title-apply" class="modal-btn primary-btn">Apply</button>
            </div>
        </div>
    </div>

    <!-- Print Preview Modal -->
    <div id="print-preview-modal">
        <div class="print-preview-content">
            <div class="print-preview-header">
                <h2>Print Preview</h2>
                <button class="print-preview-close">&times;</button>
            </div>
            <div class="print-preview-options">
                <div class="print-preview-option-group">
                    <label for="preview-view-mode">View:</label>
                    <select id="preview-view-mode">
                        <option value="normal">Normal</option>
                        <option value="print-marks">With Print Marks</option>
                        <option value="cmyk-preview">CMYK Preview</option>
                        <option value="color-separations">Color Separations</option>
                    </select>
                </div>
                <div class="print-preview-option-group">
                    <label for="preview-zoom">Zoom:</label>
                    <select id="preview-zoom">
                        <option value="fit">Fit to Window</option>
                        <option value="25">25%</option>
                        <option value="50">50%</option>
                        <option value="75">75%</option>
                        <option value="100">100%</option>
                        <option value="150">150%</option>
                        <option value="200">200%</option>
                    </select>
                </div>
            </div>
            <div class="print-preview-body">
                <div class="print-preview-canvas-container">
                    <canvas id="preview-canvas" class="print-preview-canvas"></canvas>
                    <div id="preview-overlay" class="print-preview-overlay"></div>
                    <!-- Crop marks will be added here dynamically -->
                    <div class="crop-marks" id="crop-marks-container" style="display: none;">
                        <div class="crop-mark crop-mark-top-left"></div>
                        <div class="crop-mark crop-mark-top-right"></div>
                        <div class="crop-mark crop-mark-bottom-left"></div>
                        <div class="crop-mark crop-mark-bottom-right"></div>
                    </div>
                </div>
            </div>
            <div class="print-preview-info">
                <div class="info-group">
                    <span class="info-label">Format:</span>
                    <span id="preview-format">PDF</span>
                </div>
                <div class="info-group">
                    <span class="info-label">Resolution:</span>
                    <span id="preview-dpi">96</span> DPI
                </div>
                <div class="info-group">
                    <span class="info-label">Color Mode:</span>
                    <span id="preview-color-mode">RGB</span>
                </div>
                <div class="info-group">
                    <span class="info-label">Dimensions:</span>
                    <span id="preview-dimensions">8.5"  11"</span>
                </div>
                <div class="info-group">
                    <span class="info-label">File Size (est.):</span>
                    <span id="preview-size">0 KB</span>
                </div>
            </div>
            <div class="print-preview-footer">
                <div class="print-controls">
                    <button id="print-direct-btn" class="action-btn" title="Print directly to printer">
                        <i class="fas fa-print"></i> Print
                    </button>
                    <button id="show-tiles-btn" class="action-btn" title="Show tiling for large format printing">
                        <i class="fas fa-th-large"></i> Show Tiles
                    </button>
                </div>
                <div class="export-controls">
                    <button class="cancel-btn">Cancel</button>
                    <button class="export-btn premium-btn">Export</button>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <p>&copy; 2025 FireEMS.ai - Advanced Analytics for Fire & EMS Agencies</p>
        </div>
    </footer>

    <script src="{{ url_for('static', filename='fire-map-pro.js') }}"></script>
</body>
</html>