import{a as Ze,g as Je,r as g,u as qe,K as eo,j as w,c as xe,s as pe,d as Ie,b as oo,m as ce,h as Me}from"./index-DiOti9AJ.js";import{u as to,c as B}from"./Typography-C0jiRpAj.js";import{d as ro,E as ao,b as X,s as so}from"./Tabs-Fsv6t2nq.js";import{e as Z,a as io,d as $e,f as no,u as lo,i as Ce}from"./Button-DqLOHHnB.js";import{P as Se}from"./Search-DsG9jDe4.js";function po(r){return Je("MuiTooltip",r)}const n=Ze("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]);function co(r){return Math.round(r*1e5)/1e5}const mo=r=>{const{classes:o,disableInteractive:s,arrow:i,touch:p,placement:a}=r,d={popper:["popper",!s&&"popperInteractive",i&&"popperArrow"],tooltip:["tooltip",i&&"tooltipArrow",p&&"touch",`tooltipPlacement${Ie(a.split("-")[0])}`],arrow:["arrow"]};return oo(d,po,o)},fo=pe(Se,{name:"MuiTooltip",slot:"Popper",overridesResolver:(r,o)=>{const{ownerState:s}=r;return[o.popper,!s.disableInteractive&&o.popperInteractive,s.arrow&&o.popperArrow,!s.open&&o.popperClose]}})(ce(({theme:r})=>({zIndex:(r.vars||r).zIndex.tooltip,pointerEvents:"none",variants:[{props:({ownerState:o})=>!o.disableInteractive,style:{pointerEvents:"auto"}},{props:({open:o})=>!o,style:{pointerEvents:"none"}},{props:({ownerState:o})=>o.arrow,style:{[`&[data-popper-placement*="bottom"] .${n.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${n.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${n.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}},[`&[data-popper-placement*="left"] .${n.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}}}},{props:({ownerState:o})=>o.arrow&&!o.isRtl,style:{[`&[data-popper-placement*="right"] .${n.arrow}`]:{left:0,marginLeft:"-0.71em"}}},{props:({ownerState:o})=>o.arrow&&!!o.isRtl,style:{[`&[data-popper-placement*="right"] .${n.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:o})=>o.arrow&&!o.isRtl,style:{[`&[data-popper-placement*="left"] .${n.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:o})=>o.arrow&&!!o.isRtl,style:{[`&[data-popper-placement*="left"] .${n.arrow}`]:{left:0,marginLeft:"-0.71em"}}}]}))),uo=pe("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(r,o)=>{const{ownerState:s}=r;return[o.tooltip,s.touch&&o.touch,s.arrow&&o.tooltipArrow,o[`tooltipPlacement${Ie(s.placement.split("-")[0])}`]]}})(ce(({theme:r})=>({backgroundColor:r.vars?r.vars.palette.Tooltip.bg:Me(r.palette.grey[700],.92),borderRadius:(r.vars||r).shape.borderRadius,color:(r.vars||r).palette.common.white,fontFamily:r.typography.fontFamily,padding:"4px 8px",fontSize:r.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:r.typography.fontWeightMedium,[`.${n.popper}[data-popper-placement*="left"] &`]:{transformOrigin:"right center"},[`.${n.popper}[data-popper-placement*="right"] &`]:{transformOrigin:"left center"},[`.${n.popper}[data-popper-placement*="top"] &`]:{transformOrigin:"center bottom",marginBottom:"14px"},[`.${n.popper}[data-popper-placement*="bottom"] &`]:{transformOrigin:"center top",marginTop:"14px"},variants:[{props:({ownerState:o})=>o.arrow,style:{position:"relative",margin:0}},{props:({ownerState:o})=>o.touch,style:{padding:"8px 16px",fontSize:r.typography.pxToRem(14),lineHeight:`${co(16/14)}em`,fontWeight:r.typography.fontWeightRegular}},{props:({ownerState:o})=>!o.isRtl,style:{[`.${n.popper}[data-popper-placement*="left"] &`]:{marginRight:"14px"},[`.${n.popper}[data-popper-placement*="right"] &`]:{marginLeft:"14px"}}},{props:({ownerState:o})=>!o.isRtl&&o.touch,style:{[`.${n.popper}[data-popper-placement*="left"] &`]:{marginRight:"24px"},[`.${n.popper}[data-popper-placement*="right"] &`]:{marginLeft:"24px"}}},{props:({ownerState:o})=>!!o.isRtl,style:{[`.${n.popper}[data-popper-placement*="left"] &`]:{marginLeft:"14px"},[`.${n.popper}[data-popper-placement*="right"] &`]:{marginRight:"14px"}}},{props:({ownerState:o})=>!!o.isRtl&&o.touch,style:{[`.${n.popper}[data-popper-placement*="left"] &`]:{marginLeft:"24px"},[`.${n.popper}[data-popper-placement*="right"] &`]:{marginRight:"24px"}}},{props:({ownerState:o})=>o.touch,style:{[`.${n.popper}[data-popper-placement*="top"] &`]:{marginBottom:"24px"}}},{props:({ownerState:o})=>o.touch,style:{[`.${n.popper}[data-popper-placement*="bottom"] &`]:{marginTop:"24px"}}}]}))),go=pe("span",{name:"MuiTooltip",slot:"Arrow",overridesResolver:(r,o)=>o.arrow})(ce(({theme:r})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:r.vars?r.vars.palette.Tooltip.bg:Me(r.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}})));let J=!1;const Ee=new no;let _={x:0,y:0};function q(r,o){return(s,...i)=>{o&&o(s,...i),r(s,...i)}}const bo=g.forwardRef(function(o,s){const i=qe({props:o,name:"MuiTooltip"}),{arrow:p=!1,children:a,classes:d,components:f={},componentsProps:b={},describeChild:e=!1,disableFocusListener:l=!1,disableHoverListener:c=!1,disableInteractive:E=!1,disableTouchListener:m=!1,enterDelay:u=100,enterNextDelay:R=0,enterTouchDelay:x=700,followCursor:$=!1,id:S,leaveDelay:O=0,leaveTouchDelay:z=1500,onClose:D,onOpen:W,open:ee,placement:v="bottom",PopperComponent:j,PopperProps:A={},slotProps:I={},slots:Oe={},title:N,TransitionComponent:Fe,TransitionProps:De,...de}=i,M=g.isValidElement(a)?a:w.jsx("span",{children:a}),me=to(),Ne=eo(),[P,fe]=g.useState(),[oe,ze]=g.useState(null),V=g.useRef(!1),te=E||$,ue=Z(),re=Z(),H=Z(),ge=Z(),[Pe,he]=ro({controlled:ee,default:!1,name:"Tooltip",state:"open"});let C=Pe;const ae=io(S),L=g.useRef(),G=$e(()=>{L.current!==void 0&&(document.body.style.WebkitUserSelect=L.current,L.current=void 0),ge.clear()});g.useEffect(()=>G,[G]);const ye=t=>{Ee.clear(),J=!0,he(!0),W&&!C&&W(t)},K=$e(t=>{Ee.start(800+O,()=>{J=!1}),he(!1),D&&C&&D(t),ue.start(me.transitions.duration.shortest,()=>{V.current=!1})}),Y=t=>{V.current&&t.type!=="touchstart"||(P&&P.removeAttribute("title"),re.clear(),H.clear(),u||J&&R?re.start(J?R:u,()=>{ye(t)}):ye(t))},se=t=>{re.clear(),H.start(O,()=>{K(t)})},[,Te]=g.useState(!1),we=t=>{Ce(t.target)||(Te(!1),se(t))},Re=t=>{P||fe(t.currentTarget),Ce(t.target)&&(Te(!0),Y(t))},ve=t=>{V.current=!0;const T=M.props;T.onTouchStart&&T.onTouchStart(t)},Le=t=>{ve(t),H.clear(),ue.clear(),G(),L.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",ge.start(x,()=>{document.body.style.WebkitUserSelect=L.current,Y(t)})},ke=t=>{M.props.onTouchEnd&&M.props.onTouchEnd(t),G(),H.start(z,()=>{K(t)})};g.useEffect(()=>{if(!C)return;function t(T){T.key==="Escape"&&K(T)}return document.addEventListener("keydown",t),()=>{document.removeEventListener("keydown",t)}},[K,C]);const Ue=lo(ao(M),fe,s);!N&&N!==0&&(C=!1);const ie=g.useRef(),_e=t=>{const T=M.props;T.onMouseMove&&T.onMouseMove(t),_={x:t.clientX,y:t.clientY},ie.current&&ie.current.update()},k={},ne=typeof N=="string";e?(k.title=!C&&ne&&!c?N:null,k["aria-describedby"]=C?ae:null):(k["aria-label"]=ne?N:null,k["aria-labelledby"]=C&&!ne?ae:null);const h={...k,...de,...M.props,className:xe(de.className,M.props.className),onTouchStart:ve,ref:Ue,...$?{onMouseMove:_e}:{}},U={};m||(h.onTouchStart=Le,h.onTouchEnd=ke),c||(h.onMouseOver=q(Y,h.onMouseOver),h.onMouseLeave=q(se,h.onMouseLeave),te||(U.onMouseOver=Y,U.onMouseLeave=se)),l||(h.onFocus=q(Re,h.onFocus),h.onBlur=q(we,h.onBlur),te||(U.onFocus=Re,U.onBlur=we));const F={...i,isRtl:Ne,arrow:p,disableInteractive:te,placement:v,PopperComponentProp:j,touch:V.current},y=typeof I.popper=="function"?I.popper(F):I.popper,Be=g.useMemo(()=>{var T,be;let t=[{name:"arrow",enabled:!!oe,options:{element:oe,padding:4}}];return(T=A.popperOptions)!=null&&T.modifiers&&(t=t.concat(A.popperOptions.modifiers)),(be=y==null?void 0:y.popperOptions)!=null&&be.modifiers&&(t=t.concat(y.popperOptions.modifiers)),{...A.popperOptions,...y==null?void 0:y.popperOptions,modifiers:t}},[oe,A.popperOptions,y==null?void 0:y.popperOptions]),le=mo(F),We=typeof I.transition=="function"?I.transition(F):I.transition,Q={slots:{popper:f.Popper,transition:f.Transition??Fe,tooltip:f.Tooltip,arrow:f.Arrow,...Oe},slotProps:{arrow:I.arrow??b.arrow,popper:{...A,...y??b.popper},tooltip:I.tooltip??b.tooltip,transition:{...De,...We??b.transition}}},[je,Ve]=X("popper",{elementType:fo,externalForwardedProps:Q,ownerState:F,className:xe(le.popper,A==null?void 0:A.className)}),[He,Ge]=X("transition",{elementType:so,externalForwardedProps:Q,ownerState:F}),[Ke,Ye]=X("tooltip",{elementType:uo,className:le.tooltip,externalForwardedProps:Q,ownerState:F}),[Qe,Xe]=X("arrow",{elementType:go,className:le.arrow,externalForwardedProps:Q,ownerState:F,ref:ze});return w.jsxs(g.Fragment,{children:[g.cloneElement(M,h),w.jsx(je,{as:j??Se,placement:v,anchorEl:$?{getBoundingClientRect:()=>({top:_.y,left:_.x,right:_.x,bottom:_.y,width:0,height:0})}:P,popperRef:ie,open:P?C:!1,id:ae,transition:!0,...U,...Ve,popperOptions:Be,children:({TransitionProps:t})=>w.jsx(He,{timeout:me.transitions.duration.shorter,...t,...Ge,children:w.jsxs(Ke,{...Ye,children:[N,p?w.jsx(Qe,{...Xe}):null]})})})]})}),xo=B(w.jsx("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M14 13v4h-4v-4H7l5-5 5 5z"})),$o=B(w.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"})),Co=B(w.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"})),Eo=B(w.jsx("path",{d:"m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"})),Ao=B(w.jsx("path",{d:"M2.5 4v3h5v12h3V7h5V4zm19 5h-9v3h3v7h3v-7h3z"})),Ae={fire:{category:"fire",color:"#dc2626",icon:"fire"},"structure fire":{category:"fire",color:"#dc2626",icon:"fire"},"vehicle fire":{category:"fire",color:"#ff6600",icon:"fire"},wildfire:{category:"fire",color:"#ff4444",icon:"fire"},medical:{category:"medical",color:"#22c55e",icon:"medical"},ems:{category:"medical",color:"#22c55e",icon:"medical"},cardiac:{category:"medical",color:"#ef4444",icon:"medical"},respiratory:{category:"medical",color:"#3b82f6",icon:"medical"},rescue:{category:"rescue",color:"#f59e0b",icon:"rescue"},"vehicle accident":{category:"rescue",color:"#f59e0b",icon:"rescue"},hazmat:{category:"hazmat",color:"#8b5cf6",icon:"hazmat"},alarm:{category:"alarm",color:"#6b7280",icon:"alarm"},"false alarm":{category:"alarm",color:"#9ca3af",icon:"alarm"}},ho=(r,o)=>{const s={fire:`data:image/svg+xml,%3Csvg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"%3E%3Ccircle cx="12" cy="12" r="10" fill="${encodeURIComponent(o)}"/%3E%3Ctext x="50%25" y="50%25" dominant-baseline="middle" text-anchor="middle" font-family="Arial" font-size="8px" fill="white" font-weight="bold"%3EF%3C/text%3E%3C/svg%3E`,medical:`data:image/svg+xml,%3Csvg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"%3E%3Ccircle cx="12" cy="12" r="10" fill="${encodeURIComponent(o)}"/%3E%3Cpath d="M11 8h2v8h-2v-8zM8 11h8v2H8v-2z" fill="white"/%3E%3C/svg%3E`,rescue:`data:image/svg+xml,%3Csvg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"%3E%3Ccircle cx="12" cy="12" r="10" fill="${encodeURIComponent(o)}"/%3E%3Ctext x="50%25" y="50%25" dominant-baseline="middle" text-anchor="middle" font-family="Arial" font-size="8px" fill="white" font-weight="bold"%3ER%3C/text%3E%3C/svg%3E`,hazmat:`data:image/svg+xml,%3Csvg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"%3E%3Ccircle cx="12" cy="12" r="10" fill="${encodeURIComponent(o)}"/%3E%3Ctext x="50%25" y="50%25" dominant-baseline="middle" text-anchor="middle" font-family="Arial" font-size="8px" fill="white" font-weight="bold"%3EH%3C/text%3E%3C/svg%3E`,alarm:`data:image/svg+xml,%3Csvg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"%3E%3Ccircle cx="12" cy="12" r="10" fill="${encodeURIComponent(o)}"/%3E%3Ctext x="50%25" y="50%25" dominant-baseline="middle" text-anchor="middle" font-family="Arial" font-size="8px" fill="white" font-weight="bold"%3EA%3C/text%3E%3C/svg%3E`};return s[r]||s.fire};class Io{static transformToFireMapPro(o,s={toolId:"fire-map-pro"}){const i=[],p=[],a=[];let d=0,f=0;o.forEach((e,l)=>{try{const c=e.incident_id||e["Incident ID"]||e.incidentId||e.id,E=parseFloat(e.latitude||e.Latitude||e.lat),m=parseFloat(e.longitude||e.Longitude||e.lng||e.lon);if(!c){i.push(`Row ${l+1}: Missing Incident ID`),f++;return}if(isNaN(E)||isNaN(m)){i.push(`Row ${l+1}: Invalid or missing coordinates`),f++;return}const u=e.incident_type||e["Incident Type"]||e.incidentType||e.type||"Unknown",R=e.incident_date||e["Incident Date"]||e.incidentDate||e.date,x=e.incident_time||e["Incident Time"]||e.incidentTime||e.time,$=e.address||e.Address||"",S=e.city||e.City||"",O=e.state||e.State||"",z=e.priority||e.Priority||"",D=e.responding_unit||e.Station||e.station||"",W=e.response_category||e["Response Category"]||e.responseCategory||"",ee=(typeof u=="string"?u:String(u||"")).toLowerCase(),v=Ae[ee]||Ae.fire,j={id:`incident-${c}`,type:"marker",title:`${u} - ${c}`,description:`${u} incident${$?` at ${$}`:""}${S?`, ${S}`:""}${O?`, ${O}`:""}`,coordinates:[m,E],style:{color:v.color,icon:{id:`${v.icon}-icon`,name:v.icon,category:v.category,url:ho(v.icon,v.color),size:"medium",color:v.color,anchor:[12,24],popupAnchor:[0,-24]}},properties:{incidentId:c,incidentType:u,incidentDate:R,incidentTime:x,address:$,city:S,state:O,priority:z,station:D,responseCategory:W,coordinates:{latitude:E,longitude:m},fullAddress:[$,S,O].filter(Boolean).join(", "),dateTime:R&&x?`${R} ${x}`:R||"",displayText:`${u}${z?` (${z})`:""}${D?` - Station ${D}`:""}`},layerId:"imported-incidents",created:new Date,modified:new Date};a.push(j),d++,R||p.push(`Row ${l+1}: Missing incident date`),!$&&!S&&p.push(`Row ${l+1}: Missing address information`)}catch(c){i.push(`Row ${l+1}: ${c instanceof Error?c.message:"Unknown error"}`),f++}});const b={id:"imported-incidents",name:`Imported Incidents (${a.length})`,visible:!0,opacity:1,zIndex:1e3,type:"feature",features:a,style:{defaultStyle:{color:"#dc2626",fillColor:"#dc2626",fillOpacity:.7,weight:2,opacity:1}},metadata:{description:`Incident data imported from Data Formatter - ${a.length} incidents`,source:"Data Formatter",created:new Date,featureCount:a.length,bounds:a.length>0?this.calculateBounds(a):void 0}};return{success:i.length===0||d>0,data:{layer:b,features:a},errors:i,warnings:p,metadata:{totalRecords:o.length,successfulRecords:d,skippedRecords:f}}}static transformToResponseTimeAnalyzer(o,s={toolId:"response-time-analyzer"}){var b;console.log("🔥 DATA TRANSFORMER - transformToResponseTimeAnalyzer() called"),console.log("🔥 DATA TRANSFORMER - incidents.length:",o.length),console.log("🔥 DATA TRANSFORMER - first incident:",o[0]),console.log("🔥 DATA TRANSFORMER - first incident field names:",Object.keys(o[0]));const i=[],p=[],a=[];let d=0,f=0;return o.forEach((e,l)=>{try{const c=e.incident_id||e["Incident ID"]||e.incidentId||e.id||e.incident_number,E=e.incident_date||e["Incident Date"]||e.incidentDate||e.date;if(!c){i.push(`Row ${l+1}: Missing Incident ID`),f++;return}if(!E){i.push(`Row ${l+1}: Missing Incident Date`),f++;return}console.log(`🔥 TRANSFORMER ROW ${l+1} - ACTUAL FIELD NAMES:`,Object.keys(e));let m=e.incident_time;if(console.log(`🔥 TRANSFORMER ROW ${l+1} - Primary field ID 'incident_time': "${m}"`),!m){const R=["Call Received Date/Time","Call Received Time","Call Receive Time","call received time","call receive time","Incident Time","incident time","incidentTime","time"];for(const x of R)if(e[x]){m=e[x],console.log(`🔄 TRANSFORMER ROW ${l+1} - Using original field fallback "${x}": "${m}"`);break}}console.log(`🔥 TRANSFORMER ROW ${l+1} - Selected incidentTime: "${m}"`),m&&/^\d{1,2}\/\d{1,2}\/\d{2,4}$/.test(m.trim())&&(console.warn(`⚠️ DATA QUALITY WARNING ROW ${l+1}: incidentTime appears to be date-only format: "${m}"`),console.warn("⚠️ This may cause unrealistic dispatch time calculations. Consider using a field with full datetime information."));const u={incidentId:String(c),incidentDate:String(E),incidentTime:m,dispatchTime:e.dispatch_time||e["Dispatch Time"]||e.dispatchTime,enRouteTime:e.enroute_time||e["En Route Time"]||e.enRouteTime,arrivalTime:e.arrival_time||e["Arrival Time"]||e.arrivalTime||e.arrive_time||e["On Scene Time"],clearTime:e.clear_time||e["Clear Time"]||e.clearTime,latitude:parseFloat(e.latitude||e.Latitude),longitude:parseFloat(e.longitude||e.Longitude),incidentType:e.incident_type||e["Incident Type"]||e.incidentType||e.type,respondingUnit:e.responding_unit||e.Station||e.station||e.unit||e.unit_id,address:e.address||e.Address,city:e.city||e.City,state:e.state||e.State,zipCode:e.zip_code||e["Zip Code"]||e.zipCode,priority:e.priority||e.Priority};console.log(`🔥 TRANSFORMER ROW ${l+1} - Final record incidentTime: "${u.incidentTime}"`),a.push(u),d++}catch(c){i.push(`Row ${l+1}: ${c instanceof Error?c.message:"Unknown error"}`),f++}}),console.log("🔥 DATA TRANSFORMER - Processing complete"),console.log("🔥 DATA TRANSFORMER - successfulRecords:",d),console.log("🔥 DATA TRANSFORMER - errors:",i),console.log("🔥 DATA TRANSFORMER - first transformed record:",a[0]),console.log("🔥 DATA TRANSFORMER - first transformed record incidentTime:",(b=a[0])==null?void 0:b.incidentTime),{success:i.length===0||d>0,data:a,errors:i,warnings:p,metadata:{totalRecords:o.length,successfulRecords:d,skippedRecords:f}}}static calculateBounds(o){const s=o.filter(a=>a.type==="marker").map(a=>a.coordinates);if(s.length===0)return;const i=s.map(a=>a[1]),p=s.map(a=>a[0]);return{north:Math.max(...i),south:Math.min(...i),east:Math.max(...p),west:Math.min(...p)}}static validateDataForTool(o,s){if(!o||o.length===0)return{compatible:!1,missingFields:s.requiredFields,availableOptionalFields:[]};const i=Object.keys(o[0]),p=s.requiredFields.filter(d=>!i.includes(d)),a=s.optionalFields?s.optionalFields.filter(d=>i.includes(d)):[];return{compatible:p.length===0,missingFields:p,availableOptionalFields:a}}}export{$o as A,Co as D,Eo as E,bo as T,xo as U,Ao as a,Io as b};
