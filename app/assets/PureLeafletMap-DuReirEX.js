import{h as F,i as h,r as c,cL as D,k as N,j as n,s as E,m as W,n as M,o as I,B as U,p as A,aB as v,cM as G,q as $,bo as O,P as V,t as b,v as x,bj as q}from"./index-CBGrwvoJ.js";import{L as w}from"./leaflet-BA_30iQt.js";function H(e){return h("MuiToggleButton",e)}const z=F("MuiToggleButton",["root","disabled","selected","standard","primary","secondary","sizeSmall","sizeMedium","sizeLarge","fullWidth"]),_=c.createContext({}),J=c.createContext(void 0);function K(e,t){return t===void 0||e===void 0?!1:Array.isArray(t)?t.includes(e):e===t}const Q=e=>{const{classes:t,fullWidth:r,selected:p,disabled:d,size:g,color:y}=e,u={root:["root",p&&"selected",d&&"disabled",r&&"fullWidth",`size${M(g)}`,y]};return I(u,H,t)},X=E(U,{name:"MuiToggleButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[`size${M(r.size)}`]]}})(A(({theme:e})=>({...e.typography.button,borderRadius:(e.vars||e).shape.borderRadius,padding:11,border:`1px solid ${(e.vars||e).palette.divider}`,color:(e.vars||e).palette.action.active,[`&.${z.disabled}`]:{color:(e.vars||e).palette.action.disabled,border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`},"&:hover":{textDecoration:"none",backgroundColor:e.vars?`rgba(${e.vars.palette.text.primaryChannel} / ${e.vars.palette.action.hoverOpacity})`:v(e.palette.text.primary,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[{props:{color:"standard"},style:{[`&.${z.selected}`]:{color:(e.vars||e).palette.text.primary,backgroundColor:e.vars?`rgba(${e.vars.palette.text.primaryChannel} / ${e.vars.palette.action.selectedOpacity})`:v(e.palette.text.primary,e.palette.action.selectedOpacity),"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.text.primaryChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:v(e.palette.text.primary,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette.text.primaryChannel} / ${e.vars.palette.action.selectedOpacity})`:v(e.palette.text.primary,e.palette.action.selectedOpacity)}}}}},...Object.entries(e.palette).filter(G()).map(([t])=>({props:{color:t},style:{[`&.${z.selected}`]:{color:(e.vars||e).palette[t].main,backgroundColor:e.vars?`rgba(${e.vars.palette[t].mainChannel} / ${e.vars.palette.action.selectedOpacity})`:v(e.palette[t].main,e.palette.action.selectedOpacity),"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette[t].mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:v(e.palette[t].main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette[t].mainChannel} / ${e.vars.palette.action.selectedOpacity})`:v(e.palette[t].main,e.palette.action.selectedOpacity)}}}}})),{props:{fullWidth:!0},style:{width:"100%"}},{props:{size:"small"},style:{padding:7,fontSize:e.typography.pxToRem(13)}},{props:{size:"large"},style:{padding:15,fontSize:e.typography.pxToRem(15)}}]}))),te=c.forwardRef(function(t,r){const{value:p,...d}=c.useContext(_),g=c.useContext(J),y=D({...d,selected:K(t.value,p)},t),u=N({props:y,name:"MuiToggleButton"}),{children:f,className:C,color:l="standard",disabled:o=!1,disableFocusRipple:a=!1,fullWidth:s=!1,onChange:i,onClick:m,selected:R,size:j="medium",value:P,...k}=u,T={...u,color:l,disabled:o,disableFocusRipple:a,fullWidth:s,size:j},S=Q(T),Z=L=>{m&&(m(L,P),L.defaultPrevented)||i&&i(L,P)},B=g||"";return n.jsx(X,{className:W(d.className,S.root,C,B),disabled:o,focusRipple:!a,ref:r,onClick:Z,onChange:i,value:P,ownerState:T,"aria-pressed":R,...k,children:f})}),oe=({mouseCoords:e})=>{const t=$(O),r=(p,d=5)=>p.toFixed(d);return n.jsx(V,{elevation:2,sx:{position:"absolute",bottom:16,left:16,right:16,zIndex:1e3,p:1,bgcolor:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(4px)"},children:n.jsxs(b,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n.jsxs(b,{children:[n.jsx(x,{variant:"caption",color:"text.secondary",children:"Mouse:"}),e?n.jsxs(x,{variant:"caption",sx:{ml:1,fontFamily:"monospace"},children:[r(e.lat),", ",r(e.lng)]}):n.jsx(x,{variant:"caption",sx:{ml:1,color:"text.disabled"},children:"Move mouse over map"})]}),n.jsxs(b,{children:[n.jsx(x,{variant:"caption",color:"text.secondary",children:"Center:"}),n.jsxs(x,{variant:"caption",sx:{ml:1,fontFamily:"monospace"},children:[r(t.view.center.latitude),", ",r(t.view.center.longitude)]})]}),n.jsxs(b,{children:[n.jsx(x,{variant:"caption",color:"text.secondary",children:"Zoom:"}),n.jsx(x,{variant:"caption",sx:{ml:1,fontFamily:"monospace"},children:t.view.zoom.toFixed(1)})]})]})})},ae=({onMapReady:e,children:t})=>{const r=c.useRef(null),p=c.useRef(null),d=c.useRef(null),g=c.useRef(!1),y=c.useRef(!1),u=$(q),f=$(O),C=c.useCallback(e||(()=>{}),[e]);return c.useEffect(()=>{if(!r.current||p.current||g.current)return;g.current=!0,console.log("[PureLeaflet] Creating pure Leaflet map...");const l=!!u.mode,o=w.map(r.current,{center:[39.8283,-98.5795],zoom:6,zoomControl:!0,attributionControl:!0,scrollWheelZoom:!0,doubleClickZoom:!l,boxZoom:!l,keyboard:!0,dragging:!l,touchZoom:!0}),a=f.baseMaps.find(i=>i.id===f.activeBaseMap),s=w.tileLayer((a==null?void 0:a.url)||"https://tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:(a==null?void 0:a.attribution)||"© OpenStreetMap contributors",maxZoom:(a==null?void 0:a.maxZoom)||19,minZoom:(a==null?void 0:a.minZoom)||1,tileSize:256,opacity:1});return d.current=s,s.addTo(o),s.on("tileload",i=>{console.log("[PureLeaflet] Tile loaded:",i.coords)}),s.on("tileerror",i=>{console.error("[PureLeaflet] Tile error:",i)}),s.on("loading",()=>{console.log("[PureLeaflet] Started loading tiles")}),s.on("load",()=>{console.log("[PureLeaflet] Finished loading all visible tiles")}),o.on("moveend",()=>{const i=o.getCenter(),m=o.getZoom();console.log(`[PureLeaflet] Map moved to: ${i.lat}, ${i.lng} at zoom ${m}`)}),setTimeout(()=>{o.getContainer()&&(o.invalidateSize(),console.log("[PureLeaflet] Map size invalidated"))},100),p.current=o,o.whenReady(()=>{if(console.log("[PureLeaflet] ✓ Map panes and coordinate system ready"),typeof window<"u"&&(window.pureLeafletMap=o,console.log("[PureLeaflet] ✓ Map exposed as window.pureLeafletMap")),!o._size||!o.getPixelOrigin()||!o.getPanes().mapPane){console.error("[PureLeaflet] Map coordinate system not properly initialized");return}g.current=!1,r.current&&C(o,r.current)}),()=>{if(p.current&&!y.current){y.current=!0,console.log("[PureLeaflet] Map cleaned up");try{p.current.remove()}catch(i){console.warn("[PureLeaflet] Error during cleanup:",i)}p.current=null,g.current=!1,y.current=!1}}},[]),c.useEffect(()=>{console.log("[PureLeafletMap] Drawing effect triggered with mode:",u.mode);const l=p.current;if(!l){console.log("[PureLeafletMap] No map instance, skipping drawing effect");return}const o=!!u.mode;console.log("[PureLeafletMap] isDrawing calculated as:",o),o?(l.doubleClickZoom.disable(),l.boxZoom.disable(),console.log("[PureLeaflet] Zoom interactions disabled for drawing mode:",u.mode)):(l.doubleClickZoom.enable(),l.boxZoom.enable(),console.log("[PureLeaflet] All map interactions enabled - drawing mode off"))},[u.mode]),c.useEffect(()=>{const l=p.current;if(!l)return;const o=f.baseMaps.find(s=>s.id===f.activeBaseMap);if(!o)return;d.current&&(l.removeLayer(d.current),console.log("[PureLeaflet] Removed old tile layer"));const a=w.tileLayer(o.url,{attribution:o.attribution,maxZoom:o.maxZoom||19,minZoom:o.minZoom||1,tileSize:256,opacity:1});a.on("tileload",s=>{console.log("[PureLeaflet] Tile loaded:",s.coords)}),a.on("tileerror",s=>{console.error("[PureLeaflet] Tile error:",s)}),a.on("loading",()=>{console.log("[PureLeaflet] Started loading tiles")}),a.on("load",()=>{console.log("[PureLeaflet] Finished loading all visible tiles")}),d.current=a,a.addTo(l),console.log(`[PureLeaflet] Switched to base map: ${o.name}`)},[f.activeBaseMap,f.baseMaps]),n.jsxs(n.Fragment,{children:[n.jsx("div",{ref:r,style:{width:"100%",height:"100%",minHeight:"500px",background:"transparent"},className:"pure-leaflet-map"}),t]})};export{oe as C,ae as P,te as T,_ as a,J as b,z as t};
